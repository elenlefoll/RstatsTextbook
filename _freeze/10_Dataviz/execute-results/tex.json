{
  "hash": "1ee839820d1f463e240748e57b2f5941",
  "result": {
    "engine": "knitr",
    "markdown": "---\nengine: knitr\nbibliography: references.bib\nhtml:\n  code-link: true\n---\n\n# The Gramma`R` of Graphics {#sec-DataViz}\n\nOne of the advantages of working in `R` is that it allows us to create highly customised graphs for effective data visualisation. The **Grammar of Graphics** [@wilkinsonGrammarGraphics2005] is a theoretical framework that defines a structured approach to building and understanding statistical graphs. We will focus on using the tidyverse package [{ggplot2}](https://ggplot2.tidyverse.org/) [@Wickhamggplot2Elegantgraphics2016] to create effective data visualisations. The {ggplot2} is an implementation of the Grammar of Graphics (GG) syntax in `R`.\n\nThis chapter is divided into two parts: the first explains the **syntax** of the Grammar of Graphics [@wilkinsonGrammarGraphics2005] and how the {ggplot2} package works, while the second part focuses on the **semantics** of statistical graphics and provides an introduction to the many different types of data visualisations that can be created using the package.\n\n### Chapter overview {.unnumbered}\n\nIn this chapter, you will learn how to:\n\n-   Create and interpret bar plots to visualise categorical variables.\n-   Create and interpret histograms, density plots, and violin plots to visualise continuous numeric variables.\n-   Create and interpret boxplots to visualise the distribution of continuous numeric variables across different subsets of the data.\n-   Create and interpret scatter plots to visualise correlations between pairs of numeric variables.\n-   Create and interpret facetted plots to explore the relationship between three or more variables at once.\n-   Create interactive plots for data exploration.\n\n![Building a data masterpiece with {ggplot2} (artwork by [\\@allison_horst](https://allisonhorst.com/))](images/AHorst_ggplot2.png){#fig-DataArtists fig-alt=\"A fuzzy monster in a beret and scarf, critiquing their own column graph on a canvas in front of them while other assistant monsters (also in berets) carry over boxes full of elements that can be used to customize a graph (like themes and geometric shapes). In the background is a wall with framed data visualizations. Stylized text reads: ggplot2: build a data masterpiece.\"}\n\n### Set-up and data import {.unnumbered}\n\n::: {.callout-warning collapse=\"false\"}\n### Prerequisites\n\nThis chapter assumes that you are familiar with the concepts of descriptive statistics explained in @sec-DescRiptiveStats, and the use of the data wrangling functions introduced in @sec-DataWrangling.\n\nAll examples and quiz questions are based on data from:\n\n> DƒÖbrowska, Ewa. 2019. Experience, Aptitude, and Individual Differences in Linguistic Attainment: A Comparison of Native and Nonnative Speakers. Language Learning 69(S1). 72-100. <https://doi.org/10.1111/lang.12323>.\n\nOur starting point for this chapter is the wrangled combined dataset that we created and saved in @sec-DataWrangling. Follow the instructions in @sec-filter to create this `R` object.\n\nAlternatively, you can download `Dabrowska2019.zip` from [the textbook's GitHub repository](https://github.com/elenlefoll/RstatsTextbook/raw/69d1e31be7394f2b612825f031ebffeb75886390/Dabrowska2019.zip){.uri}. To launch the project correctly, first unzip the file and then double-click on the `Dabrowska2019.Rproj` file.\n:::\n\nBefore we begin, we must load the `combined_L1_L2_data.rds` file that we created and saved in @sec-DataWrangling. This file contains the data of all the L1 and L2 participants of @DabrowskaExperienceAptitudeIndividual2019. The categorical variables are stored as factors and obvious data entry inconsistencies and typos have been corrected (see @sec-DataWrangling).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(tidyverse)\n\nDabrowska.data <- readRDS(file = here(\"data\", \"processed\", \"combined_L1_L2_data.rds\"))\n```\n:::\n\n\n\n\nCheck that your data are correctly imported by examining the output of `View(Dabrowska.data)` and `str(Dabrowska.data)`. Once you are satisfied that that's the case, we ready to get creative! üé®\n\n## The syntax of graphics {#sec-Syntax}\n\nThe syntax of the Grammar of Graphics [@wilkinsonGrammarGraphics2005] is made up of **layers** (@fig-layers), which allow us to create highly effective and efficient data visualisations, while giving us lots of flexibility and control.\n\n![The syntax of the Grammar of Graphics as visualised in the [QCBS R Workshop Series](https://r.qcbs.ca/workshop03/book-en/grammar-of-graphics-gg-basics.html) ([CC-BY-NC-SA](https://creativecommons.org/licenses/by-nc-sa/4.0/))](images/gglayers.png){#fig-layers width=\"559\" fig-alt=\"A layered diagram illustrating the key elements of data visualization: Data, Aesthetics, Geometries, Facets, Statistics, Coordinates, and Theme, each shown as a layer with a distinct colour.\"}\n\nThe **data** layer and the **aesthetics** layer are compulsory as you cannot build a graph that does not map *some* data onto *some* visual aspect (= aesthetic) of a graph. The remaining layers are optional, but some are very important. In the following, we will explain how the **geometries**, **facet**, **scales**, **coordinates**, and **theme** layers are used to build and customise graphs using the {ggplot2} library in `R`.\n\n:::: {.content-visible when-format=\"html\"}\n::: column-margin\n![Hex sticker of the [{ggplot2}](https://ggplot2.tidyverse.org/) package](images/hex_ggplot2.png){width=\"100\" fig-alt=\"The hexagonal logo of the ggplot2 package features a graph with dots that are connected by a line.\"}\n:::\n::::\n\n### Aesthetics {#sec-aes}\n\nAs explained in the documentation, the `ggplot()` function[^10_dataviz-1] has two compulsory arguments. First, we must select the **data** that we want to visualise. Second, we must specify which variable(s) from the data should be mapped onto which visual property or **aesthetics** (short: `aes`) of the plot.\n\n[^10_dataviz-1]: Note that, while the library is called {ggplot2}, its main function is called `ggplot()`.\n\n> |                  |                 |\n> |------------------|-----------------|\n> | ggplot {ggplot2} | R Documentation |\n>\n> ### Description {.unnumbered}\n>\n> `ggplot()` initializes a ggplot object. It can be used to declare the input data frame for a graphic and to specify the set of plot aesthetics intended to be common throughout all subsequent layers unless specifically overridden.\n>\n> ### Usage {.unnumbered}\n>\n> ```         \n> ggplot(data = NULL, mapping = aes(), ...)\n> ```\n\nFor example, to create a bar plot visualising the distribution of participants' occupational groups in the combined dataset from @DabrowskaExperienceAptitudeIndividual2019 (`Dabrowska.data`), we need to map the `OccupGroup` variable from `Dabrowska.data` onto our plot's *x-*axis (`x`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup))\n```\n\n::: {.cell-output-display}\n![Attempt to plot the distribution of participants' occupational groups in DƒÖbrowska (2019)](10_Dataviz_files/figure-pdf/fig-EmptyBarplot-1.pdf){#fig-EmptyBarplot fig-pos='H' fig-alt='An empty plot with the x-axis labeled OccupGroup and four group labels: C, I, M, and PS. No data is shown.'}\n:::\n:::\n\n\nAs you can see from @fig-EmptyBarplot, however, running this code returns an empty plot: All we get is a grid background and a nicely labelled *x-*axis, but no data... Why might that be? ¬†ü§î\n\n### Geometries {#sec-geoms}\n\nThe reason we are not seeing any data is that we have not yet specified with which kind of **geometry** (short: **geom**) we would like to plot the data. The {ggplot2} library features more than 30 different geom functions! They all begin with the prefix `geom_`. To create a bar plot showing participants' occupational groups, we need to add a `geom_bar()` **layer** to our empty `ggplot` object (see @fig-barplot1).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![Distribution of participants' occupational groups (C = clerical position, I = inactive (i.e. unemployed, retired, or homemakers), M = manual jobs, PS = professional-level job or studying for a degree)](10_Dataviz_files/figure-pdf/fig-barplot1-1.pdf){#fig-barplot1 fig-pos='H' fig-alt='A bar plot showing the number of various occupational groups. The x-axis is labeled as OccupGroup and represents different occupation categories: C, I, M, and PS, with PS having the highest count of them all. The y-axis represents the number of individuals in each group and is labeled as count.'}\n:::\n:::\n\n\nNote that we use the `+` operator to *add* layers to `ggplot` objects. If we try to use the pipe operator (`|>`) *within* the `ggplot()` function, we will get an error message.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) |> \n  geom_bar()\n```\n:::\n\n\n```         \nError in `geom_bar()`: \n! `mapping` must be created by `aes()`. \n‚Ñπ Did you use `%>%` or `|>` instead of `+`? \nRun `rlang::last_trace()` to see where the error occurred.\n```\n\n### Statistics and labels {#sec-StatsLabs}\n\nWe now have a simple bar plot that represents the distribution of participants' occupational groups in @DabrowskaExperienceAptitudeIndividual2019. By default, the axis labels are simply the names of the variables that are mapped onto the plot's aesthetics. That's why, in @fig-barplot1, our *x*-axis is labelled \"OccupGroup\".\n\nWhat about the *y*-axis? We did not specify a *y*-aesthetic within the mapping argument of our `ggplot()` object, yet the *y*-axis is labelled \"count\". This is because `geom_bar()` automatically computes a \"count\" **statistic** that gets mapped to the *y*-aesthetic.\n\nIf we want to change these axis labels, we can do so by adding a `labs()` **layer** to our plot (see @fig-BarOccupGroup).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\")\n```\n\n::: {.cell-output-display}\n![Distribution of participants' occupational groups (C = clerical position, I = inactive (i.e. unemployed, retired, or homemakers), M = manual jobs, PS = professional-level job or studying for a degree)](10_Dataviz_files/figure-pdf/fig-BarOccupGroup-1.pdf){#fig-BarOccupGroup fig-pos='H' fig-alt='This is the same bar plot as above. The only difference is that the x-axis is labeled as Occupational group and the y-axis is labeled as Number of participants.'}\n:::\n:::\n\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.1**]{style=\"color:green;\"} Which of the following labels can be added or modified using the `labs()` function?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_1\" onsubmit=\"return validate_form_Q10_1()\" method=\"post\">\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_1\" value=\"plot subtitle\"/>\nplot subtitle\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_2\" value=\"plot title\"/>\nplot title\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_3\" value=\"x-axis label\"/>\nx-axis label\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_4\" value=\"y-axis label\"/>\ny-axis label\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_5\" value=\"plot caption\"/>\nplot caption\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_1_6\" value=\"plot alt-text\"/>\nplot alt-text\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_1\"></div>\n</form>\n<script>function validate_form_Q10_1() {var text; var x1 = document.getElementById('answer_Q10_1_1'); var x2 = document.getElementById('answer_Q10_1_2'); var x3 = document.getElementById('answer_Q10_1_3'); var x4 = document.getElementById('answer_Q10_1_4'); var x5 = document.getElementById('answer_Q10_1_5'); var x6 = document.getElementById('answer_Q10_1_6'); if (x1.checked == true&x2.checked == true&x3.checked == true&x4.checked == true&x5.checked == true&x6.checked == true){text = 'That‚Äôs right and there are many more possibilities. For instance, it‚Äôs also possible to change the title of a plot‚Äôs legend using the labs() function.';} else {text = 'No, there are more labels that can be ammended.';} document.getElementById('result_Q10_1').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1;res1 = document.getElementById('result_Q10_1').innerText == 'That‚Äôs right and there are many more possibilities. For instance, it‚Äôs also possible to change the title of a plot‚Äôs legend using the labs() function.';text = res1;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_53695\" onclick=\"return show_hint_53695()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_53695\" onclick=\"return show_hint_53695()\"></div>\n<script>function show_hint_53695(){var x = document.getElementById('result_53695').innerHTML; if(!x){document.getElementById('result_53695').innerHTML = 'Check out the function‚Äôs help file to find out more about its possibilities by entering ?labs in the Console.';} else {document.getElementById('result_53695').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n¬†\n:::\n::::\n\n::: {.callout-note collapse=\"false\"}\n#### What is alt-text and why is it important?\n\nAlternative text, or **alt-text**, is a concise description of an image used to make its informational content accessible to people with visual impairments. Using a screen reader programme, blind and low-vision readers can have the alt-text associated with an image read out to them.\n\nA good alt-text aims to convey the main message and insights of the graph, allowing someone who cannot see it to understand the information being presented [see @universityofsouthcarolinaAlternativeText and @w3cwebaccessibilityinitiativewaiImages2022 for concise tutorials on how to write good alt-texts for all kinds of images]. In the context of online publications, alt-text is also useful in regions with low bandwidth as images may take a very long time to load. By including alt-text, we can therefore make our work more accessible and inclusive, enabling more people to engage with and understand our data and analyses.\n\n@sec-QuartoFigures explains how to add alt-text to plots and figures in Quarto documents. Whilst many so-called \"AI\" tools will now automatically generate alt-text for us, it is best to write alt-text ourselves. This is because auto-generated alt-text often does not focus on the visual information that we want to convey, misses out on important aspects, and/or overwhelms the user with redundant information.\n\nBlind and low-vision readers may also want to check out the [{BrailleR}](https://ajrgodfrey.github.io/BrailleR/articles/BrailleR.html) package [@godfreyBrailleRImprovedAccess2025], which converts plots generated in `R` into a textual form that can be interpreted by blind and low-vision `R` users who cannot access the graphs without printing the image to a tactile embosser, or who need the extra text to support any tactile images that they do create.\n\n\n:::\n\n### Data {#sec-ggplotData}\n\nInstead of using the **data** argument of the `ggplot()` function as we did above, we can **pipe** the data into the function's first argument (see @sec-Piping). Compare these two methods and their outputs.\n\n:::::: columns\n::: {.column width=\"48%\"}\n**Using the data argument of `ggplot()`**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup))      +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H' fig-alt='This is the same bar plot as above.'}\n:::\n:::\n\n:::\n\n::: {.column width=\"4%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"48%\"}\n**Piping the data into `ggplot()`**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H' fig-alt='This is the same bar plot as above.'}\n:::\n:::\n\n:::\n::::::\n\nThe outputs are exactly the same! Piping the dataset into the `ggplot()` function, however, allows us to easily wrangle the data that we want to visualise 'on the fly', without transforming the data object itself. For example, we can use the tidyverse `filter()` function (see @sec-filter) to examine the distribution of occupational groups among L2 participants only (see @fig-BarOccupGroupL2).\n\n\n::: {.cell source-line-numbers='2,7'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\",\n       title = \"Occupational groups of L2 participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BarOccupGroupL2-1.pdf){#fig-BarOccupGroupL2 fig-pos='H' fig-alt='Bar plot with the title of Occupational groups of L2 participants showing the distribution of L2 participants\\' occupational group. The x-axis is labeled as Occupational group with PS having the highest count, and the y-axis is labeled as Number of participants.'}\n:::\n:::\n\n\nWe can also combine several `filter()` conditions using the `&` (AND) and `|` (OR) operators. For example, we may want to visualise the distribution of the occupational groups of participants who are L2 speakers of English *and* whose first language is Polish (see @fig-BarOccupGroupL2Polish).\n\n\n::: {.cell source-line-numbers='2,7'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  filter(Group == \"L2\" & NativeLg == \"Polish\") |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\",\n       title = \"Occupational groups of Polish L2 participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BarOccupGroupL2Polish-1.pdf){#fig-BarOccupGroupL2Polish fig-pos='H' fig-alt='Bar plot showing the number of Polish L2 participants across occupational groups C, I, M, and PS, with M having the highest count. The x-axis and the y-axis are labeled as the plot above. The title of the plot is Occupational groups of Polish L2 participants.'}\n:::\n:::\n\n\n### Facets {#sec-facets}\n\nIf we want to compare two subsets of the data, we can add a **facet layer** to subdivide the plot into several plots each representing a subset of the data. In the following, we use the `facet_wrap()` function to subdivide our bar plot by the `Group` variable (`~ Group`). This allows us to easily compare the distribution of occupations across L1 and the L2 participants (see @fig-BarOccupGroupFacet).\n\n\n::: {.cell source-line-numbers='4'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  facet_wrap(~ Group) +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\",\n       title = \"Occupational groups of participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BarOccupGroupFacet-1.pdf){#fig-BarOccupGroupFacet fig-pos='H' fig-alt='Bar plot titled Occupational groups of participants showing the number of participants in four occupational groups for two categories, L1 and L2. The plot is divided into two panels: in the L1 group, the number of participants is roughly equal across all occupations, ranging from about 20 to 25. In the L2 group, PS has the highest number of participants at over 30, followed by M and C, while I has the fewest participants.'}\n:::\n:::\n\n\n::: {.callout-warning collapse=\"false\"}\n#### Error message: \"seq.default(from, to, by) : invalid\" {.unnumbered}\n\nIf you get the error message\n\n```         \nError in seq.default(from, to, by) : invalid '(to - from)/by' \n```\n\nwhen trying to run a chunk of code that generates a plot, this is most likely due to your Plots pane in *RStudio* not being large enough to accommodate the plot. If you increase its size and rerun the chunk, your plot should appear in the Plots pane as expected.\n\nIf you have a small screen, you can also click on the \"üîé Zoom\" button at the top of the Plots pane to view your plot in a separate *RStudio* window, which you can resize according to your needs.\n:::\n\nTo compare the distributions of occupations of the male and female L2 participants, we can combine a `filter()` operation to select only the L2 participants, with a `facet_wrap()` layer (see @fig-BarOccupGroupL2Facet).\n\n\n::: {.cell source-line-numbers='2,5'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  facet_wrap(~ Gender) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\",\n       title = \"Occupational groups of L2 participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BarOccupGroupL2Facet-1.pdf){#fig-BarOccupGroupL2Facet fig-pos='H' fig-alt='Bar plot titled Occupational groups of L2 participants showing the number of female and male participants across four occupational groups. The plot is divided into two panels: F and M. In both the highest number belongs to the group PS.'}\n:::\n:::\n\n\nTo explore potential gender differences in occupational groups across both L1 and L2 groups, we can combine the two variables within the `facet_wrap()` function (see @fig-TwoFacetsBarplot).\n\n\n::: {.cell source-line-numbers='4'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  facet_wrap(~ Group + Gender) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-TwoFacetsBarplot-1.pdf){#fig-TwoFacetsBarplot fig-pos='H' fig-alt='Bar plot showing the number of participants across four occupational groups, split by language group (L1 and L2) and gender (F and M). The plot has four panels. L1 Female participant counts are relatively even across groups, with the highest in PS. In L2 Female panel a large number of participants are in the PS group, in L1 Male panel all occupational groups have similar participant counts, and in L2 Male panel PS and M have the highest counts.'}\n:::\n:::\n\n\n### Scales {#sec-scales}\n\n**Scale** layers allow us to map data values to the visual values of an aesthetic. For example, to make our facetted plot in @fig-TwoFacetsBarplot easier to read, we could add some colour using a **fill** aesthetic to fill each bar with a colour that corresponds to the participants' gender. To do so, we map each unique value of the variable `Gender` (\"F\" and \"M\") onto a colour that is then used to fill the corresponding bars of our bar plot. Adding the **fill** aesthetic automatically generates a legend (see @fig-ColourBarplot).\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, \n                       fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group + Gender) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-ColourBarplot-1.pdf){#fig-ColourBarplot fig-pos='H' fig-alt='This is the same plot as above. The only difference is that the bars in the two F panels are in the colour light red, and the bars in the two M panels are in the colour blue. There is a legend titled Gender on the right side of the plot that shows which colour shows which category.'}\n:::\n:::\n\n\nAs we did not specify any **fill** colours for @fig-ColourBarplot, {ggplot2} used default colours taken from the {scales} package of the tidyverse environment. This is because, in the Grammar of Graphics, colour palettes are governed by **scales**. To specify a different set of colours, we therefore need to specify a **scale layer**.\n\nOne way to do this is to use `scale_fill_manual()` to manually pick our own colours, either using [`R` colour codes](https://r-charts.com/colors/) (such as `purple`) or [hexadecimal colour codes](https://www.w3schools.com/colors/colors_picker.asp) (such as `#34027d`). Note that both types of colour codes must be enclosed in quotation marks.\n\n\n::: {.cell source-line-numbers='3,8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, \n                       fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group + Gender) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_fill_manual(values = c(\"purple\", \"#34027d\"))\n```\n\n::: {.cell-output-display}\n![A facetted bar plot with hand-picked colours](10_Dataviz_files/figure-pdf/fig-PurpleBarplot-1.pdf){#fig-PurpleBarplot fig-pos='H' fig-alt='This is the same plot as above. The only difference is that the bars in the two F panels are in the colour light purple, and the bars in the two M panels are in the dark purple.'}\n:::\n:::\n\n\nAlthough it makes the plot easier to interpret, the colour aesthetic (here `fill`) is not strictly necessary to understand the data represented in @fig-PurpleBarplot. After all, the two `gender` subgroups are already distinguished by the `facet_wrap()` layer. That's not necessarily a bad thing, but you must consider whether such redundant elements facilitate the interpretation of the data visualised or not.\n\nIn some cases, colour is used as the *only* way of identifying subgroups in the data, for example in a **stacked bar plot** (see @fig-ColourStackedBarplot). In such cases, it is important to consider how the plot will be perceived by different people (see note on colour blindness below).\n\n\n::: {.cell source-line-numbers='3,5'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, \n                       fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_fill_manual(values = c(\"purple\", \"#34027d\"))\n```\n\n::: {.cell-output-display}\n![A stacked bar plot with hand-picked colours](10_Dataviz_files/figure-pdf/fig-ColourStackedBarplot-1.pdf){#fig-ColourStackedBarplot fig-pos='H' fig-alt='Bar plot showing the number of participants across four occupational groups, split by two language groups (L1 and L2). Each bar in this plot contains two colours: light purple representing female participants and dark purple representing male ones. There is a legend titled Gender on the right side of the plot.'}\n:::\n:::\n\n\n**Scale** layers can be used to control the axes of your plots. Play around with the \"expand\" and \"limits\" arguments of the `scale_y_continuous()` function to understand how they work.\n\n\n::: {.cell source-line-numbers='9,10'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60))  \n```\n\n::: {.cell-output-display}\n![A bar plot with a y-axis that starts at zero.](10_Dataviz_files/figure-pdf/fig-PurpleBarplot0-1.pdf){#fig-PurpleBarplot0 fig-pos='H' fig-alt='This is the same facetted bar plot as above except that now the plot area start exactly at zero.'}\n:::\n:::\n\n\n::: {.callout-note collapse=\"false\"}\n#### A note on colours and colour blindness üåà\n\nColour blindness is a condition that results in a decreased ability to see colours and perceive differences in colour. There are different types of colour blindness but, in general, it is best to avoid red-green contrasts. To ensure that your data visualisations are accessible to as many people as possible, you may want to use the [{colorBlindness}](https://cran.r-project.org/web/packages/colorBlindness/vignettes/colorBlindness.html) package [@ouColorBlindnessSafeColor2021] to simulate the appearance of a set of colours for people with different forms of colour blindness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"colorBlindness\")\nlibrary(colorBlindness)\n\ncolorBlindness::displayAllColors(scales::hue_pal()(6))\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nUsing the {colorBlindness} package, we can immediately see that the default {scales} discrete palette that {ggplot2} used in @fig-ColourBarplot is not accessible to colour blind people (deuteranope and protanope), nor is it distinguishable when printed in grey-scale (desaturate). In contrast, our hand-picked colours from @fig-PurpleBarplot fare much better.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolorBlindness::displayAllColors(c(\"pink\", \"#34027d\"))\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nBut you need not manually pick colours, as many people have developed and shared `R` packages that feature attractive, ready-to-use colour-blind friendly palettes. The [{viridis}](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html) package [@garnierSjmgarnierViridisCRAN2023], for example, includes eight such palettes (\"magma\", \"inferno\", \"plasma\", \"cividis\", \"rocket\", \"turbo\") that also reproduce well in grey-scale. And, as it is included in the {ggplot2} installation, you don't even need to install the {viridis} package separately!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolorBlindness::displayAllColors(viridis::viridis(6))\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nChoosing an appropriate palette is not the only way to make your visualisations accessible to colour-blind readers. Another way is to provide redundant mappings to other aesthetics such as size, line type, shape, or pattern. Finally, it is important to remember that colour blindness is by no means the only type of visual impairment you should consider when creating visualisations. Worldwide, far more people are affected by **blindness** and **low vision**. @sec-QuartoFigures explains how to add **alternative texts** (alt-text) to plots and images. Many people with visual impairments rely on screen readers that use these alternative texts to provide audio descriptions of images and plots. These alternative texts can also improve the experience of users facing internet connection issues resulting in images that do not load properly or quickly enough.\n:::\n\nSome academic publishers still require grey-scale plots, in which case you will want to use the **scale** layer `scale_fill_grey()`. Alternatively, the colour palettes of the {viridis} package (see information box on colour blindness) render well in grey, too. The {viridis} function for a discrete colour scale (as needed for a categorical variable such as `Gender`) can be called up using the `scale_fill_viridis_d()` function. With the \"option\" argument, you can switch between eight different viridis palettes (\"magma\", \"inferno\", \"plasma\", \"cividis\", \"rocket\", \"turbo\").\n\n::: panel-tabset\n###### scale_fill_grey()\n\n\n::: {.cell source-line-numbers='9'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,35)) +\n  scale_fill_grey()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GreyBarplot-1.pdf){#fig-GreyBarplot fig-pos='H'}\n:::\n:::\n\n\n###### scale_fill_viridis_d\n\n\n::: {.cell source-line-numbers='9'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,35)) +\n  scale_fill_viridis_d(option = \"viridis\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-ViridisBarplot-1.pdf){#fig-ViridisBarplot fig-pos='H'}\n:::\n:::\n\n\n###### scale_fill_viridis_d(option = \"turbo\")\n\n\n::: {.cell source-line-numbers='9'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = Gender)) +\n  geom_bar() +\n  facet_wrap(~ Group) +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,35)) +\n  scale_fill_viridis_d(option = \"turbo\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-ViridisTurboBarplot-1.pdf){#fig-ViridisTurboBarplot fig-pos='H'}\n:::\n:::\n\n:::\n\nIf you like colours, check out the {paletteer} package [@hvitfeldtPaletteerComprehensiveCollection2021], which provides a neat interface to access a very large collection of `R` colour packages, some of which are very fun! The advantage is that you only need to install one package (`install.packages(\"paletteer\")`) to have a huge range of palettes at your disposal. Below is a small selection of some personal favourites.\n\n::: panel-tabset\n##### beyonce::X11\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) +\n  paletteer::scale_fill_paletteer_d(\"beyonce::X11\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BeyonceBarplot-1.pdf){#fig-BeyonceBarplot fig-pos='H'}\n:::\n:::\n\n\n##### BridgetRiley\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) + \n  paletteer::scale_fill_paletteer_d(\"lisa::BridgetRiley\", direction = -1)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-BridgetRileyBarplot-1.pdf){#fig-BridgetRileyBarplot fig-pos='H'}\n:::\n:::\n\n\n##### janelle\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) +\n  paletteer::scale_fill_paletteer_d(\"rockthemes::janelle\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-JanelleBarplot-1.pdf){#fig-JanelleBarplot fig-pos='H'}\n:::\n:::\n\n\n##### FridaKahlo\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) +\n  paletteer::scale_fill_paletteer_d(\"lisa::FridaKahlo\", direction = -1)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-FridaKahloBarplot-1.pdf){#fig-FridaKahloBarplot fig-pos='H'}\n:::\n:::\n\n\n##### kiss\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) +\n  paletteer::scale_fill_paletteer_d(\"ltc::kiss\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-KissBarplot-1.pdf){#fig-KissBarplot fig-pos='H'}\n:::\n:::\n\n\n##### speakNow\n\n\n::: {.cell source-line-numbers='8'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = OccupGroup, fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Participants\") +\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,60)) +\n  paletteer::scale_fill_paletteer_d(\"tayloRswift::speakNow\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-SpeakNowBarplot-1.pdf){#fig-SpeakNowBarplot fig-pos='H'}\n:::\n:::\n\n:::\n\n### Themes {#sec-themes}\n\nThe {ggplot2} framework also allows for the addition of an optional `theme()` **layer** to further customise the look of plots. The default {ggplot2} theme is `theme_grey()`. Here are some of the pre-built themes that come with the {ggplot2} library for you to compare. As with colour palettes, you can install additional libraries that will give you access to literally hundreds of ready-made themes for you to explore.\n\n::: panel-tabset\n##### theme_bw()\n\n\n::: {.cell source-line-numbers='6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### theme_dark()\n\n\n::: {.cell source-line-numbers='6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\") +\n  theme_dark()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### theme_light()\n\n\n::: {.cell source-line-numbers='6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\") +\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### theme_minimal()\n\n\n::: {.cell source-line-numbers='6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### theme_void()\n\n\n::: {.cell source-line-numbers='6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n:::\n\n:::\n\nPretty much all aspects of plot themes can be customised. To demonstrate this, @fig-SillyTheme displays a bar plot with some highly customised aesthetics. I will let you judge how meaningful these custom choices are and whether they genuinely help the reader to interpret the data... ü§®\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See {ggplot2} code to generate plot.\"}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = OccupGroup, fill = Gender)) +\n  geom_bar() +\n  labs(x = \"Occupational group\",\n       y = \"Number of participants\",\n        title = \"An example of an extravagantly customised ggplot...\") +\n    theme(\n      panel.background = element_rect(fill = \"#FFC080\", color = NA),\n      panel.grid.major = element_line(color = \"gold\", linewidth = 1.5),\n      panel.grid.minor = element_line(color = \"grey20\", linewidth = 0.5),\n      axis.title.x = element_text(face = \"bold\", size = 12, color = \"brown\", angle = 10),\n      axis.title.y = element_text(size = 25, color = \"green\", family = \"Courier New\"),\n      axis.text.x = element_text(face = \"italic\", size = 12, color = \"cyan\"),\n      axis.text.y = element_text(size = 14, color = \"grey\"),\n      plot.title = element_text(face = \"bold\", size = 10, color = \"purple\", family = \"Comic Sans MS\")\n      )\n```\n:::\n\n\n::: {#fig-SillyTheme .content-visible when-format=\"pdf\"}\n![](images/SillyTheme.png)\n:::\n\n### Coordinates {#sec-coordinates}\n\nBy default, the coordinate system that is used in `ggplot` objects is the **Cartesian coordinate system**, which has a horizontal axis (*x*) and a vertical axis (*y*) that are perpendicular to each other. To change this default Cartesian coordinate system, we need to add a **coordinate layer**.\n\nFor example, if we want to display the full names of the four occupational groups used in @DabrowskaExperienceAptitudeIndividual2019, we can change the labels of the categories using `mutate()` and `fct_recode()` *before* pipping the data into `ggplot()` (see @sec-ggplotData) and then flip the *x* and *y* axes using the coordinate layer `coord_flip()`. As shown in @fig-FlippedBarplot, this makes long labels much easier to read.\n\n\n::: {.cell source-line-numbers='2-6,13'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  mutate(OccupGroup = fct_recode(OccupGroup,\n                                 `Professionally inactive` = \"I\",\n                                 `Clerical profession` = \"C\",\n                                 `Manual profession` = \"M\",\n                                 `Professional-level job/\\nstudent` = \"PS\")) |> \n  mutate(Gender = fct_rev(Gender)) |> \n  ggplot(mapping = aes(x = OccupGroup, fill = Gender)) +\n  geom_bar() +\n  labs(x = NULL,\n       y = \"Participants\") +\n  scale_fill_viridis_d() +\n  coord_flip() +\n  theme_minimal() +\n  theme(axis.text = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-FlippedBarplot-1.pdf){#fig-FlippedBarplot fig-pos='H' fig-alt='A horizontal bar plot showing the number of participants by occupational group and gender. The chart shows four occupational categories on the y-axis with their full names: Professional-level job/student, Manual profession, Professionally inactive, and Clerical profession.'}\n:::\n:::\n\n\nThe vast majority of statistical graphs use the Cartesian coordinate system. Pie charts and other circular plots, however, use the **polar coordinate system** (`coord_polar`), whereby quantities are mapped onto angles rather than distances. In general, humans are much better at judging lengths than angles or areas [@clevelandGraphicalPerceptionVisual1987], which is why circular graphs such as pie charts are typically *not* recommended forms of good data visualisations [see, e.g. @fewPiesDessert]. That said, they *can* be produced using the {ggplot2} library by adding the **coordinate** layer `coord_polar(\"y\")` and modifying a few parameters.\n\n\n::: {.cell source-line-numbers='8-13'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  mutate(OccupGroup = fct_recode(OccupGroup,\n                                 `Professionally inactive` = \"I\",\n                                 `Clerical profession` = \"C\",\n                                 `Manual profession` = \"M\",\n                                 `Professional-level job/\\nstudent` = \"PS\")) |> \n  ggplot(mapping = aes(x = \"\", fill = OccupGroup)) +\n  geom_bar(width = 1) +\n  labs(fill = \"Occupational group\") +\n  scale_fill_viridis_d(direction = -1) +\n  coord_polar(\"y\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-OccupGroupPieChart-1.pdf){#fig-OccupGroupPieChart fig-pos='H' fig-alt='This is a pie chart of the data above. A legend on the right identifies each occupational group with its corresponding color.'}\n:::\n:::\n\n\n## The semantics of graphics {#sec-Semantics}\n\nSo far, we have seen how the syntax of the Grammar of Graphics can be used to build statistical graphs layer by layer. We now turn to the **semantics** of graphics. As linguists are well placed to know, semantics is the study of **meaning**. In the Grammar of Graphics, the semantics of graphics is defined as \"the meanings of the representative symbols and arrangements we use to display information\" [@wilkinsonGrammarGraphics2005: 20]. In what follows, we will see how thinking about the semantics of graphics can help us to think about how the different components of a graph interact to convey insightful visual information from raw data. This will help us to make informed choices when choosing the geometries, scales, facets, and themes of our data visualisations.\n\nBut, first, let's think about **why** we visualise data. Data visualisation is about more than just communicating the results of our analyses to **others** at the publication stage. In fact, good data visualisation can help **us** make informed decisions throughout the research process from the data wrangling stage to the evaluation of complex statistical models. Here are some reasons for visualising data. Can you think of others? ü§î\n\n:::::: columns\n::: {.column width=\"40%\"}\n**For yourself**\n\n-   To explore your data\n-   To detect data processing errors and outliers\n-   To check assumptions of statistical tests or models (see @sec-Assumptions and @sec-AssumptionsLR)\n-   To examine variation across different subsets of the data\n-   To better interpret the results of statistical tests (see @sec-Inferential) and models (see @sec-SLR and [-@sec-MLR])\n:::\n\n::: {.column width=\"10%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"40%\"}\n**For others**\n\n-   To communicate the results of your analyses more effectively\n-   To communicate about your data (in more detail)\n-   To communicate complex information more efficiently\n-   To attract the reader's attention\n-   To allow the reader to reach their own conclusions\n:::\n::::::\n\n![Using the {ggplot2} package for data exploration (artwork by [\\@allison_horst](https://allisonhorst.com/))](images/AHorst_ggplot2_explore.png){#fig-ExplorerMonster fig-alt=\"A group of fuzzy round monsters with binoculars, backpacks and guide books looking up a graphs flying around with wings (like birders, but with exploratory data visualizations). Stylized text reads ‚Äúggplot2: visual data exploration.‚Äù\"}\n\nDepending on the type of data that we want to visualise and why, we can choose different types of plots. A great resource to choose a graphic that is suitable for your data is [the `R` Graph Gallery](https://r-graph-gallery.com/).\n\nIn the following, we will first look at how we can plot **categorical variables** and **discrete numeric variables**, before we move on to visualising **continuous numeric variables** and combinations of different types of variables (see @sec-Variables).\n\n### Bar plots\n\nAs we saw in @Sec-Syntax, bar plots (also called **bar charts**) are a great way to visualise **categorical variables**. We also saw that, when using horizontal writing systems, it is often easier to interpret a bar plot if its coordinates are flipped so that longer labels can be read more readily.\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.2**]{style=\"color:green;\"} Study @fig-NativeLanguagesBarplot and think about which {ggplot2} functions were used to generate it. ü§î\n\nThen, click on the \"Show `R` code\" button to compare your intuitions with the actual code. Note that there may well be more than one solution, so do try out your version and see if you can spot any differences!\n:::\n::::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show `R` code.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  mutate(NativeLg = fct_rev(fct_infreq(NativeLg))) |> \n  ggplot(aes(x = NativeLg, \n           fill = NativeLgFamily)) +\n  geom_bar() +\n  coord_flip() +\n  scale_fill_viridis_d(option = \"F\") +\n  scale_y_continuous(limits = c(0, 40)) +\n  theme_minimal() +\n  labs(x = NULL, \n       y = NULL, \n       fill = \"Language family\",\n       title = \"Native languages of L2 participants\") +\n  theme_minimal(base_size = 16)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-NativeLanguagesBarplot-1.pdf){#fig-NativeLanguagesBarplot fig-pos='H' fig-alt='A horizontal bar plot titled showing the distribution of native languages among second language learners, with bars colored by language family.'}\n:::\n:::\n\n\nTo create @fig-NativeLanguagesBarplot, we first reordered the factor levels of the `NativeLg` variable using two functions from the {forcats} package (see @sec-Factors): `fct_infreq()` is first used to order the factors according to their frequency (by default, they are sorted alphabetically), and then `fct_rev()` is used to reverse that order. The latter step is needed because the `coord_flip()` functions reverses everything. You can check the order of a factor's level using the function `levels()`. Note that, if two levels have the same number of occurrences, they are ordered alphabetically (as seen in @fig-NativeLanguagesBarplot).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(Dabrowska.data$NativeLg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Cantonese\"  \"Chinese\"    \"French\"     \"German\"     \"Greek\"     \n [6] \"Italian\"    \"Lithuanian\" \"Mandarin\"   \"Polish\"     \"Russian\"   \n[11] \"Spanish\"   \n```\n\n\n:::\n\n```{.r .cell-code}\nlevels(fct_infreq(Dabrowska.data$NativeLg))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Polish\"     \"Mandarin\"   \"Lithuanian\" \"Cantonese\"  \"Chinese\"   \n [6] \"Spanish\"    \"French\"     \"Russian\"    \"German\"     \"Greek\"     \n[11] \"Italian\"   \n```\n\n\n:::\n\n```{.r .cell-code}\nlevels(fct_rev(fct_infreq(Dabrowska.data$NativeLg)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Italian\"    \"Greek\"      \"German\"     \"Russian\"    \"French\"    \n [6] \"Spanish\"    \"Chinese\"    \"Cantonese\"  \"Lithuanian\" \"Mandarin\"  \n[11] \"Polish\"    \n```\n\n\n:::\n:::\n\n\n:::::::: {.content-visible when-format=\"html\"}\n::::::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.3**]{style=\"color:green;\"} Compare the two plots below. Which one makes it easier to see which occupational group has the fewest participants and why?\n\n:::::: columns\n::: {.column width=\"45%\"}\n**Bar plot**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show `R` code for the bar plot\"}\nDabrowska.data |> \n  mutate(OccupGroup = fct_recode(OccupGroup,\n                                 `Professionally inactive` = \"I\",\n                                 `Clerical profession` = \"C\",\n                                 `Manual profession` = \"M\",\n                                 `Professional-level job/\\nstudent` = \"PS\")) |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = OccupGroup, \n                       fill = OccupGroup)) +\n  geom_bar() +\n  labs(x = NULL,\n       y = \"Participants\") +\n  scale_fill_viridis_d() +\n  coord_flip() +\n  theme_minimal() +\n  theme(axis.text = element_text(size = 15),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-Barplot-1.pdf){#fig-Barplot fig-pos='H'}\n:::\n:::\n\n:::\n\n::: {.column width=\"8%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"37%\"}\n**Pie chart**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show `R` code for the pie chart\"}\nDabrowska.data |> \n  mutate(OccupGroup = fct_recode(OccupGroup,\n                                 `Professionally inactive` = \"I\",\n                                 `Clerical profession` = \"C\",\n                                 `Manual profession` = \"M\",\n                                 `Professional-level job/\\nstudent` = \"PS\")) |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = \"\", fill = OccupGroup)) +\n    geom_bar(width = 1) +\n    scale_fill_viridis_d(direction = -1) +\n    coord_polar(\"y\") +\n    theme_void(base_size = 20) # This increases the font size.\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-PieChart-1.pdf){#fig-PieChart fig-pos='H'}\n:::\n:::\n\n:::\n::::::\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_3\" onsubmit=\"return validate_form_Q10_3()\" method=\"post\">\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_3_1\" value=\"The bar plot because the labels are immediately next to the corresponding bars.\"/>\nThe bar plot because the labels are immediately next to the corresponding bars.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_3_2\" value=\"The bar plot because humans are better at distinguishing small differences in lengths than in angles.\"/>\nThe bar plot because humans are better at distinguishing small differences in lengths than in angles.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_3_3\" value=\"The bar plot because humans dislike round objects and prefer objects with sharp angles.\"/>\nThe bar plot because humans dislike round objects and prefer objects with sharp angles.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_3_4\" value=\"The pie chart as most humans learn to read clocks early on in life.\"/>\nThe pie chart as most humans learn to read clocks early on in life.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_3_5\" value=\"The pie chart because the colours are easier to distinguish when they are close to each other.\"/>\nThe pie chart because the colours are easier to distinguish when they are close to each other.\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_3\"></div>\n</form>\n<script>function validate_form_Q10_3() {var text; var x1 = document.getElementById('answer_Q10_3_1'); var x2 = document.getElementById('answer_Q10_3_2'); var x3 = document.getElementById('answer_Q10_3_3'); var x4 = document.getElementById('answer_Q10_3_4'); var x5 = document.getElementById('answer_Q10_3_5'); if (x1.checked == true&x2.checked == true&x3.checked == false&x4.checked == false&x5.checked == false){text = 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.';} else {text = 'No, try again.';} document.getElementById('result_Q10_3').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.';text = res1;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_71008\" onmouseover=\"return show_hint_71008()\">ü¶â Hover over the owl for a first hint.</div>\n<div id=\"result_71008\" onmouseover=\"return show_hint_71008()\"></div>\n<script>function show_hint_71008(){var x = document.getElementById('result_71008').innerHTML; if(!x){document.getElementById('result_71008').innerHTML = 'Check out Section 10.1.10.';} else {document.getElementById('result_71008').innerHTML = '';}}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_56318\" onclick=\"return show_hint_56318()\">üê≠ Click on the mouse for a second hint.</div>\n<div id=\"result_56318\" onclick=\"return show_hint_56318()\"></div>\n<script>function show_hint_56318(){var x = document.getElementById('result_56318').innerHTML; if(!x){document.getElementById('result_56318').innerHTML = 'Two reasons are correct.';} else {document.getElementById('result_56318').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n:::::::\n::::::::\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\nUsing the {ggplot2} library, create a bar plot that shows the distribution of occupational groups (`OccupGroup`) among male L1 and L2 participants in @DabrowskaExperienceAptitudeIndividual2019's study.\n\n[**Q10.4**]{style=\"color:green;\"} Drawing on the information provided by your bar plot, how many male participants reported having manual jobs?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_4\" onsubmit=\"return validate_form_Q10_4()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_4\" id=\"answer_Q10_4_1\" value=\"under 10\"/>\nunder 10\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_4\" id=\"answer_Q10_4_2\" value=\"exactly 12\"/>\nexactly 12\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_4\" id=\"answer_Q10_4_3\" value=\"exactly 20\"/>\nexactly 20\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_4\" id=\"answer_Q10_4_4\" value=\"exactly 30\"/>\nexactly 30\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_4\" id=\"answer_Q10_4_5\" value=\"a little more than 40\"/>\na little more than 40\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_4\"></div>\n</form>\n<script>function validate_form_Q10_4() {var x, text; var x = document.forms['form_Q10_4']['answer_Q10_4'].value;if (x == 'exactly 20'){text = 'That‚Äôs right! Your bar plot should make that immediately obvious.';} else {text = 'No, are you sure that you have plotted the distribution of occupational groups among male participants only?';} document.getElementById('result_Q10_4').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.';text = res1 + res2;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.4\"}\nDabrowska.data |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = OccupGroup)) +\n  geom_bar() +\n  labs(x = \"Occupational group\", \n       y = \"Male participants\") +\n  theme_minimal()\n```\n:::\n\n\n[**Q10.5**]{style=\"color:green;\"} Is the legend in the bar plot that you have created necessary?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_5\" onsubmit=\"return validate_form_Q10_5()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_5\" id=\"answer_Q10_5_1\" value=\"No, it only adds clutter.\"/>\nNo, it only adds clutter.\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_5\" id=\"answer_Q10_5_2\" value=\"Yes, it makes the plot easier to interpret.\"/>\nYes, it makes the plot easier to interpret.\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_5\" id=\"answer_Q10_5_3\" value=\"Not really, but it makes the plot look more professional.\"/>\nNot really, but it makes the plot look more professional.\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_5\" id=\"answer_Q10_5_4\" value=\"Not really, but it&#39;s impossible to remove the legend using the {ggplot2} library.\"/>\nNot really, but it's impossible to remove the legend using the {ggplot2} library.\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_5\"></div>\n</form>\n<script>function validate_form_Q10_5() {var x, text; var x = document.forms['form_Q10_5']['answer_Q10_5'].value;if (x == 'No, it only adds clutter.'){text = 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click below to find out how to integrate this in ggplot2 code.';} else {text = 'Are you sure?';} document.getElementById('result_Q10_5').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1;res1 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click below to find out how to integrate this in ggplot2 code.';text = res1;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell source-line-numbers='7'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See code.\"}\nDabrowska.data |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = OccupGroup, \n                       fill = OccupGroup)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n:::\n\n\n[**Q10.6**]{style=\"color:green;\"} Create a pie chart that shows the distribution of occupational groups among male participants (as shown in @fig-OccupGroupPieChart). Which line of code is essential to create a pie chart using {ggplot2}?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_6\" onsubmit=\"return validate_form_Q10_6()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_6\" id=\"answer_Q10_6_1\" value=\"coord_polar(&quot;y&quot;)\"/>\ncoord_polar(\"y\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_6\" id=\"answer_Q10_6_2\" value=\"theme_void()\"/>\ntheme_void()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_6\" id=\"answer_Q10_6_3\" value=\"coord(&quot;polar&quot;)\"/>\ncoord(\"polar\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_6\" id=\"answer_Q10_6_4\" value=\"geom_piechart()\"/>\ngeom_piechart()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_6\" id=\"answer_Q10_6_5\" value=\"geom_circle()\"/>\ngeom_circle()\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_6\"></div>\n</form>\n<script>function validate_form_Q10_6() {var x, text; var x = document.forms['form_Q10_6']['answer_Q10_6'].value;if (x == 'coord_polar(\"y\")'){text = 'Yes, well done!';} else {text = 'Not quite. Try adding and removing these lines of code in your piechart script to see the effect. If you‚Äôre stuck, check out the code answer below.';} document.getElementById('result_Q10_6').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!';text = res1 + res2 + res3 + res4;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code to create pie chart below.\"}\nDabrowska.data |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = \"\", \n                       fill = OccupGroup)) +\n    geom_bar(width = 1) +\n    coord_polar(\"y\") +\n    theme_void()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-18-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n[**Q10.7**]{style=\"color:green;\"} Transform the pie chart that you just created in [c.]{style=\"color:green;\"} to make it look like @fig-PieChartRecode. To achieve this, wrangle the data *before* piping it into the `data` argument of the `ggplot()` function. Which {tidyverse} function can you use to rename the labels?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_7\" onsubmit=\"return validate_form_Q10_7()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_7\" id=\"answer_Q10_7_1\" value=\"fct_relevel()\"/>\nfct_relevel()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_7\" id=\"answer_Q10_7_2\" value=\"labs()\"/>\nlabs()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_7\" id=\"answer_Q10_7_3\" value=\"fct_mutate()\"/>\nfct_mutate()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_7\" id=\"answer_Q10_7_4\" value=\"rename()\"/>\nrename()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_7\" id=\"answer_Q10_7_5\" value=\"fct_recode()\"/>\nfct_recode()\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_7\"></div>\n</form>\n<script>function validate_form_Q10_7() {var x, text; var x = document.forms['form_Q10_7']['answer_Q10_7'].value;if (x == 'fct_recode()'){text = 'Absolutely!';} else {text = 'No, that won‚Äôt do the trick. Re-read Section 10.1.6 for a quick recap.';} document.getElementById('result_Q10_7').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!';text = res1 + res2 + res3 + res4 + res5;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell source-line-numbers='1-6,13'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.7\"}\nDabrowska.data |> \n  mutate(`OccupGroup` = fct_recode(OccupGroup,\n                                 `Professionally inactive` = \"I\",\n                                 `Clerical profession` = \"C\",\n                                 `Manual profession` = \"M\",\n                                 `Professional-level job` = \"PS\")) |> \n  filter(Gender == \"M\") |> \n  ggplot(mapping = aes(x = \"\", \n                       fill = OccupGroup)) +\n  geom_bar(width = 1) +\n  coord_polar(\"y\") +\n  theme_void() +\n  labs(fill = \"Occupational group\") # This last line of code changes the title of the legend, which is the label for the variable associated with the `fill` aestetics. \n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-PieChartRecode-1.pdf){#fig-PieChartRecode fig-pos='H'}\n:::\n:::\n\n\n¬†\n:::\n::::\n\n### Histograms {#sec-histograms}\n\nIn @sec-DistributionsNumeric, we visually examined the distribution of participants' ages in a **bar plot**. This was possible because the age variable in @DabrowskaExperienceAptitudeIndividual2019 was recorded as a discrete numeric variable (i.e. either as 18 or 19, but not 18.4 years of age).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(Age)) +\n  geom_bar() +\n  scale_x_continuous() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-AgeBarPlot-1.pdf){#fig-AgeBarPlot fig-pos='H'}\n:::\n:::\n\n\nBar plots are best suited for categorical data and should only be used to visualise discrete numeric variables that have a fairly limited number of possible values. As we can see from the output of the `unique()` function, this is not the case for the `Age` variable in `Dabrowska.data`, as it includes 40 different age values, ranging from 17 to 65.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(Dabrowska.data$Age) |> \n  sort()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 37 38 39 40 41 42\n[26] 44 46 47 48 51 52 53 55 57 58 59 60 61 62 65\n```\n\n\n:::\n:::\n\n\nThe distribution of participants' ages is therefore better visualised as a histogram or density plot. To visualise participants' age as **histogram** (\\@fig-AgeHistogram) rather than as a bar plot (\\@fig-AgeBarPlot), change the plot geometry (see @sec-geoms) from `geom_bar()` to `geom_histogram()`.\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Age)) +\n  geom_histogram() +\n  labs(x = \"Age (in years)\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-AgeHistogram-1.pdf){#fig-AgeHistogram fig-pos='H'}\n:::\n:::\n\n\nWhen generating this histogram, a message appears in the `R` console that informs us that, by default, the `geom_histogram()` function subdivided the `Age` values into 30 **bins**. This means that the age range from 17 to 65 has been subdivided into 30 groups of equal size. Given that there is a range of 48 in the `Age` values in this dataset, this is not a great way to subdivide the values of this variable.\n\nAs indicated in the message, to change this behaviour, we can adjust the value of the \"binwidth\" argument. This argument determines how many years go in each bin. So if we choose to have two years in each subdivision of the `Age` variable, we will end up with 24 bins. Logically, if we decide to group four years in each subdivision of the `Age` variable, we will end up with just 12 bins.\n\nCompare the three histograms below. In your opinion, which binwidth provides the most effective way to visualise the distribution of participants' ages? ü§î\n\n::: panel-tabset\n##### `default bin width`\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Age)) +\n  geom_histogram() +\n  labs(x = \"Age (in years)\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-20-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### `binwidth = 2`\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Age)) +\n  geom_histogram(binwidth = 2) +\n  labs(x = \"Age (in years)\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-21-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n##### `binwidth = 4`\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Age)) +\n  geom_histogram(binwidth = 4) +\n  labs(x = \"Age (in years)\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-22-1.pdf){fig-pos='H'}\n:::\n:::\n\n:::\n\nThe distribution of two continuous variables can also be compared by superimposing two histograms as in \\@fig-OverlappingHisto. This requires the addition of a `fill` aesthetics (see @sec-scales) and the argument `position = \"identity\"`. For both distributions to be visible, it is also necessary to add some transparency to the fill colour of the bars. This is achieved using the `alpha` argument of the `geom_histogram()` function. An alpha value of `0` corresponds to full transparency (e.g. no colour), whilst an alpha value of `1` corresponds to complete opacity.\n\n\n::: {.cell source-line-numbers='3:4,5:6'}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Age,\n                     fill = Group)) + \n  geom_histogram(binwidth = 5,\n                 position = \"identity\",\n                 alpha = 0.5) +\n  scale_fill_viridis_d() +\n  labs(x = \"Age (in years)\",\n       y = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-OverlappingHisto-1.pdf){#fig-OverlappingHisto fig-pos='H'}\n:::\n:::\n\n\n:::::::::::: {.content-visible when-format=\"html\"}\n::::::::::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.8**]{style=\"color:green;\"} How many different scores did participants obtain on the English grammar test (as stored in the `Grammar` variable).\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_8\" onsubmit=\"return validate_form_Q10_8()\" method=\"post\">\n<input type=\"text\" placeholder=\"\" name=\"answer_Q10_8\"/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_8\"></div>\n</form>\n<script>function validate_form_Q10_8() {var x, text; var x = document.forms['form_Q10_8']['answer_Q10_8'].value;if (x == '32'|x == 'thirty-two'|x == 'thirty two'){text = 'That‚Äôs right, well done!';} else {text = 'No, not quite.';} document.getElementById('result_Q10_8').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!';text = res1 + res2 + res3 + res4 + res5 + res6;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to help you answer Q10.8.\"}\nunique(Dabrowska.data$Grammar) |> \n  length()\n```\n:::\n\n\n[**Q10.9**]{style=\"color:green;\"} What are the lowest `Grammar` scores among L1 and L2 participants?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_9\" onsubmit=\"return validate_form_Q10_9()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_9\" id=\"answer_Q10_9_1\" value=\"45 points among L1 and zero points among L2 participants\"/>\n45 points among L1 and zero points among L2 participants\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_9\" id=\"answer_Q10_9_2\" value=\"58 points among L1 and 40 points among L2 participants\"/>\n58 points among L1 and 40 points among L2 participants\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_9\" id=\"answer_Q10_9_3\" value=\"17 points among L1 and 20 points among L2 participants\"/>\n17 points among L1 and 20 points among L2 participants\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_9\" id=\"answer_Q10_9_4\" value=\"8.89 points among L1 and -13 points among L2 participants\"/>\n8.89 points among L1 and -13 points among L2 participants\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_9\"></div>\n</form>\n<script>function validate_form_Q10_9() {var x, text; var x = document.forms['form_Q10_9']['answer_Q10_9'].value;if (x == '45 points among L1 and zero points among L2 participants'){text = 'That‚Äôs right, well done!';} else {text = 'That‚Äôs not correct. Try out the sample code below.';} document.getElementById('result_Q10_9').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to help you answer Q10.9.\"}\nDabrowska.data |> \n  group_by(Group) |> \n  summarise(lowest = min(Grammar))\n```\n:::\n\n\n[**Q10.10**]{style=\"color:green;\"} Create a histogram of participants' `Grammar` scores. Which geometrical parameters need to be used to obtain exactly the same histogram as below?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_10\" onsubmit=\"return validate_form_Q10_10()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_10\" id=\"answer_Q10_10_1\" value=\"geom_histogram()\"/>\ngeom_histogram()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_10\" id=\"answer_Q10_10_2\" value=\"geom_histogram(binwidth = 2)\"/>\ngeom_histogram(binwidth = 2)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_10\" id=\"answer_Q10_10_3\" value=\"geom_histogram(binwidth = 4)\"/>\ngeom_histogram(binwidth = 4)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_10\" id=\"answer_Q10_10_4\" value=\"geom_histogram(binwidth = 6)\"/>\ngeom_histogram(binwidth = 6)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_10\" id=\"answer_Q10_10_5\" value=\"geom_histogram(binwidth = 8)\"/>\ngeom_histogram(binwidth = 8)\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_10\"></div>\n</form>\n<script>function validate_form_Q10_10() {var x, text; var x = document.forms['form_Q10_10']['answer_Q10_10'].value;if (x == 'geom_histogram(binwidth = 6)'){text = 'Exactly!';} else {text = 'No, not quite. Look carefully at the width of the bins.';} document.getElementById('result_Q10_10').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-25-1.pdf)\n:::\n:::\n\n\n\n::: {.cell source-line-number='3'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show answer to Q10.10\"}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar)) +\n  geom_histogram(binwidth = 6) +\n  labs(x = \"Scores on English grammar test\",\n       y = \"Number of participants\") +\n  theme_bw()\n```\n:::\n\n\n[**Q10.11**]{style=\"color:green;\"} Without trying out the code for yourself, which script was used to generate Plot 1 below?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_11\" onsubmit=\"return validate_form_Q10_11()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_11\" id=\"answer_Q10_11_1\" value=\"Script A\"/>\nScript A\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_11\" id=\"answer_Q10_11_2\" value=\"Script B\"/>\nScript B\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_11\" id=\"answer_Q10_11_3\" value=\"Script C\"/>\nScript C\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_11\" id=\"answer_Q10_11_4\" value=\"Script D\"/>\nScript D\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_11\"></div>\n</form>\n<script>function validate_form_Q10_11() {var x, text; var x = document.forms['form_Q10_11']['answer_Q10_11'].value;if (x == 'Script A'){text = 'That‚Äôs right!';} else {text = 'That‚Äôs not it. If you‚Äôre stuck, try the the scripts out and compare their outputs to Plot 2.';} document.getElementById('result_Q10_11').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n**Plot 1**\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-27-1.pdf)\n:::\n:::\n\n\n:::::: columns\n::: {.column width=\"48%\"}\n**Script A**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar,\n                     fill = Group)) +\n  geom_histogram(binwidth = 6,\n                 alpha = 0.6) +\n  labs(x = \"Scores on English grammar test\",\n       y = \"Number of participants\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n:::\n\n:::\n\n::: {.column width=\"4%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"48%\"}\n**Script B**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar,\n                     fill = Group)) +\n  geom_bar(alpha = 0.6) +\n  labs(x = \"Scores on English grammar test\",\n       y = \"Number of participants\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n:::\n\n:::\n::::::\n\n:::::: columns\n::: {.column width=\"48%\"}\n**Script C**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar,\n                     colour = Group)) +\n  geom_histogram(binwidth = 6) +\n  labs(x = \"Scores on English grammar test\",\n       y = \"Number of participants\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n:::\n\n:::\n\n::: {.column width=\"4%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"48%\"}\n**Script D**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar,\n                     fill = Group)) +\n  geom_histogram(binwidth = 6,\n                 alpha = 0.6) +\n  facet_wrap(~ Group) +\n  labs(x = \"Scores on English grammar test\",\n       y = \"Number of participants\") +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n:::\n\n:::\n\n[**Q10.12**]{style=\"color:green;\"} Without trying out the code for yourself, which script was used to generate Plot 2 below?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_12\" onsubmit=\"return validate_form_Q10_12()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_12\" id=\"answer_Q10_12_1\" value=\"Script A\"/>\nScript A\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_12\" id=\"answer_Q10_12_2\" value=\"Script B\"/>\nScript B\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_12\" id=\"answer_Q10_12_3\" value=\"Script C\"/>\nScript C\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_12\" id=\"answer_Q10_12_4\" value=\"Script D\"/>\nScript D\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_12\"></div>\n</form>\n<script>function validate_form_Q10_12() {var x, text; var x = document.forms['form_Q10_12']['answer_Q10_12'].value;if (x == 'Script D'){text = 'That‚Äôs right!';} else {text = 'That‚Äôs not it. If you‚Äôre stuck, try the the scripts out and compare their outputs to Plot 2.';} document.getElementById('result_Q10_12').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n**Plot 2**\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-32-1.pdf)\n:::\n:::\n\n::::::\n:::::::::::\n::::::::::::\n\n### Density plots {#sec-Density}\n\nAn alternative to displaying the data in discrete bins is to apply a density function to smooth over the bins of the histogram. This is what we call a density plot. @fig-GrammarDensity is a density plot of participants' grammar test scores.\n\nCreate density plots in `R` using {ggplot2} is very simple. Because, yes, you've guessed it: there's a `geom_` function for density plots and it's called... `geom_density()`! üòÉ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar)) +\n  geom_density(fill = \"purple\") +\n  labs(x = \"Scores on English grammar test\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution of English vocabulary test results](10_Dataviz_files/figure-pdf/fig-GrammarDensity-1.pdf){#fig-GrammarDensity fig-pos='H'}\n:::\n:::\n\n\nDensity plots are particularly useful to examine distribution shapes visually. Looking at @fig-GrammarDensity, we can immediately see that the values of the `Grammar` variable are not normally distributed (see @sec-DistributionsNumeric).\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.13**]{style=\"color:green;\"} Which line of code needs to be added to the code used to generate @fig-GrammarDensity to produce a two-panel density plot like @fig-GrammarTwoPanelDensity?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_13\" onsubmit=\"return validate_form_Q10_13()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_13\" id=\"answer_Q10_13_1\" value=\"facets(~ &quot;Group&quot;)\"/>\nfacets(~ \"Group\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_13\" id=\"answer_Q10_13_2\" value=\"fct_wrap(&quot;Group&quot;)\"/>\nfct_wrap(\"Group\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_13\" id=\"answer_Q10_13_3\" value=\"facet_wrap(Group)\"/>\nfacet_wrap(Group)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_13\" id=\"answer_Q10_13_4\" value=\"facet_wrap(~ Group)\"/>\nfacet_wrap(~ Group)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_13\" id=\"answer_Q10_13_5\" value=\"geom_grid(Group, facet = 2)\"/>\ngeom_grid(Group, facet = 2)\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_13\"></div>\n</form>\n<script>function validate_form_Q10_13() {var x, text; var x = document.forms['form_Q10_13']['answer_Q10_13'].value;if (x == 'facet_wrap(~ Group)'){text = 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.';} else {text = 'Not quite, try these lines out yourself and check out <a href=\"sec-facets\">@sec-facets</a> to find out more.';} document.getElementById('result_Q10_13').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to help you answer Q10.13.\"}\nggplot(data = Dabrowska.data,\n       mapping = aes(x = Grammar)) +\n  geom_density(fill = \"purple\") +\n  facet_wrap(~ Group) +\n  labs(x = \"Scores on English grammar test\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GrammarTwoPanelDensity-1.pdf){#fig-GrammarTwoPanelDensity fig-pos='H'}\n:::\n:::\n\n\n[**Q10.14**]{style=\"color:green;\"} Create four density plots to visualise the distribution of participants' `ART` (Author Recognition Test), `Blocks` (non-verbal IQ test), `Colloc` (English collocation test), and `Vocab` (English vocabularly test) scores.\n\nWhich variable's distribution is closest to a normal distribution?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_14\" onsubmit=\"return validate_form_Q10_14()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_14\" id=\"answer_Q10_14_1\" value=\"ART\"/>\nART\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_14\" id=\"answer_Q10_14_2\" value=\"Blocks\"/>\nBlocks\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_14\" id=\"answer_Q10_14_3\" value=\"Colloc\"/>\nColloc\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_14\" id=\"answer_Q10_14_4\" value=\"Vocab\"/>\nVocab\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_14\" id=\"answer_Q10_14_5\" value=\"ART and Vocab\"/>\nART and Vocab\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_14\"></div>\n</form>\n<script>function validate_form_Q10_14() {var x, text; var x = document.forms['form_Q10_14']['answer_Q10_14'].value;if (x == 'Blocks'){text = 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.';} else {text = 'No, check <a href=\"https://elenlefoll.github.io/RstatsTextbook/8_DescriptiveStats.htmlsec-Normal\">Chapter 8</a> to find out more about normal and non-normal distributions.';} document.getElementById('result_Q10_14').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to help you answer Q10.13.\"}\nDabrowska.data |> \n  select(Vocab, Colloc, ART, Blocks) |>  \n  tidyr::gather() |>  # This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2\n  ggplot(aes(value)) +\n    theme_bw() +\n    facet_wrap(~ key, scales = \"free\", ncol = 2) +\n    scale_x_continuous(expand=c(0,0)) +\n    geom_density(fill = \"purple\")\n```\n:::\n\n:::\n::::\n\n::: {.callout-note collapse=\"false\"}\n#### Going further: Setting properties within geoms\n\nYou can also change the **attributes** of any geometry layer by specifying them as **arguments** within their `geom_` function.\n\nThe help file of each `geom_` function provides a list of the **aesthetics** arguments that each function has (see below for relevant extract). If we do not specify any of the optional aesthetics of the `geom_` functions, sensible default values will be used. For instance, the line colour of density plots will be black, unless otherwise specified with the argument \"colour\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?geom_density\n```\n:::\n\n\n> \\[...\\] **Aesthetics**\n>\n> `geom_density()` understands the following aesthetics (required aesthetics are in bold):\n>\n> -   [**`x`**](https://ggplot2.tidyverse.org/reference/aes_position.html)\n> -   [**`y`**](https://ggplot2.tidyverse.org/reference/aes_position.html)\n> -   [`alpha`](https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html) ‚Üí `NA`\n> -   [`colour`](https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html) ‚Üí via [`theme()`](https://ggplot2.tidyverse.org/reference/theme.html)\n> -   [`fill`](https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html) ‚Üí via [`theme()`](https://ggplot2.tidyverse.org/reference/theme.html)\n> -   [`group`](https://ggplot2.tidyverse.org/reference/aes_group_order.html) ‚Üí inferred\n> -   [`linetype`](https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html) ‚Üí via [`theme()`](https://ggplot2.tidyverse.org/reference/theme.html)\n> -   [`linewidth`](https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html) ‚Üí via [`theme()`](https://ggplot2.tidyverse.org/reference/theme.html)\n> -   `weight` ‚Üí `1`\n>\n> Learn more about setting these aesthetics in `vignette(\"ggplot2-specs\")`. \\[...\\]\n\n@fig-SillyDensityPlot is an example of a density plot with some highly customised aesthetics. It goes without saying that, just because you *can* customise many aspects of a `geom_` layer, it doesn't necessarily mean that it's a good idea to do so! üôÉ\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code to generate plot below.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(mapping = aes(x = Blocks)) +\n    geom_density(colour = \"purple\", # Sets the colour of the outline of the density plot\n                linewidth = 5, # Sets the width of the outline\n                linetype = \"dotdash\", # Sets the line type of the outline\n                fill = \"pink\", # Sets the colour of the area under the density plot\n                alpha = 0.6 # Sets the transparency level of the fill colour (with 0 being fully transparent and 1 being completely opaque)\n    ) +\n    labs(x = \"Blocks test results\",\n         title = \"L2 participants' non-verbal IQ scores\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-SillyDensityPlot-1.pdf){#fig-SillyDensityPlot fig-pos='H'}\n:::\n:::\n\n\nIt can, however, be very useful to help identify different elements within a complex plot as in @fig-UsefulDensityPlot.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code to generate plot below.\"}\n# We first create an R object that contains the mean Block scores for both L1 and L2 participants.\nmean.blocks <- Dabrowska.data |>\n  group_by(Group) |>\n  summarise(mean = mean(Blocks))\n\n# Next we plot density plots and also add a geom_vline layer to plot the mean values as vertical lines. We use the linetype argument to make the lines dotted.\nDabrowska.data |>\n  ggplot(mapping = aes(x = Blocks, \n                       fill = Group,\n                       colour = Group)) + \n  geom_density(alpha = 0.6, \n               position = \"identity\") +\n  geom_vline(data = mean.blocks, \n             aes(xintercept = mean, \n                 colour = Group), \n             linetype = \"dashed\",\n             linewidth = 0.8) +\n  scale_colour_viridis_d(guide = NULL) +\n  scale_fill_viridis_d() +\n  theme_minimal() +\n  labs(x = \"Non-verbal IQ test (Blocks) test scores\",\n       fill = NULL,\n       title = \"On average, non-native English speakers have higher IQ scores\\nthan native speakers.\",\n       caption = \"The dotted lines represent the means of each group.\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-UsefulDensityPlot-1.pdf){#fig-UsefulDensityPlot fig-pos='H'}\n:::\n:::\n\n\nTo create @fig-UsefulDensityPlot, we first calculated the mean Blocks scores for both L1 and L2 participants and stored these values in a new object called `mean.blocks` (see code link above). These values are then called within the `geom_vline()` function, which draws vertical lines. In other words, in addition to setting `aes()` mappings within the main `ggplot()` function at the start of our plot code, we can also add **additional data mappings** within a specific `geom_` function. With all these options, it's no exaggeration to say that, if you really set your mind to, pretty much anything is possible with {ggplot2}! üôÉ\n:::\n\n### Boxplots\n\nIn @sec-IQR, we saw that **boxplots** are a great way to visualise both the central tendency (median) of a numeric variable and the spread around this central tendency (IQR). There is an in-built function to create boxplots in {ggplot2}. No prizes will be awarded for guessing that the necessary `geom_` function is called... `geom_density()`! üòÜ\n\nWhilst it's possible to plot just a single boxplot, that rarely makes sense. In fact, the `x`-axis in @fig-GrammarBoxPlot is entirely nonsensical! The distribution of `Grammar` scores across the entire dataset is much better visualised as a histogram or density plot (see @sec-Density) than as a single boxplot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar)) +\n  geom_boxplot() +\n  theme_minimal() + \n  labs(y = \"Grammar scores\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GrammarBoxPlot-1.pdf){#fig-GrammarBoxPlot fig-pos='H'}\n:::\n:::\n\n\nIf, however, we want to compare the `Grammar` scores of two or more different groups of participants, a boxplot makes a lot more sense (see @fig-GrammarBoxPlotGroup). To achieve this, we add a second argument within the `aes()` function, which maps the values of the `Group` variable (which are either \"L1\" or \"L2\") to the plot's `x`-axis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = Group)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(y = \"Grammar scores\")\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GrammarBoxPlotGroup-1.pdf){#fig-GrammarBoxPlotGroup fig-pos='H'}\n:::\n:::\n\n\nThe meaning conveyed by @fig-GrammarBoxPlotGroup is clear: there is hardly any difference between the average (median) grammar comprehension test scores of L1 and L2 participants in @DabrowskaExperienceAptitudeIndividual2019's dataset. Indeed, we can see that the thicker, middle lines within each boxplot are almost at the same level. However, the two boxplots have very different shapes and overall lengths: the scores of the 50% of L2 participants who scored below the median are much more spread out than those of the L1 participants who obtained below-average scores. This makes intuitive sense: native English speakers living in the UK who volunteer for such a study are likely to all have a fairly high to very high understanding of English grammar. By contrast, the L2 speakers are much more varied: some are highly proficient in English, while others are not. This range of proficiency could due to all sorts of reasons.\n\nWhat are some of the possible reasons that you can think of? ü§î Make a note of them as we will explore these hypotheses further in @sec-Scatterplots.\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\n[**Q10.15**]{style=\"color:green;\"} Create a boxplot to compare how participants in different occupational groups (`OccupGroup`) performed on the English grammar test. Which part of the code used to produce @fig-GrammarBoxPlotGroup do you need to modify to achieve this?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_15\" onsubmit=\"return validate_form_Q10_15()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_15\" id=\"answer_Q10_15_1\" value=\"y = Grammar\"/>\ny = Grammar\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_15\" id=\"answer_Q10_15_2\" value=\"geom_boxplot()\"/>\ngeom_boxplot()\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_15\" id=\"answer_Q10_15_3\" value=\"Dabrowska.data\"/>\nDabrowska.data\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_15\" id=\"answer_Q10_15_4\" value=\"x = OccupGroup\"/>\nx = OccupGroup\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_15\"></div>\n</form>\n<script>function validate_form_Q10_15() {var x, text; var x = document.forms['form_Q10_15']['answer_Q10_15'].value;if (x == 'x = OccupGroup'){text = 'Correct!';} else {text = 'No. Check out the code solution below if you‚Äôre unsure.';} document.getElementById('result_Q10_15').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell source-line-numbers='3'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.15.\"}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = OccupGroup)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(y = \"Grammar scores\")\n```\n:::\n\n\n[**Q10.16**]{style=\"color:green;\"} The code below was used to create @fig-OccupBoxPlot, except that the arguments of the `aes()` function have been deleted. Which data mappings were specified inside the `aes()` function to produce @fig-OccupBoxPlot?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |>\n  mutate(Group = fct_recode(Group,\n                            `L1 participants` = \"L1\",\n                            `L2 participants` = \"L2\")) |> \n  ggplot(mapping = aes(‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà)) +\n    geom_boxplot(alpha = 0.8) +\n    scale_fill_viridis_d(option = \"viridis\") +\n    scale_y_continuous(breaks = seq(0, 100, 10)) +\n    labs(y = \"Grammar scores\", \n         x = NULL,\n         fill = \"Occupational group\",\n         title = \"English grammar comprehension test results\",\n         subtitle = \"among L1 and L2 participants with different occupations\") +\n    theme_bw() +\n    theme(element_text(size = 12),\n          legend.position = \"bottom\", # We move the legend to the bottom of the plot. \n          legend.box.background = element_rect()) # We add a frame around the legend.\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-OccupBoxPlot-1.pdf){#fig-OccupBoxPlot}\n:::\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_16\" onsubmit=\"return validate_form_Q10_16()\" method=\"post\">\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_1\" value=\"fill = OccupGroup\"/>\nfill = OccupGroup\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_2\" value=\"facet = Group\"/>\nfacet = Group\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_3\" value=\"legend = OccupGroup\"/>\nlegend = OccupGroup\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_4\" value=\"facet = OccupGroup\"/>\nfacet = OccupGroup\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_5\" value=\"x = Group\"/>\nx = Group\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_6\" value=\"x = OccupGroup\"/>\nx = OccupGroup\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_7\" value=\"colour = OccupGroup\"/>\ncolour = OccupGroup\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_8\" value=\"y = Grammar\"/>\ny = Grammar\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_16_9\" value=\"y = OccupGroup\"/>\ny = OccupGroup\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_16\"></div>\n</form>\n<script>function validate_form_Q10_16() {var text; var x1 = document.getElementById('answer_Q10_16_1'); var x2 = document.getElementById('answer_Q10_16_2'); var x3 = document.getElementById('answer_Q10_16_3'); var x4 = document.getElementById('answer_Q10_16_4'); var x5 = document.getElementById('answer_Q10_16_5'); var x6 = document.getElementById('answer_Q10_16_6'); var x7 = document.getElementById('answer_Q10_16_7'); var x8 = document.getElementById('answer_Q10_16_8'); var x9 = document.getElementById('answer_Q10_16_9'); if (x1.checked == true&x2.checked == false&x3.checked == false&x4.checked == true&x5.checked == true&x6.checked == false&x7.checked == false&x8.checked == true&x9.checked == false){text = 'That‚Äôs right! Well done, that wasn‚Äôt easy!';} else {text = 'No, not quite. Try out the code with these different mappings to see what effect they have.';} document.getElementById('result_Q10_16').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_91582\" onmouseover=\"return show_hint_91582()\">ü¶â Hover over the owl for a first hint.</div>\n<div id=\"result_91582\" onmouseover=\"return show_hint_91582()\"></div>\n<script>function show_hint_91582(){var x = document.getElementById('result_91582').innerHTML; if(!x){document.getElementById('result_91582').innerHTML = 'Copy the code and experiment with various combinations of the proposed mappings.';} else {document.getElementById('result_91582').innerHTML = '';}}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_81532\" onclick=\"return show_hint_81532()\">üê≠ Click on the mouse for a second hint.</div>\n<div id=\"result_81532\" onclick=\"return show_hint_81532()\"></div>\n<script>function show_hint_81532(){var x = document.getElementById('result_81532').innerHTML; if(!x){document.getElementById('result_81532').innerHTML = 'This boxplot requires a total of four data mappings.';} else {document.getElementById('result_81532').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n¬†\n:::\n::::\n\n::::::::::::::: {.callout-note collapse=\"false\"}\n#### Going further: Dot plots and violin plots\n\nThe {ggplot2} library offers many more `geom_` functions for you to explore. Here are two more types of graphs that are currently only rarely used in the language sciences, but which can be very effective ways to visualise the distribution of a numeric variable across different levels of a categorical variable.\n\n##### Dot plots {.unnumbered}\n\nIn a dot plot, each data point (corresponding, here, to a single participant) is represented by a single dot. The size of each dot corresponds to the chosen **bin width**. This makes dot plots a combination of a boxplot (see @sec-IQR) and a histogram (see @sec-histograms).\n\n:::::: columns\n::: {.column width=\"49%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n    mapping = aes(y = Colloc, \n                     x = Group)) +\n    geom_dotplot(binaxis = \"y\", \n              stackdir = \"center\",\n              binwidth = 3) +\n    labs(y = \"Scores on English collocation test\",\n         x = NULL) +\n    theme_bw()\n```\n:::\n\n:::\n\n::: {.column width=\"2%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"49%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-38-1.pdf)\n:::\n:::\n\n:::\n::::::\n\n##### Violin plots {.unnumbered}\n\nThe help file of the `geom_violin()` function describes violin plots as follows:\n\n> A violin plot is a compact display of a continuous distribution. It is a blend of [`geom_boxplot()`](http://127.0.0.1:19143/help/library/ggplot2/help/geom_boxplot) and [`geom_density()`](http://127.0.0.1:19143/help/library/ggplot2/help/geom_density): a violin plot is a mirrored density plot displayed in the same way as a boxplot.\n\n:::::: columns\n::: {.column width=\"49%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = Dabrowska.data,\n       mapping = aes(y = Colloc, \n                       x = Group)) +\n    geom_violin() +\n    labs(y = \"Scores on English collocation test\",\n         x = NULL) +\n    theme_bw()\n```\n:::\n\n:::\n\n::: {.column width=\"2%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"49%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-40-1.pdf)\n:::\n:::\n\n:::\n::::::\n\nBy themselves, **violin plots** are rather abstract representations of variable distributions. However, in combination with **boxplots**, they can be an effective way to visualise and compare data distributions. Note that, here, the order of the layers is important because, if we first draw the boxplots and then the violin plots, the violin plots will mask the boxplots completely.\n\n:::::: columns\n::: {.column width=\"49%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(y = Colloc, \n                       x = Group)) +\n    geom_violin(width = 1, \n                colour = \"grey\", \n                fill = \"grey\") +\n    geom_boxplot(width = 0.08, \n                 alpha = 0.2, \n                 outliers = FALSE) +\n    labs(y = \"Scores on English collocation test\",\n         x = NULL) +\n    theme_bw()\n```\n:::\n\n:::\n\n::: {.column width=\"2%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"49%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-42-1.pdf)\n:::\n:::\n\n:::\n::::::\n:::::::::::::::\n\n### Scatter plots {#sec-Scatterplots}\n\nScatter plots are ideal to examine the relationship between two numeric variables. They are best suited to continuous numeric variables.\n\nIn the following, we will build a scatter plot to explore the following hypothesis:\n\n-   In the data from @DabrowskaExperienceAptitudeIndividual2019, English grammar comprehension scores are more strongly associated with the level of formal education among L2 speakers than among L1 speakers.\n\nTo explore this hypothesis, we map the total number of years that participants spent in formal education (`EduTotal`) onto the *x*-axis and their `Grammar` scores onto the *y*-axis. In addition, we use the `facet_wrap()` function to split the data into two panels: one for the L1 participants and the other for the L2 group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = EduTotal, \n                     y = Grammar)) +\n  facet_wrap(~ Group) +\n  geom_point() +\n  labs(x = \"Number of years in formal education\",\n       y = \"Grammar comprehension test scores\",\n       title = \"Exploring hypothesis 1\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-43-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nAt first glance, it would seem that our data do not support our initial hypothesis: among the L2 participants, there is no obvious trend suggesting that those who scored lowest on the grammar test were the ones who spent fewer years in formal education.-\n\nIn @fig-GrammarScatterPlot, we add a regression line (in blue) per panel to our facetted scatter plot using the `geom_smooth(method = \"lm\")` function. This allows us to visualise the **correlation** between participants' grammar scores and the number of years they spent in formal education.\n\n\n::: {.cell source-line-numbers='6-7'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = EduTotal, \n                       y = Grammar)) +\n  facet_wrap(~ Group) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              se = FALSE) +\n  labs(x = \"Number of years in formal education\",\n       y = \"Grammar comprehension test scores\",\n       title = \"Exploring hypothesis 1\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GrammarScatterPlot-1.pdf){#fig-GrammarScatterPlot fig-pos='H'}\n:::\n:::\n\n\nRegression lines in scatter plots are interpreted as follows:\n\n-   If the regression line goes up, there is a **positive correlation** between the two numeric variables. ‚ÜóÔ∏è\n-   If the line goes down, there is a **negative correlation**. ‚ÜòÔ∏è\n-   The steeper the line, the stronger the correlation. üí™\n-   If the line is flat (or nearly flat), there is no (linear) correlation between the two variables. ‚û°Ô∏è\n-   Be aware that even very strong correlations do not necessarily imply (direct) causation. ‚ùå\n\nThe regression lines added by the `geom_smooth(method = \"lm\")` function are **lines of best fit**: the better the fit, the closer the points are to the line. If few points are on or close to the line, it means that the regression line is not a good approximation of the relationship between the two variables. This is clearly the case in @fig-GrammarScatterPlot - especially in the L2 panel (more on this in @sec-Correlations). Our data visualisation therefore do not support our hypothesis that, in the @DabrowskaExperienceAptitudeIndividual2019 data, grammar scores are more strongly associated with the level of formal education among the L2 speakers than among the L1 speakers. If anything, our data show the opposite pattern! Our line of fit is both closer to the data points and steeper in the L1 panel than in the L2 panel.\n\nSo far, all of our data visualisations have only displayed the characteristics of the collected data. In other words, they display **descriptive statistics** (see @sec-DescRiptiveStats) that do not allow us to make inferences about other participants who were not tested as part of @DabrowskaExperienceAptitudeIndividual2019's study. Tests of statistical significance, including of correlations, are introduced in @sec-Inferential.\n\n:::: {.content-visible when-format=\"html\"}\n::: {.callout-tip collapse=\"false\"}\n#### Your turn! {.unnumbered}\n\nIn this quiz, you will explore another hypothesis:\n\n> L2 speakers' grammar comprehension scores (`Grammar`) are positively correlated with their length of residence in the UK (`LoR`): L2 speakers who have lived in the UK for longer have a better understanding than those who arrived more recently.\n\nUsing {ggplot2}, create a **scatter plot** that allows you to explore this hypothesis.\n\n[**Q10.17**]{style=\"color:green;\"} What do you need to do before piping the data into the `ggplot()` function?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_17\" onsubmit=\"return validate_form_Q10_17()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_17\" id=\"answer_Q10_17_1\" value=\"select(Grammar, LoR, Group, L2)\"/>\nselect(Grammar, LoR, Group, L2)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_17\" id=\"answer_Q10_17_2\" value=\"filter(Group != &quot;L2&quot;)\"/>\nfilter(Group != \"L2\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_17\" id=\"answer_Q10_17_3\" value=\"filter(Group == &quot;L2&quot;)\"/>\nfilter(Group == \"L2\")\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_17\" id=\"answer_Q10_17_4\" value=\"select(LoR, L2)\"/>\nselect(LoR, L2)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_17\" id=\"answer_Q10_17_5\" value=\"select(Group, &quot;L2&quot;)\"/>\nselect(Group, \"L2\")\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_17\"></div>\n</form>\n<script>function validate_form_Q10_17() {var x, text; var x = document.forms['form_Q10_17']['answer_Q10_17'].value;if (x == 'filter(Group == \"L2\")'){text = '‚úÖ';} else {text = '‚ùå No, that‚Äôs not it.';} document.getElementById('result_Q10_17').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!'; res15 = document.getElementById('result_Q10_17').innerText == '‚úÖ';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_15623\" onclick=\"return show_hint_15623()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_15623\" onclick=\"return show_hint_15623()\"></div>\n<script>function show_hint_15623(){var x = document.getElementById('result_15623').innerHTML; if(!x){document.getElementById('result_15623').innerHTML = 'You‚Äôll find the answer in <a href=\"https://elenlefoll.github.io/RstatsTextbook/10_DataViz.htmlsec-ggplotData\">Section 10.*</a>.';} else {document.getElementById('result_15623').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.17.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(mapping = aes(x = LoR, \n                       y = Grammar)) +\n  geom_point() +\n  labs(x = \"Length of residence in the UK (years)\",\n       y = \"Grammar comprehension test scores\") +\n  theme_bw()\n```\n:::\n\n\n[**Q10.18**]{style=\"color:green;\"} On your scatter plot, which data points are clearly outliers?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_18\" onsubmit=\"return validate_form_Q10_18()\" method=\"post\">\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_18_1\" value=\"All the L2 speakers who have lived in the UK for 15 years or more.\"/>\nAll the L2 speakers who have lived in the UK for 15 years or more.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_18_2\" value=\"The three L2 speakers who scored 100 on the grammar test.\"/>\nThe three L2 speakers who scored 100 on the grammar test.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_18_3\" value=\"The L2 speaker who scored 0 on the grammar test.\"/>\nThe L2 speaker who scored 0 on the grammar test.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_18_4\" value=\"The 90 speakers with missing values.\"/>\nThe 90 speakers with missing values.\n</label>\n<br/>\n<label>\n<input type=\"checkbox\" id=\"answer_Q10_18_5\" value=\"The L2 speaker who has lived in the UK for more than 40 years.\"/>\nThe L2 speaker who has lived in the UK for more than 40 years.\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_18\"></div>\n</form>\n<script>function validate_form_Q10_18() {var text; var x1 = document.getElementById('answer_Q10_18_1'); var x2 = document.getElementById('answer_Q10_18_2'); var x3 = document.getElementById('answer_Q10_18_3'); var x4 = document.getElementById('answer_Q10_18_4'); var x5 = document.getElementById('answer_Q10_18_5'); if (x1.checked == false&x2.checked == false&x3.checked == false&x4.checked == false&x5.checked == true){text = '‚úÖ';} else {text = '‚ùå No, that‚Äôs not it.';} document.getElementById('result_Q10_18').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!'; res15 = document.getElementById('result_Q10_17').innerText == '‚úÖ'; res16 = document.getElementById('result_Q10_18').innerText == '‚úÖ';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_7876\" onclick=\"return show_hint_7876()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_7876\" onclick=\"return show_hint_7876()\"></div>\n<script>function show_hint_7876(){var x = document.getElementById('result_7876').innerHTML; if(!x){document.getElementById('result_7876').innerHTML = 'If you are getting a warning message telling you that ggplot2 has ‚Äúremoved 90 rows containing missing values or values outside the scale range‚Äù, you have not filtered the data to exclude L1 speakers before plotting the data. L1 speakers all have ‚ÄúNA‚Äù values for the variable LoR (corresponding to the length of residence in the UK).';} else {document.getElementById('result_7876').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\nIdentifying outliers is important to check and understand our data. If we spot an outlier corresponding to a participant having lived in a country for 400 years, we can immediately tell that something has gone wrong during data collection and/or pre-processing. In this case, however, common sense tells us that it is prefectly possible to have lived 40+ years in a country. Still, compared to the rest of the data, the outlier is striking and we should check that it is not due to an error.\n\n[**Q10.19**]{style=\"color:green;\"} Using data wrangling functions from the {tidyverse} (see @sec-DataWrangling), check whether the outlier participant is old enough to have lived in the UK for longer than 40 years. How old were they when they first came to the UK?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_19\" onsubmit=\"return validate_form_Q10_19()\" method=\"post\">\n<input type=\"text\" placeholder=\"\" name=\"answer_Q10_19\"/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_19\"></div>\n</form>\n<script>function validate_form_Q10_19() {var x, text; var x = document.forms['form_Q10_19']['answer_Q10_19'].value;if (x == '20'|x == 'twenty'){text = '‚úÖ Good job!';} else {text = '‚ùå That‚Äôs not it. Check the hint below, or the sample code if you‚Äôre stuck.';} document.getElementById('result_Q10_19').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16, res17;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!'; res15 = document.getElementById('result_Q10_17').innerText == '‚úÖ'; res16 = document.getElementById('result_Q10_18').innerText == '‚úÖ'; res17 = document.getElementById('result_Q10_19').innerText == '‚úÖ Good job!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16 + res17;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_88391\" onclick=\"return show_hint_88391()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_88391\" onclick=\"return show_hint_88391()\"></div>\n<script>function show_hint_88391(){var x = document.getElementById('result_88391').innerHTML; if(!x){document.getElementById('result_88391').innerHTML = 'To answer this question, you need to filter the data to only retain L2 participants who have lived in the UK for longer than 40 years. Then you can use the select() function to output only their age and length of residence.';} else {document.getElementById('result_88391').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.19.\"}\nDabrowska.data |> \n  filter(LoR > 40) |> \n  select(Age, LoR)\n\n62-42\n```\n:::\n\n\n[**Q10.20**]{style=\"color:green;\"} In order to better visualise a potential correlation between L2 participants' grammar comprehension test results and how long they've lived in the UK, we will exclude the outlier and re-draw the scatter plot. Which function can you use to exclude the identified outlier before piping the data into the `ggplot()` function?\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_20\" onsubmit=\"return validate_form_Q10_20()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_20\" id=\"answer_Q10_20_1\" value=\"filter(LoR ~ 40)\"/>\nfilter(LoR ~ 40)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_20\" id=\"answer_Q10_20_2\" value=\"filter(LoR != 40)\"/>\nfilter(LoR != 40)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_20\" id=\"answer_Q10_20_3\" value=\"filter(LoR &lt; 40)\"/>\nfilter(LoR &lt; 40)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_20\" id=\"answer_Q10_20_4\" value=\"filter(LoR &gt;= 40)\"/>\nfilter(LoR &gt;= 40)\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_20\" id=\"answer_Q10_20_5\" value=\"filter(LoR == &quot;&lt; 40&quot;)\"/>\nfilter(LoR == \"&lt; 40\")\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_20\"></div>\n</form>\n<script>function validate_form_Q10_20() {var x, text; var x = document.forms['form_Q10_20']['answer_Q10_20'].value;if (x == 'filter(LoR < 40)'){text = '‚úÖ That‚Äôs right, well done!';} else {text = '‚ùå No, that‚Äôs not the one. Try them out and see how they change your scatterplot.';} document.getElementById('result_Q10_20').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16, res17, res18;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!'; res15 = document.getElementById('result_Q10_17').innerText == '‚úÖ'; res16 = document.getElementById('result_Q10_18').innerText == '‚úÖ'; res17 = document.getElementById('result_Q10_19').innerText == '‚úÖ Good job!'; res18 = document.getElementById('result_Q10_20').innerText == '‚úÖ That‚Äôs right, well done!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16 + res17 + res18;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_72145\" onclick=\"return show_hint_72145()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_72145\" onclick=\"return show_hint_72145()\"></div>\n<script>function show_hint_72145(){var x = document.getElementById('result_72145').innerHTML; if(!x){document.getElementById('result_72145').innerHTML = 'To answer this question, it‚Äôs worth revising relational operators (see <a href=\"https://elenlefoll.github.io/RstatsTextbook/5_GettingStaRted.htmlsec-RelationalOperators\">Section 5.5</a>).';} else {document.getElementById('result_72145').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.20.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  filter(LoR < 40) |> \n  ggplot(mapping = aes(x = LoR, \n                       y = Grammar)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              se = FALSE) +\n  labs(x = \"Length of residence in the UK (years)\",\n       y = \"Grammar comprehension test scores\") +\n  theme_bw()\n```\n:::\n\n\n[**Q10.21**]{style=\"color:green;\"} Having removed the outlier point from the scatter plot, now add a regression line to visualise the correlation between the two variables. Which of the following options best fits the gap in the sentence below?\n\n> In this group of L2 speakers, there is \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_ correlation between participants' grammar test scores and their length of residence in the UK.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<form name=\"form_Q10_21\" onsubmit=\"return validate_form_Q10_21()\" method=\"post\">\n<label>\n<input type=\"radio\" name=\"answer_Q10_21\" id=\"answer_Q10_21_1\" value=\"a negative\"/>\na negative\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_21\" id=\"answer_Q10_21_2\" value=\"a perfect\"/>\na perfect\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_21\" id=\"answer_Q10_21_3\" value=\"a positive\"/>\na positive\n</label>\n<br/>\n<label>\n<input type=\"radio\" name=\"answer_Q10_21\" id=\"answer_Q10_21_4\" value=\"no\"/>\nno\n</label>\n<br/>\n<input type=\"submit\" value=\"Check answer\"/>\n<div id=\"result_Q10_21\"></div>\n</form>\n<script>function validate_form_Q10_21() {var x, text; var x = document.forms['form_Q10_21']['answer_Q10_21'].value;if (x == 'a positive'){text = '‚úÖ';} else {text = '‚ùå';} document.getElementById('result_Q10_21').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){\n         element = document.getElementById('checkdown_final_score');\n         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16, res17, res18, res19;res1 = document.getElementById('result_Q10_3').innerText == 'Correct! Bar charts are better suited than pie charts because humans are much better at estimating lengths than angles (see Section 10.1.10), and the labels are immediately next to the corresponding bars here.'; res2 = document.getElementById('result_Q10_4').innerText == 'That‚Äôs right! Your bar plot should make that immediately obvious.'; res3 = document.getElementById('result_Q10_5').innerText == 'That‚Äôs right: the legend is redundant and does not make the plot easier to interpret. We can remove the legend by adding a theme layer that changes the position of the legend to ‚Äúnone‚Äù. Click on the link below to find out more.'; res4 = document.getElementById('result_Q10_6').innerText == 'Yes, well done!'; res5 = document.getElementById('result_Q10_7').innerText == 'Absolutely!'; res6 = document.getElementById('result_Q10_8').innerText == 'That‚Äôs right, well done!'; res7 = document.getElementById('result_Q10_9').innerText == 'That‚Äôs right, well done!'; res8 = document.getElementById('result_Q10_10').innerText == 'Exactly!'; res9 = document.getElementById('result_Q10_11').innerText == 'That‚Äôs right!'; res10 = document.getElementById('result_Q10_12').innerText == 'That‚Äôs right!'; res11 = document.getElementById('result_Q10_13').innerText == 'You‚Äôre right! Note that facet_wrap(‚ÄúGroup‚Äù) also works and produces the same output.'; res12 = document.getElementById('result_Q10_14').innerText == 'That‚Äôs right. Even though the distribution of Blocks scores is not perfectly symmetrical, it is less skewed than that of the other three variables.'; res13 = document.getElementById('result_Q10_15').innerText == 'Correct!'; res14 = document.getElementById('result_Q10_16').innerText == 'That‚Äôs right! Well done, that wasn‚Äôt easy!'; res15 = document.getElementById('result_Q10_17').innerText == '‚úÖ'; res16 = document.getElementById('result_Q10_18').innerText == '‚úÖ'; res17 = document.getElementById('result_Q10_19').innerText == '‚úÖ Good job!'; res18 = document.getElementById('result_Q10_20').innerText == '‚úÖ That‚Äôs right, well done!'; res19 = document.getElementById('result_Q10_21').innerText == '‚úÖ';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16 + res17 + res18 + res19;element.innerHTML = text;\n         return false;\n         }}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hint_99863\" onclick=\"return show_hint_99863()\">üê≠ Click on the mouse for a hint.</div>\n<div id=\"result_99863\" onclick=\"return show_hint_99863()\"></div>\n<script>function show_hint_99863(){var x = document.getElementById('result_99863').innerHTML; if(!x){document.getElementById('result_99863').innerHTML = 'To answer this question, you should ask yourself: Does the regression line draw an upward or a downward slope? How steep is the slope? And how close are the points to the line?).';} else {document.getElementById('result_99863').innerHTML = '';}}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show sample code to answer Q10.21.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  filter(LoR < 40) |> \n  ggplot(mapping = aes(x = LoR, \n                       y = Grammar)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              se = FALSE) +\n  labs(x = \"Length of residence in the UK\",\n       y = \"Grammar comprehension test scores\") +\n  theme_bw()\n```\n:::\n\n:::\n::::\n\n### Word clouds\n\nThe {ggplot2} library does not include an in-built function to create word clouds. However, members of the `R` community are continuously creating and sharing new functions and packages to improve and extend data visualisation options in `R`. One such community member, Erwan Le Pennec, created the [{ggwordcloud}](https://lepennec.github.io/ggwordcloud/) package, which adds the `geom_text_wordcloud()` function to the {ggplot2} environment.\n\n:::: {.content-visible when-format=\"html\"}\n::: column-margin\n![Hex sticker of the [{ggwordcloud}](https://lepennec.github.io/ggwordcloud/) package](images/hex_ggwordcloud.png){width=\"100\" fig-alt=\"The hexagonal logo of the ggwordcloud package which features a cartoonish white cloud on a sky-blue blackground.\"}\n:::\n::::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"ggwordcloud\")\nlibrary(ggwordcloud)\n```\n:::\n\n\nWe will use the `geom_text_wordcloud()` function to create a word cloud representing L2 participants' native languages. To this end, we first need to create a table that tallies how often each native language was mentioned. We also include a column for the language family (see [**Task 9.3**]{style=\"color:green;\"} in @sec-casewhen).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNativeLg_freq <- Dabrowska.data |> \n  filter(Group == \"L2\") |> \n  count(NativeLg, NativeLgFamily)\n\nNativeLg_freq\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     NativeLg NativeLgFamily  n\n1   Cantonese        Chinese  4\n2     Chinese        Chinese  3\n3      French        Romance  2\n4      German       Germanic  1\n5       Greek       Hellenic  1\n6     Italian        Romance  1\n7  Lithuanian         Baltic  5\n8    Mandarin        Chinese  8\n9      Polish         Slavic 37\n10    Russian         Slavic  2\n11    Spanish        Romance  3\n```\n\n\n:::\n:::\n\n\nNext, we enter this new dataset, `NativeLg_freq`, in a `ggplot()` function and map each native language to a text `label` **aesthetics**, the number of participants to have this native language to the `size` of the words, and each native language family to a `colour`.\n\n\n::: {.cell}\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = NativeLg_freq,\n       aes(label = NativeLg,\n           size = n,\n           colour = NativeLgFamily)) +\n  geom_text_wordcloud() +\n  scale_size_area(max_size = 30) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/unnamed-chunk-51-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nWord clouds are widely used in the media and corporate world, but they are much rarer in academic research. Although word clouds can help to visualise the most prominent words in a set of words, they mostly serve decorative purposes. Data visualisation experts warn against them for two main reasons:\n\n-   Longer words appear larger simply due to their length.\n-   The human eye is not good at discerning small differences in font sizes.\n\n::::: {.callout-note collapse=\"false\"}\n#### Going further: Using `geom_text()`\n\nWe have seen that, on a scatter plot, each point represents an observation, in our case, a participant. For instance, in @fig-ColourScatterPlot, each point represents an L2 participant and displays their age and grammar comprehension test score. In addition, we can colour the points according to their native language family.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See `R` code.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(aes(x = Age, \n           y = Grammar,\n           colour = NativeLgFamily)) +\n  geom_point() +\n  labs(x = \"Age\", \n       y = \"Grammar comprehension test score\", \n       color = \"Language family\") +\n  theme_bw(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-ColourScatterPlot-1.pdf){#fig-ColourScatterPlot fig-pos='H'}\n:::\n:::\n\n\nInstead of plotting points on the scatter plot, we can plot text. Thus, instead of using `geom_point()`, we can use `geom_text()`. For example, we can display the native language of each participant by mapping `NativeLg` to the `label` aesthetics.\n\n\n::: {.cell source-line-numbers='6-7'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See `R` code.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  ggplot(aes(x = Age, \n           y = Grammar,\n           colour = NativeLgFamily,\n           label = NativeLg)) +\n  geom_text() +\n  scale_x_continuous(limits = c(15,65)) +\n  labs(x = \"Age\", \n       y = \"Grammar comprehension test score\", \n       color = \"Language family\") +\n  theme_bw(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-TextScatterPlot-1.pdf){#fig-TextScatterPlot fig-pos='H'}\n:::\n:::\n\n\nClearly, there are too many L2 participants for @fig-TextScatterPlot to be legible. For now, we will therefore focus on female L2 participants only. Moreover, we can see that there is dense cluster of L2 participants who are young and scored very high on the grammar comprehension test. In this exploratory analysis, we will therefore focus on female participants who obtained fewer than 90 points on the test.\n\n\n::: {.cell source-line-numbers='3,13'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See `R` code.\"}\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  filter(Grammar < 90 & Gender == \"F\") |> \nggplot(aes(x = Age, \n           y = Grammar,\n           colour = NativeLgFamily,\n           label = NativeLg)) +\n  geom_text() +\n  scale_x_continuous(limits = c(15,55)) +\n  labs(x = \"Age\", \n       y = \"Grammar comprehension test score\", \n       color = \"Language family\",\n       caption = \"(Subgroup analysis of female L2 participants with grammar scores below 90.)\") +\n  theme_bw(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-TextScatterPlot2-1.pdf){#fig-TextScatterPlot2 fig-pos='H'}\n:::\n:::\n\n\nNote that we had to expand the limits of the *x*-axis in order for labels of the youngest and oldest participants to be displayed in full on @fig-TextScatterPlot2. Still, there are a few labels that overlap nonetheless. If this bothers you, you'll be pleased to hear that there is a handy {ggplot2} extension called {[ggrepel](https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html)}, which was designed to avoid text labels overlapping.\n\n:::: {.content-visible when-format=\"html\"}\n::: column-margin\n![Hex sticker of the {[ggrepel](https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html)} package featuring a red pin attaching a label](images/hex_ggrepel.svg){width=\"95\"}\n:::\n::::\n\n\n::: {.cell source-line-numbers='2,11'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"See `R` code.\"}\n#install.packages(\"ggrepel\")\nlibrary(ggrepel)\n\nDabrowska.data |> \n  filter(Group == \"L2\") |> \n  filter(Grammar < 90 & Gender == \"F\") |> \nggplot(aes(x = Age, \n           y = Grammar,\n           colour = NativeLgFamily,\n           label = NativeLg)) +\n  geom_text_repel() +\n  scale_x_continuous(limits = c(15,55)) +\n  labs(x = \"Age\", \n       y = \"Grammar comprehension test score\", \n       color = \"Language family\",\n       caption = \"(Subgroup analysis of female L2 participants with grammar scores below 90.)\") +\n  theme_bw(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-TextScatterPlot3-1.pdf){#fig-TextScatterPlot3 fig-pos='H'}\n:::\n:::\n\n:::::\n\n### Complex plots {#sec-CombiningGeoms}\n\nPart of the magic of the Grammar of Graphics is that we can easily **combine** **different geometries** and **aesthetics** to create highly informative graphs. If you just read about the `geom_text()` function (see @fig-TextScatterPlot3), then you have already seen how this can work.\n\n@Fig-GrammarPointBoxplot is another example. In this plot, we combine `geom_boxplot()` with `geom_point()` to see both the defining characteristics of the distributions of grammar test scores among L1 and L2 participants, as well as the exact score of each individual participant.\n\nBy default, the `geom_boxplot()` function plots dots for any outliers. Since we are now also plotting *all* the data points using the `geom_point()` function, we need to switch off this option, otherwise the outliers will be plotted twice.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = Group)) +\n  geom_boxplot(outliers = FALSE) +\n  geom_point(alpha = 0.6,\n             size = 2) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-GrammarPointBoxplot-1.pdf){#fig-GrammarPointBoxplot fig-pos='H' width=50%}\n:::\n:::\n\n\nWhen there are too many points overlapping, even adding some transparency to the points with the `alpha` option may not suffice to tell the points apart. An alternative is to add a little bit of randomness to the position of the dots using the `geom_jitter()` function to ensure that there are fewer overlaps.\n\n\n::: {.cell source-line-numbers='5-7'}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = Group)) +\n  geom_boxplot(outliers = FALSE) +\n  geom_jitter(alpha = 0.6,\n              size = 2,\n              width = 0.1) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-JitteredGrammar-1.pdf){#fig-JitteredGrammar fig-pos='H' width=50%}\n:::\n:::\n\n\nWe can also map the colour of the jittered points to another categorical variable from our dataset, e.g. `Gender`.\n\n\n::: {.cell source-line-numbers='4'}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = Group, \n                       colour = Gender)) +\n  geom_boxplot(outliers = FALSE,\n               colour = \"black\") +\n  geom_jitter(alpha = 0.6,\n              size = 2,\n              width = 0.1) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-JitteredGrammarGender-1.pdf){#fig-JitteredGrammarGender fig-pos='H' width=60%}\n:::\n:::\n\n\n@fig-JitteredGrammarGender allows us to see that the lowest grammar comprehension test scores among L1 participants come from male participants, whereas the lowest scores in the L2 group come from female participants. Can you think of why this might be? ü§î Make a note of your hypothesis as you will have a chance to explore it further in @sec-InteractivePlots.\n\nWe can, in theory, visualise even more of our data by adding a **shape** `aesthetics` to the `geom_jitter()` (see @fig-JitteredGrammarGender). However, increased plot complexity does not necessarily result in more meaningful or effective statistical graphics. How effective is @fig-JitteredGrammarComplex in your opinion?\n\n\n::: {.cell source-line-numbers='7'}\n\n```{.r .cell-code}\nDabrowska.data |>\n  ggplot(mapping = aes(y = Grammar, \n                       x = Group, \n                       colour = OccupGroup)) +\n  geom_boxplot(colour = \"black\",\n               outliers = FALSE) +\n  geom_jitter(mapping = aes(shape = Gender),\n              size = 3,\n              alpha = 0.7, \n              width = 0.1) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\",\n       colour = \"Occupational\\ngroup\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](10_Dataviz_files/figure-pdf/fig-JitteredGrammarComplex-1.pdf){#fig-JitteredGrammarComplex fig-pos='H' width=70%}\n:::\n:::\n\n\nAs the saying goes, less is often more. In other words, simpler plots are often more effective than complex ones. With {ggplot2} and its many extensions, the possibilities are almost endless, but that doesn't mean that simple bar charts, histograms, and scatter plots should be abandoned! When designing effective data visualisation to communicate your research, think carefully about your **audience** and the **message** that you want to convey.\n\n### Interactive plots {#sec-InteractivePlots}\n\nIn @sec-CombiningGeoms, we saw that we can combine **geometries** and **aesthetics**, but that there are some limits as to what is meaningful and effective. In particular, it is difficult to visualise categorical variables with many different levels on a static graph.\n\nThe good news is that now that you know how to create a plot using {ggplot2}, you are 10 seconds away from making it interactive! Interactive plots are particularly useful for **data sanity checks** and **data exploration**.\n\n:::: {.content-visible when-format=\"html\"}\n::: column-margin\n![Hex sticker of the [{plotly}](https://plotly-r.com) package](images/hex_plotly.png){width=\"100\"}\n:::\n::::\n\nThe [{plotly}](https://plotly-r.com) package provides access to a popular javascript visualisation toolkit within `R`. You will first need to install the package and load it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"plotly\")\nlibrary(plotly)\n```\n:::\n\n\nThen, all you need to do is create and save a `ggplot` object, and call that object with the `ggplotly()` function. In RStudio, your interactive plot will be displayed in the Viewer pane. Hover your mouse over the data points of @fig-InteractivePlot to explore the data interactively. You will see that, in addition to the variables mapped onto the plot itself, the variable mapped onto the `label` aesthetics (`OccupGroup`) also appears when you hover the mouse over any single data point.\n\n\n::: {.cell source-line-numbers='1,15'}\n\n```{.r .cell-code}\nmyplot <- Dabrowska.data |> \n  ggplot(mapping = aes(y = Grammar, \n                       x = Group, \n                       colour = Gender,\n                       label = Occupation)) +\n  geom_jitter(alpha = 0.8, \n              width = 0.1) +\n  geom_boxplot(alpha = 0, \n               colour = \"black\",\n               outliers = FALSE) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\") +\n  theme_bw()\n\nggplotly(myplot)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n::: {.content-visible when-format=\"pdf\"}\n![](images/IntPlotCh10a.png){#fig-InteractivePlot}\n:::\n\nIf you want to display more than one additional variable on hover, you can do using the `text` mapping. Here you can customise which variables are displayed and how. As the interactive plot is coded in HTML, you need to use the \"</br>\" tag to add a new line.\n\n\n::: {.cell source-line-numbers='5-7,17'}\n\n```{.r .cell-code}\nmyplot2 <- Dabrowska.data |> \n  ggplot(mapping = aes(y = Grammar, \n                       x = Group, \n                       colour = Gender,\n                       text = paste(\"Age:\", Age, \"</br>Years in formal education:\", EduTotal, \"</br>Job:\", Occupation))) +\n  geom_jitter(alpha = 0.8, \n              width = 0.1) +\n  geom_boxplot(alpha = 0, \n               colour = \"black\",\n               outliers = FALSE) +\n  labs(x = NULL,\n       y = \"Grammar comprehension test score\") +\n  theme_bw()\n\nggplotly(myplot2)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n::: {.content-visible when-format=\"pdf\"}\n![](images/IntPlotCh10b.png)\n:::\n\n## Exporting plots üöÄ {#sec-ExploringPlots}\n\nYou may want to share the plots that you have created in `R` with others or insert them in a research paper or presentation. {ggplot2} provides a convenient way to export plots in various formats using the `ggsave()` function. You can specify the file name, format, and other options such as the width, height, and resolution of the image.\n\nIf you run the `ggsave()` function without specifying which plot should be saved, it will save the last plot that was displayed. The image file type is determined by the extension of the file name that you provide, e.g. a file name ending in `.png` will export your graph to a PNG file. You can specify its dimensions in centimetres (`cm`), millimetres (`mm`), inches (`in`), and pixel (`px`). Working out appropriate dimensions can be tricky and typically requires a bit of experimenting until you get it right.\n\n\n::: {.cell source-line-numbers='11-14'}\n\n```{.r .cell-code}\nDabrowska.data |> \n  ggplot(mapping = aes(x = Blocks,\n                       fill = Group)) +\n  geom_density(alpha = 0.7) +\n  scale_fill_viridis_d() +\n  scale_x_continuous(expand = c(0,0),\n                     limits = c(0,30)) +\n  labs(x = \"Non-verbal IQ (Blocks test)\") +\n  theme_minimal()\n\nggsave(\"BlocksDensityPlot.png\",\n       width = 10,\n       height = 8,\n       units = \"cm\")\n```\n:::\n\n\nBy default, plots will be exported to the project's working directory. You can save it elsewhere by specifying a different file path (see @sec-FoldersPaths). For example, this function will save the last plot displayed as an SVG file in the project's subfolder \"figures\". Note that, if the subfolder to which you want to save your graph does not yet exist, `R` will return an error. So make sure that the subfolder exists at the path that you specified before attempting to save anything in it!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"figures/BlocksDensityPlot.svg\",\n       width = 1500,\n       height = 1000,\n       units = \"px\")\n```\n:::\n\n\n### Check your progress üåü {.unnumbered}\n\nWell done! You have successfully completed this chapter on data visualisation using the Grammar of Graphics approach. You have answered [`<span id=\"checkdown_final_score\">0</span>`{=html} out of 21 questions]{style=\"color:green;\"} correctly.\n\nAre you confident that you can...?\n\n-   [ ] Use the syntax of the Grammar of Graphics to build and customise your graphs layer-by-layer (using data, aesthetics, geometries, facetting, scales, coordinates, and theme layers) (@sec-Syntax)\n-   [ ] Create and interpret bar plots, histograms, density plots, boxplots, scatter plots, and word clouds (@sec-Semantics)\n-   [ ] Create and interpret complex plots and interactive plots for data exploration (@sec-CombiningGeoms) and (@sec-InteractivePlots)\n-   [ ] Export and share your plots in various formats (@sec-ExploringPlots)\n\nIf so, you are ready to move out on inferential statistics in @sec-Inferential!\n\n::: callout-note\n### Charting your way to success üó∫Ô∏è {.unnumbered collapse=\"TRUE\"}\n\nIf you have completed this chapter, you can now produce some of the most widely used plots in the language sciences: Congratulations!\n\nBar plots, boxplots, scatter plots, density plots and histograms may well be all that you need for now. But you should know that the possibilities with `R`, the {ggplot2} library, and its many extensions are pretty much limitless: The [`R` Graph Gallery](https://r-graph-gallery.com/) lists some 50 different types of charts with over 400 examples with code!\n\nAnother great resource is [The R Graphics Cookbook](https://r-graphics.org) by Winston Chang. To go beyond the basics and to find out more information about the theoretical underpinnings of the {ggplot2} package, I recommend [ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book.org).\n\nThere are also great `R` packages to produce more specialised types of graphs frequently used in linguistics such as [vowel charts](https://joeystanley.com/blog/making-vowel-plots-in-r-part-1/) and [dialectal maps](https://doi.org/10.1017/jlg.2024.11) (see list of [next-step resources](https://elenlefoll.github.io/RstatsTextbook/A_FurtherResources.html)).\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}