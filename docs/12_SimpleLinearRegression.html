<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elen Le Foll">

<title>12&nbsp; IntRoduction to statistical modelling – Data Analysis for the Language Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13_MultipleLinearRegression.html" rel="next">
<link href="./11_Inferential.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-53f539a478d6ecd1be31ce9fd30fd81c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-3e3370d44295d9fa30cc16d77ad785c2.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-53f539a478d6ecd1be31ce9fd30fd81c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-db8da973c8974479654007bb7dceba98.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-540c66f2be59a33d43b8e94dc657d4ab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-db8da973c8974479654007bb7dceba98.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
.cell-output-stdout code {
  word-break: break-wor !important;
  white-space: pre-wrap !important;
}
</style>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    window.setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      window.setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    window.hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(darkModeDefault) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const darkModeDefault = false;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !window.hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (window.hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12_SimpleLinearRegression.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Int<code>R</code>oduction to statistical modelling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis for the<br>Language Sciences</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="mailto:elefoll@uni-koeln.de" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://github.com/elenlefoll/RstatsTextbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_OpenScholarship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Open Scholarship</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data files and formats</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_DataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data management</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_InstallingR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Installing <code>R</code> and RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_GettingStaRted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting sta<code>R</code>ted in <code>R</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_ImpoRtingData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Impo<code>R</code>ting data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_VariablesFunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Va<code>R</code>iables and functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_DescriptiveStats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Desc<code>R</code>iptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_DataWrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data w<code>R</code>angling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Gramma<code>R</code> of Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Inferential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Infe<code>R</code>ential statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_SimpleLinearRegression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Int<code>R</code>oduction to statistical modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_MultipleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple linear reg<code>R</code>ession modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_LiterateProgramming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rep<code>R</code>oducible research and academic w<code>R</code>iting in Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_PartingWords.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Resea<code>R</code>ching with AI?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A_FurtherResources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Next-step resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Case studies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Poppy/ThrowVerbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">‘Throw’ verbs in Spanish: Rep<code>R</code>oducing the results of a corpus linguistics study</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Rose-Gina/Emojis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The semantics of emojis: Explo<code>R</code>ing the results of an experimental study</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Dela/Perdon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">The g<code>R</code>ammaticalization of ‘perdón’ in Spanish varieties</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#from-tests-to-models" id="toc-from-tests-to-models" class="nav-link active" data-scroll-target="#from-tests-to-models">From tests to models</a></li>
  <li><a href="#sec-Correlationsregression" id="toc-sec-Correlationsregression" class="nav-link" data-scroll-target="#sec-Correlationsregression"><span class="header-section-number">12.1</span> Correlations as regression over a numeric variable</a>
  <ul class="collapse">
  <li><a href="#a-perfect-prediction" id="toc-a-perfect-prediction" class="nav-link" data-scroll-target="#a-perfect-prediction"><span class="header-section-number">12.1.1</span> A perfect prediction</a></li>
  <li><a href="#a-real-life-prediction" id="toc-a-real-life-prediction" class="nav-link" data-scroll-target="#a-real-life-prediction"><span class="header-section-number">12.1.2</span> A real-life prediction</a></li>
  <li><a href="#predicted-values-and-residuals" id="toc-predicted-values-and-residuals" class="nav-link" data-scroll-target="#predicted-values-and-residuals"><span class="header-section-number">12.1.3</span> Predicted values and residuals</a></li>
  </ul></li>
  <li><a href="#sec-Ttestsregression" id="toc-sec-Ttestsregression" class="nav-link" data-scroll-target="#sec-Ttestsregression"><span class="header-section-number">12.2</span> <em>t</em>-tests as regression over a binary variable</a></li>
  <li><a href="#sec-Categoricalpredictor" id="toc-sec-Categoricalpredictor" class="nav-link" data-scroll-target="#sec-Categoricalpredictor"><span class="header-section-number">12.3</span> Regressing over a categorical predictor with more than two levels</a></li>
  <li><a href="#sec-AssumptionsLR" id="toc-sec-AssumptionsLR" class="nav-link" data-scroll-target="#sec-AssumptionsLR"><span class="header-section-number">12.4</span> Regression assumptions</a>
  <ul class="collapse">
  <li><a href="#sec-IndependenceSLR" id="toc-sec-IndependenceSLR" class="nav-link" data-scroll-target="#sec-IndependenceSLR"><span class="header-section-number">12.4.1</span> Assumption 1: Independence</a></li>
  <li><a href="#sec-LinearitySLR" id="toc-sec-LinearitySLR" class="nav-link" data-scroll-target="#sec-LinearitySLR"><span class="header-section-number">12.4.2</span> Assumption 2: Linearity</a></li>
  <li><a href="#sec-Residuals" id="toc-sec-Residuals" class="nav-link" data-scroll-target="#sec-Residuals"><span class="header-section-number">12.4.3</span> Assumption 3: Homogeneity of residuals</a></li>
  <li><a href="#sec-NormalityResiduals" id="toc-sec-NormalityResiduals" class="nav-link" data-scroll-target="#sec-NormalityResiduals"><span class="header-section-number">12.4.4</span> Assumption 4: Normality of residuals</a></li>
  </ul></li>
  <li><a href="#intermediary-summary" id="toc-intermediary-summary" class="nav-link" data-scroll-target="#intermediary-summary"><span class="header-section-number">12.5</span> Intermediary summary</a>
  <ul class="collapse">
  <li><a href="#check-your-progress" id="toc-check-your-progress" class="nav-link" data-scroll-target="#check-your-progress">Check your progress 🌟</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-SLR" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Int<code>R</code>oduction to statistical modelling</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>As with the rest of this textbook (see <a href="https://elenlefoll.github.io/RstatsTextbook/">Preface</a>), this chapter is very much <strong>work in progress</strong>. All feedback is very welcome.</p>
</div>
</div>
<section id="from-tests-to-models" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="from-tests-to-models">From tests to models</h3>
<p>This chapter will take you from statistical tests to statistical modelling. By the end of this chapter, you will be able to:</p>
<ul>
<li>Use the <code>lm()</code> function to fit linear regression models with:
<ul>
<li>a single numeric predictor variable</li>
<li>a single (binary) categorical predictor variable</li>
</ul></li>
<li>Understand the relationship between:
<ul>
<li>correlation tests and linear regression models with a single numeric predictor</li>
<li><em>t</em>-tests and linear regression models with a single binary categorical predictor</li>
</ul></li>
<li>Interpret the summary output of simple linear regression models</li>
<li>Explain what the intercept of a simple linear regression model corresponds to</li>
<li>Visualise the predictions of simple linear regression models</li>
<li>Explain why “association does not imply causation”</li>
<li>Check the most important assumptions of linear regression models.</li>
</ul>
</section>
<section id="sec-Correlationsregression" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sec-Correlationsregression"><span class="header-section-number">12.1</span> Correlations as regression over a numeric variable</h2>
<p>This section explains how the principle of correlation, which we covered in <a href="11_Inferential.html#sec-Correlations" class="quarto-xref"><span>Section 11.5</span></a>, is integral to linear regression modelling. We begin with a ‘toy’ example to familiarise ourselves with the concept of statistical modelling. It is important to take the time to genuinely understand how simple linear regression works before moving on to more complex, real-world research questions.</p>
<section id="a-perfect-prediction" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="a-perfect-prediction"><span class="header-section-number">12.1.1</span> A perfect prediction</h3>
<p>In the following, we will fit a simple linear regression model to predict the percentage of correct answers that a student obtained in a multiple-choice test based on the number of questions that they correctly answered in this same test. Clearly, this is a purely hypothetical example because, if we know the number of questions that a student correctly answered and how many questions there were in the test, we can easily calculate the percentage of questions that the student answered correctly.</p>
<p>If a test has 10 questions and a student answered 8 of them correctly, we can calculate the percentage of questions that they successfully answered like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="sc">/</span> <span class="dv">10</span> <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 80</code></pre>
</div>
</div>
<p>And we can simplify this operation to a single multiplication:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 80</code></pre>
</div>
</div>
<p>We will fit our first simple linear regression model on a simulated dataset. It consists of 100 test results expressed:</p>
<ol type="a">
<li>as the number of correctly answered questions (<code>N.correct</code>), and</li>
<li>as a percentage (<code>Accuracy</code>).</li>
</ol>
<p>The dataset contains 100 rows corresponding to the results of 100 test-takers. <a href="#tbl-RTTable" class="quarto-xref">Table&nbsp;<span>12.1</span></a> displays the first six rows of this simulated dataset (<code>test.results</code>).</p>
<div id="tbl-RTTable" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-RTTable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12.1
</figcaption>
<div aria-describedby="tbl-RTTable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<details class="code-fold">
<summary>Show code to simulate the dataset.</summary>
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers=""><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we set a seed to ensure that the outcome of our randomly generated number series are always exactly the same:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, we simulate the number of questions that 100 learners answered correctly using the `sample()` function that generates random numbers, specifying that learners got between 1 and 10 questions right:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>N.correct <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># Third, we convert the number of correctly answered questions into the percentage of questions that these learners answered correctly:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Accuracy <span class="ot">&lt;-</span> N.correct <span class="sc">/</span> <span class="dv">10</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we put these two variables together in a dataframe:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>test.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(N.correct, Accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</figure>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ukyzphwfam" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ukyzphwfam table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ukyzphwfam thead, #ukyzphwfam tbody, #ukyzphwfam tfoot, #ukyzphwfam tr, #ukyzphwfam td, #ukyzphwfam th {
  border-style: none;
}

#ukyzphwfam p {
  margin: 0;
  padding: 0;
}

#ukyzphwfam .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ukyzphwfam .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ukyzphwfam .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ukyzphwfam .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ukyzphwfam .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ukyzphwfam .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukyzphwfam .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ukyzphwfam .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ukyzphwfam .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ukyzphwfam .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ukyzphwfam .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ukyzphwfam .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ukyzphwfam .gt_spanner_row {
  border-bottom-style: hidden;
}

#ukyzphwfam .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ukyzphwfam .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ukyzphwfam .gt_from_md > :first-child {
  margin-top: 0;
}

#ukyzphwfam .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ukyzphwfam .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ukyzphwfam .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ukyzphwfam .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ukyzphwfam .gt_row_group_first td {
  border-top-width: 2px;
}

#ukyzphwfam .gt_row_group_first th {
  border-top-width: 2px;
}

#ukyzphwfam .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukyzphwfam .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ukyzphwfam .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ukyzphwfam .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukyzphwfam .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukyzphwfam .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ukyzphwfam .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ukyzphwfam .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ukyzphwfam .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukyzphwfam .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ukyzphwfam .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukyzphwfam .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ukyzphwfam .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukyzphwfam .gt_left {
  text-align: left;
}

#ukyzphwfam .gt_center {
  text-align: center;
}

#ukyzphwfam .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ukyzphwfam .gt_font_normal {
  font-weight: normal;
}

#ukyzphwfam .gt_font_bold {
  font-weight: bold;
}

#ukyzphwfam .gt_font_italic {
  font-style: italic;
}

#ukyzphwfam .gt_super {
  font-size: 65%;
}

#ukyzphwfam .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ukyzphwfam .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ukyzphwfam .gt_indent_1 {
  text-indent: 5px;
}

#ukyzphwfam .gt_indent_2 {
  text-indent: 10px;
}

#ukyzphwfam .gt_indent_3 {
  text-indent: 15px;
}

#ukyzphwfam .gt_indent_4 {
  text-indent: 20px;
}

#ukyzphwfam .gt_indent_5 {
  text-indent: 25px;
}

#ukyzphwfam .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ukyzphwfam div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="N.correct" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N.correct</th>
<th id="Accuracy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Accuracy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="N.correct">1</td>
<td class="gt_row gt_right" headers="Accuracy">10</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="N.correct">5</td>
<td class="gt_row gt_right" headers="Accuracy">50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="N.correct">1</td>
<td class="gt_row gt_right" headers="Accuracy">10</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="N.correct">9</td>
<td class="gt_row gt_right" headers="Accuracy">90</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="N.correct">10</td>
<td class="gt_row gt_right" headers="Accuracy">100</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="N.correct">4</td>
<td class="gt_row gt_right" headers="Accuracy">40</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can now plot the two variables of our simulated dataset as a scatter plot to visualise the correlation between the number of questions learners answered correctly (<code>N.correct</code>) and the percentage of questions they answered accurately (<code>Accuracy</code>). As expected, these two variables are perfectly correlated: every data point sits exactly on the regression line.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code to generate the scatter plot.</summary>
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test.results,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> N.correct, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of correct answers"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% of questions correctly answered"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">10.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">105</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-RTScatterPLot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot of learners' test results expressed as the number of correct answers they got on the x-axis and as the percentage of correctly answered questions on the y-axis. The data points form a perfect linear relationship. A straight blue regression line runs through all the data points.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-RTScatterPLot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-RTScatterPLot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;12.1: The correlation between learners’ test results expressed as the number of correct answers and the percentage of questions answered correctly"><img src="12_SimpleLinearRegression_files/figure-html/fig-RTScatterPLot-1.png" class="img-fluid figure-img" alt="Scatter plot of learners' test results expressed as the number of correct answers they got on the x-axis and as the percentage of correctly answered questions on the y-axis. The data points form a perfect linear relationship. A straight blue regression line runs through all the data points." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-RTScatterPLot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: The correlation between learners’ test results expressed as the number of correct answers and the percentage of questions answered correctly
</figcaption>
</figure>
</div>
</div>
</div>
<p>This is confirmed by a correlation test (see below), which shows:</p>
<ol type="a">
<li>a correlation coefficient (Pearson’s <em>r</em>) of exactly <code>1</code>,</li>
<li>an extremely small <em>p</em>-value (the smallest that <code>R</code> can display: <code>&lt; 2.2e-16</code>), and</li>
<li>the narrowest 95% confidence interval possible <code>[1, 1]</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="sc">~</span> N.correct <span class="sc">+</span> Accuracy,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> test.results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    Pearson's product-moment correlation

data:  N.correct and Accuracy
t = 156587349, df = 98, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 1 1
sample estimates:
cor 
  1 </code></pre>
</div>
</div>
<p>Now, we use the base <code>R</code> function <code>lm()</code> to fit a simple linear model to predict the percentage of questions that learners correctly answered based on the number of correct answers that they gave. Like the significance test functions that we saw in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>, <code>lm()</code> takes a <strong>formula</strong> as its first argument. We want to predict the proportion of questions that learners correctly answered as a percentage (<code>Accuracy</code>) so this variable comes <em>before</em> the tilde (<code>~</code>). In statistical modelling, the variable that we want to predict is referred to as the <strong>outcome variable</strong>. We want to use the number of correct answers that the learners gave to make our prediction, so we place the variable <code>N.correct</code> <em>after</em> the tilde. Variables used to predict the outcome are called <strong>predictors</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Accuracy <span class="sc">~</span> N.correct,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> test.results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have saved our model to our local environment as an <code>R</code> object called <code>test.model</code>. We can now use the <code>summary()</code> function to examine the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Accuracy ~ N.correct, data = test.results)

Residuals:
       Min         1Q     Median         3Q        Max 
-1.083e-13 -6.620e-16  1.360e-16  6.230e-16  1.311e-13 

Coefficients:
             Estimate Std. Error   t value Pr(&gt;|t|)    
(Intercept) 5.151e-15  3.717e-15 1.386e+00    0.169    
N.correct   1.000e+01  6.030e-16 1.658e+16   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.736e-14 on 98 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:      1 
F-statistic: 2.75e+32 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>In addition to this model summary, the code above outputs a warning about an “essentially perfect fit” in the Console. We will come to this warning at the end of this section, but for now let’s start by looking at the <strong>coefficients</strong> of our model summary. Every model has an <strong>intercept</strong> coefficient estimate (<code>(Intercept)</code>), which is the value that the model predicts for the outcome variable when the predictor variables are zero. In other words, it is where the regression line would cross the <em>y</em>-axis if the line were extended to go all the way to zero as in <a href="#fig-RTScatterPLotIntercept" class="quarto-xref">Figure&nbsp;<span>12.2</span></a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test.results,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> N.correct, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">10</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span>       </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of correct answers"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% of questions correctly answered"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">10.5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">105</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-RTScatterPLotIntercept" class="quarto-float quarto-figure quarto-figure-center anchored" alt="This is the same plot as above. The only difference is that a dotted blue line extends the fit blue line to zero.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-RTScatterPLotIntercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-RTScatterPLotIntercept-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;12.2: The correlation between learners’ test results expressed as the number of correct answers and the percentage of questions answered correctly"><img src="12_SimpleLinearRegression_files/figure-html/fig-RTScatterPLotIntercept-1.png" class="img-fluid figure-img" alt="This is the same plot as above. The only difference is that a dotted blue line extends the fit blue line to zero." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-RTScatterPLotIntercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: The correlation between learners’ test results expressed as the number of correct answers and the percentage of questions answered correctly
</figcaption>
</figure>
</div>
</div>
</div>
<p>In our case, we only have one predictor, so the intercept coefficient that our model estimates (<code>5.151e-15</code>) corresponds to the predicted percentage of questions answered correctly (outcome) when the number of correct answers (predictor) is equal to zero. Instinctively, we know that this value should be zero because 0 points in a test&nbsp;=&nbsp;0% correct in the test. And, indeed, our model predicts an intercept extremely close to zero (<code>5.151e-15</code>). Using the <code>format()</code> function, we can convert this coefficient estimate from <strong>scientific notation</strong> to standard notation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fl">5.151e-15</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "0.000000000000005151"</code></pre>
</div>
</div>
<p>The second, <code>N.correct</code> coefficient estimate in our model summary is displayed as <code>1.000e+01</code> which is equal to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fl">1.000e+01</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "10"</code></pre>
</div>
</div>
<p>This coefficient estimate means that, for every correct answer, our prediction for the percentage of questions answered correctly increases by 10%. For example, if a student answered 9 questions correctly, our model predicts that the percentage of correctly answered question is equal to the intercept coefficient of (nearly) zero plus 9 multiplied by 10, which is equal to 90%:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">5.151e-15</span> <span class="sc">+</span> <span class="dv">9</span> <span class="sc">*</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 90</code></pre>
</div>
</div>
<p>In our model summary, the coefficient estimate for <code>N.correct</code> is associated with a <em>p</em>-value of <code>&lt;2e-16</code>. It corresponds to the <em>p</em>-value of our <code>cor.test()</code> on the same data, and is actually the smallest value that <code>R</code> will display. In other words, it is extremely small. This <em>p</em>-value indicates that we can safely reject the null hypothesis that this coefficient is zero under the assumptions of a linear regression model. In other words, we can reject the null hypothesis that the number of correct answers is <em>not</em> a useful predictor to predict the percentage of correctly answered questions under the assumption of a linear regression model (more on these assumptions in <a href="11_Inferential.html#sec-Assumptions" class="quarto-xref"><span>Section 11.6</span></a>).</p>
<p>The penultimate line of the model summary is also important. It features two <strong>R-squared (R<sup>2</sup>) values</strong>. Like the absolute values of correlation coefficients, these can range between 0 and 1. R<sup>2</sup>&nbsp;=&nbsp;0 means that the model accounts for 0% of the variance in the outcome variable. R<sup>2</sup>&nbsp;=&nbsp;1 means that the model accounts for 100% of the variance, i.e.&nbsp;that it can perfectly predict the values of the outcome variable from the predictor variable(s). As our simulated <code>test.results</code> dataset is based on a perfect correlation, our model is able to perfectly predict the outcome variable, hence both our R<sup>2</sup> values equal <code>1</code>. In this chapter and <a href="13_MultipleLinearRegression.html" class="quarto-xref"><span>Chapter 13</span></a>, however, we will focus on the <strong>adjusted R-squared value</strong> because it accounts for the fact that the more predictors we include in our model, the easier it is to predict the outcome variable.</p>
<p>Finally, you may have also noticed that the <code>lm()</code> function returned a warning message when we fitted this practice model:</p>
<pre data-code-line-numbers=""><code>Warning message:
In summary.lm(test.model) :
  essentially perfect fit: summary may be unreliable</code></pre>
<p>With this message, the authors of the <code>lm()</code> function are warning us that our model can make almost perfect predictions. Given that in real-life research this is extremely unlikely, an “essentially perfect” prediction is usually a sign that we may have made an error of some kind. Here, however, we can safely ignore this warning because we know that the number of correct answers can, indeed, be converted to percentages of correctly answered questions with perfect accuracy (hence our R<sup>2</sup> of 1 or 100%).</p>
</section>
<section id="a-real-life-prediction" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="a-real-life-prediction"><span class="header-section-number">12.1.2</span> A real-life prediction</h3>
<p>In the remaining sections of the chapter, we fit simple regression models to real data from:</p>
<blockquote class="blockquote">
<p>Dąbrowska, Ewa. 2019. Experience, Aptitude, and Individual Differences in Linguistic Attainment: A Comparison of Native and Nonnative Speakers. Language Learning 69(S1). 72–100. <a href="https://doi.org/10.1111/lang.12323" class="uri">https://doi.org/10.1111/lang.12323</a>.</p>
</blockquote>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisites
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Our starting point for this chapter is the wrangled combined dataset that we created and saved in <a href="9_DataWrangling.html" class="quarto-xref"><span>Chapter 9</span></a>. Follow the instructions in <a href="9_DataWrangling.html#sec-filter" class="quarto-xref"><span>Section 9.8</span></a> to create this <code>R</code> object.</p>
<p>Alternatively, you can download <code>Dabrowska2019.zip</code> from <a href="https://github.com/elenlefoll/RstatsTextbook/raw/69d1e31be7394f2b612825f031ebffeb75886390/Dabrowska2019.zip" class="uri">the textbook’s GitHub repository</a>. To launch the project correctly, first unzip the file and then double-click on the <code>Dabrowska2019.Rproj</code> file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"combined_L1_L2_data.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before you get started, check that you have correctly imported the data by examining the output of <code>View(Dabrowska.data)</code> and <code>str(Dabrowska.data)</code>. In addition, run the following lines of code to load the {tidyverse} packages and create “clean” versions of the L1 and L2 datasets as separate <code>R</code> objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>L1.data <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">"L1"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>L2.data <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">"L2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you are satisfied that the data are correctly loaded, you are ready to start modelling! 🚀</p>
</div>
</div>
</div>
<p>Recall that, in <a href="11_Inferential.html#sec-Correlations" class="quarto-xref"><span>Section 11.5</span></a>, we saw that there is a <strong>positive correlation</strong> between the total number of years that English L1 speakers spent in formal education (<code>EduTotal</code>) and their English grammar comprehension test scores (<code>Grammar</code>). <a href="#fig-EducationYearsVocab" class="quarto-xref">Figure&nbsp;<span>12.3</span></a> suggests that this positive correlation also holds for the association between the number of years participants spent in formal education and their receptive vocabulary test scores (<code>Vocab</code>).</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>L1.data <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> EduTotal, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> Vocab)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-EducationYearsVocab" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot of vocabulary scores on the y-axis, and  years of education on the x-axis. A blue regression line slopes upward, indicating a positive relationship: higher formal education tends to be associated with higher vocabulary scores.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EducationYearsVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-EducationYearsVocab-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;12.3: Relationship between years spent in formal education and vocabulary test scores among L1 speakers"><img src="12_SimpleLinearRegression_files/figure-html/fig-EducationYearsVocab-1.png" class="img-fluid figure-img" alt="Scatter plot of vocabulary scores on the y-axis, and  years of education on the x-axis. A blue regression line slopes upward, indicating a positive relationship: higher formal education tends to be associated with higher vocabulary scores." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EducationYearsVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: Relationship between years spent in formal education and vocabulary test scores among L1 speakers
</figcaption>
</figure>
</div>
</div>
</div>
<p>On average, the longer L1 speakers were in formal education, the better they performed on the vocabulary test. The correlation is larger than for <code>Grammar</code> scores, and it is statistically significant at an α-level of 0.05 (<em>r</em> = 0.43, 95% CI [0.24, 0.58]):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">formula =</span> <span class="sc">~</span> Vocab <span class="sc">+</span> EduTotal,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> L1.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    Pearson's product-moment correlation

data:  Vocab and EduTotal
t = 4.4281, df = 88, p-value = 2.721e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2410910 0.5824698
sample estimates:
      cor 
0.4268695 </code></pre>
</div>
</div>
<p>The straight (i.e.&nbsp;linear) regression line going through our scatter plot in <a href="#fig-EducationYearsVocab" class="quarto-xref">Figure&nbsp;<span>12.3</span></a>, does <em>not</em> go through all the data points like it did in <a href="#fig-RTScatterPLot" class="quarto-xref">Figure&nbsp;<span>12.1</span></a>. This is because, if we know how long an L1 participant was in formal education, we cannot <em>perfectly</em> predict how well they will perform on the <code>Vocab</code> test, even though we do know that, on average, having spent longer in formal education correlates with <code>Vocab</code> test scores. Indeed, <a href="#fig-EducationYearsVocab" class="quarto-xref">Figure&nbsp;<span>12.3</span></a> clearly shows that some of the individuals who attended formal education for the least amount of time scored very low, whilst others scored very high in the <code>Vocab</code> test. This is not surprising, as we can expect that many other factors will play a role in L1 vocabulary knowledge.</p>
<p>We now fit a simple linear regression model using the <code>lm()</code> function (which stands for <strong>linear model</strong>) to the L1 data from <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> with the aim of predicting <code>Vocab</code> scores (our outcome variable) based on the number of years that they spent in formal education (<code>EduTotal</code>; our predictor variable):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> EduTotal,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> L1.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We examine the model using the <code>summary()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ EduTotal, data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-57.725 -10.716   0.526  12.417  36.033 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  20.5159    11.1519   1.840   0.0692 .  
EduTotal      3.5460     0.8008   4.428 2.72e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.51 on 88 degrees of freedom
Multiple R-squared:  0.1822,    Adjusted R-squared:  0.1729 
F-statistic: 19.61 on 1 and 88 DF,  p-value: 2.721e-05</code></pre>
</div>
</div>
<p>This time, we’ll begin our interpretation of the model summary from the top:</p>
<ul>
<li><p>The first line is a reminder of the model <strong>formula</strong> and of the <strong>data</strong> on which we fitted our linear model (<code>lm</code>).</p></li>
<li><p>The second paragraph provides information about the <strong>residuals</strong>. They represent the difference between participants’ actual <code>Vocab</code> scores (the observed values) and the model’s predictions (the predicted values). Hence, they correspond to the variance in <code>Vocab</code> scores that is left unaccounted for by the model. The closer to zero the residuals are, the better the model fits the data. However, no real-life model is perfect so we expect there to be some “left-over” variance.</p>
<ul>
<li><code>Min</code>, <code>1Q</code>, <code>Median</code>, <code>3Q</code>, and <code>Max</code> are the minimum, first quartile, median, third quartile, and maximum residuals, respectively. These are the descriptive statistics of a distribution that are typically displayed in a boxplot (see <a href="8_DescriptiveStats.html#sec-IQR" class="quarto-xref"><span>Section 8.3.2</span></a>). These statistics give us a sense of the spread of the residuals. Whilst these values can be informative, it’s best to plot residuals to get a sense of their distribution (see <a href="#sec-Residuals" class="quarto-xref"><span>Section 12.4.3</span></a>). Ideally, the residuals should be normally distributed and centred around zero (see <a href="#sec-AssumptionsLR" class="quarto-xref"><span>Section 12.4</span></a>).</li>
</ul></li>
<li><p>The <strong>intercept coefficient estimate</strong> of <code>20.516</code> is the model’s prediction for the vocabulary score of participants who spent zero years (!) in formal education (<code>EduTotal</code> = 0). It is the model’s baseline or reference <code>Vocab</code> score.</p></li>
<li><p>The <strong>EduTotal coefficient estimate</strong> of <code>3.546</code> means that, for each year of formal education, our model predicts that <code>Vocab</code> test scores will increase by an additional 3.546 units on top of the baseline score of <code>20.516</code>, provided that all other variables remain the same. Hence, if an individual spent 14 years in formal education, their predicted <code>Vocab</code> score is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fl">20.5159</span> <span class="sc">+</span> <span class="dv">14</span><span class="sc">*</span><span class="fl">3.5460</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 70.1599</code></pre>
</div>
</div></li>
<li><p>The <strong><em>p-</em>value</strong> associated with the <code>EduTotal</code> coefficient is very small (<code>2.72e-05</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fl">2.72e-05</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "0.0000272"</code></pre>
</div>
</div>
<p>It suggests that the predictor <code>EduTotal</code> makes a statistically significant contribution to our model predicting <code>Vocab</code> scores among L1 speakers.</p></li>
<li><p>The <strong>adjusted R-squared (R²)</strong> is <code>0.1729</code>, which means that our model accounts for ca. 17% of the total variance in <code>Vocab</code> scores. That may not seem a lot, but it is worth recalling that our model only includes one predictor variable. We can reasonably assume that other predictors will help us to predict L1 speakers’ vocabulary knowledge more accurately (e.g., their age, how much they read, perhaps their profession, etc.).</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
It’s all linear regression!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Did you notice that the <strong><em>t</em>-value</strong> and the <strong><em>p</em>-value</strong> associated with the <code>EduTotal</code> coefficient in our linear regression model are <em>exactly the same</em> as those that we obtained earlier using the <code>cor.test()</code> function? This is because linear regression with a single numeric predictor is – under the hood – exactly the same as a Pearson’s correlation test!</p>
<p>Moreover, we said that <strong>R²</strong> stands for the <strong>squared coefficient of correlation</strong>, which is why, if we take the square root of our unadjusted R² coefficient, we get 0.43, which corresponds to the <strong>correlation coefficient</strong> (Pearson’s <em>r</em>) that we obtained from the <code>cor.test()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fl">0.1822</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.4268489</code></pre>
</div>
</div>
<p>Having gone through <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>, you may now ask yourself: why do we need correlation tests if simple linear regression does the same thing? 🧐 Honestly, we don’t. <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a> introduced correlation tests and <em>t</em>-tests because they are widely used in the language sciences, so it is important that you understand them, but the truth is: you can achieve much more by taking a modelling rather than a testing approach to analysing data. Read on to find out more!</p>
</div>
</div>
</section>
<section id="predicted-values-and-residuals" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="predicted-values-and-residuals"><span class="header-section-number">12.1.3</span> Predicted values and residuals</h3>
<p><a href="#fig-EduPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.4</span></a> visualises the <code>Vocab</code> scores that our first model (<code>model1</code>) predicts as a function of the number of years that L1 speakers have spent in formal education. We can access our model’s predictions by applying the <code>predict()</code> function to our model object (<code>model1</code>). By definition, regression models predict perfect linear associations. As shown in <a href="#fig-EduPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.4</span></a>, here, our model predicts a perfect, positive linear association between our predictor variable (<code>EduTotal</code>) and our outcome variable (<code>Vocab</code>).</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb34" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(L1.data, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> EduTotal, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">predict</span>(model1))) <span class="sc">+</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">3.55</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="fl">20.51</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span>   </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>() <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">'Predicted Vocab scores'</span>, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'Years in formal education'</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-EduPredictedVocab" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatter plot showing the relationship between years in formal education and predicted vocabulary scores. The points form an upward linear trend and their size corresponds to the number of people in the L1 dataset who reported being in formal education for that many years. Most people reported spending between 11 and 14 years in formal education but some as many 21 years.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EduPredictedVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-EduPredictedVocab-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;12.4: Relationship between years spent in formal education and predicted vocabulary test scores"><img src="12_SimpleLinearRegression_files/figure-html/fig-EduPredictedVocab-1.png" class="img-fluid figure-img" alt="A scatter plot showing the relationship between years in formal education and predicted vocabulary scores. The points form an upward linear trend and their size corresponds to the number of people in the L1 dataset who reported being in formal education for that many years. Most people reported spending between 11 and 14 years in formal education but some as many 21 years." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EduPredictedVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: Relationship between years spent in formal education and predicted vocabulary test scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>You may have noticed that there are fewer dots on <a href="#fig-EduPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.4</span></a> than data points in the dataset that we used to fit the model (N&nbsp;=&nbsp;90). This is because, if more than one L1 participant reported having been in formal education for the same duration of time, the model predicts the same <code>Vocab</code> score for all these people and this means that the dots overlap on the plot of predicted values. To ensure that we keep in mind that a single dot may represent more than one participant, in <a href="#fig-EduPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.4</span></a>, the <code>geom_count()</code> function is used to map the size of each dot onto the number of participants that it represents.</p>
<p>This is all very well, but as we learnt from <a href="#fig-EducationYearsVocab" class="quarto-xref">Figure&nbsp;<span>12.3</span></a>, in reality, our predictor variable <code>EduTotal</code> does not correlate perfectly with <code>Vocab</code> scores — far from it! Let us now compare the <strong>predicted values</strong> of our model with the <strong>observed values</strong> from the data. How well does our model fit the data? To help us answer this question, <a href="#fig-ActualPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.5</span></a> visualises the relationship between L1 participants’ actual <code>Vocab</code> scores (<em>x</em>-axis) and the scores that the model predicted for these participants (<em>y</em>-axis).</p>
<div class="cell" data-fig-heigth="8">
<details class="code-fold">
<summary>Show code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb35" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pred_vals   <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1) <span class="co"># Vector of predictions</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>xmin_pred   <span class="ot">&lt;-</span> <span class="fu">min</span>(pred_vals)  <span class="co"># Lowest predicted score</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>highlight_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(xmin_pred, pred_vals[<span class="dv">68</span>]),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(L1.data<span class="sc">$</span>Vocab[<span class="fu">which.min</span>(pred_vals)],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      <span class="dv">91</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(L1.data, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pred_vals, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Vocab)) <span class="sc">+</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 45° reference line (the "perfect‑prediction" line):</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> xmin_pred, </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">29</span>, </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> xmin_pred,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> pred_vals[<span class="dv">68</span>], </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">91</span>, </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> pred_vals[<span class="dv">68</span>],</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>))) <span class="sc">+</span>  </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> highlight_df,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Vocab scores"</span>, </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Actual Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ActualPredictedVocab" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot with predicted Vocab scores on the x-axis and actual Vocab scores on the y-axis with a dotted blue diagonal line showing where the dots would lie if the model's prediction were perfect. The model's predictions are far from perfect; few dots fall on the dotted line. For two dots, there is a blue line drawn from the dot to the dotted line; the length of these lines represent the model's residuals for these two participants.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ActualPredictedVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-ActualPredictedVocab-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;12.5: Relationship between actual and predicted Vocab test scores"><img src="12_SimpleLinearRegression_files/figure-html/fig-ActualPredictedVocab-1.png" class="img-fluid figure-img" alt="Scatter plot with predicted Vocab scores on the x-axis and actual Vocab scores on the y-axis with a dotted blue diagonal line showing where the dots would lie if the model's prediction were perfect. The model's predictions are far from perfect; few dots fall on the dotted line. For two dots, there is a blue line drawn from the dot to the dotted line; the length of these lines represent the model's residuals for these two participants." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ActualPredictedVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.5: Relationship between actual and predicted <code>Vocab</code> test scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ActualPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.5</span></a>, the dotted blue line represents where the points would lie, if <code>model1</code> perfectly predicted <code>Vocab</code> scores based only on the number of years that participants spent in formal education. The dots that fall on or very close to the dotted line stand for L1 participants for whom our model accurately predicts their <code>Vocab</code> score based solely on the number of years they spent in formal education. The further the dots are from the dotted line, the worse the predictions for these speakers. The distances between each point and the dotted line in <a href="#fig-ActualPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.5</span></a> correspond to the model’s residuals. <strong>Residuals</strong> are therefore the ‘left-over’ variability in the data that our model cannot account for.</p>
<p>Residuals can be positive or negative, depending on whether the dots on the predicted vs.&nbsp;actual values plot are above or below the dotted line of perfect fit. However, what matters more are their absolute values. The larger the residuals, the worse the model fit. Returning to the question, ‘How good is our model fit?’, we can conclude from <a href="#fig-ActualPredictedVocab" class="quarto-xref">Figure&nbsp;<span>12.5</span></a> that it’s not great. But we already knew that from the model’s fairly low R² value and, crucially, we also know that many other factors are likely to account for some of the remaining variation in vocabulary scores.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Association does not imply causation.
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may be familiar with the Latin phrase:</p>
<ul>
<li><strong><em>Cum hoc ergo propter hoc</em></strong> (‘with this, therefore because of this’)</li>
</ul>
<p>or its English equivalent:</p>
<ul>
<li><strong><em>Correlation does not imply causation</em></strong>.</li>
</ul>
<p>They both refer to the human tendency to assume that, if two things are regularly associated, one probably <em>causes</em> the other. However, this is a logical fallacy. For example, even if we had observed a very high correlation between the number of years participants were in formal education and their receptive vocabulary test scores (and had therefore reported an excellent model fit with very small residuals), this would by no means imply that, on average, spending more time in formal education <em>leads to</em> greater vocabulary knowledge. A correlation merely describes an association; it tells us nothing about any causal relationship.</p>
<p>It is often tempting to interpret the results of statistical tests and models causally, but this is the result of a well-known human cognitive bias <span class="citation" data-cites="matuteIllusionsCausalityHow2015 kaufmanIllusionCausalityCognitive2018">(see, e.g, <a href="99_references.html#ref-matuteIllusionsCausalityHow2015" role="doc-biblioref">Matute et al. 2015</a>; <a href="99_references.html#ref-kaufmanIllusionCausalityCognitive2018" role="doc-biblioref">Kaufman &amp; Kaufman 2018</a>)</span>. In the language sciences and across the social sciences more generally, there are usually far too many potential factors at play to warrant any causal interpretation. What we are modelling throughout this chapter and <a href="13_MultipleLinearRegression.html" class="quarto-xref"><span>Chapter 13</span></a> are <strong>statistical associations</strong>. We cannot draw any conclusions about what <em>caused</em> what from these models. In the context of statistical modelling, we can extend the famous saying to: <strong>Association does not imply causation</strong>.</p>
<p>There are three main reasons for this:</p>
<ol type="1">
<li><p>There may be one or more <strong>confounding variables</strong> that we have not accounted for in our model. For instance, we can predict with a fair degree of accuracy how much vocabulary an infant understands based on their weight. However, the weight of young children is, of course, highly correlated with their age and, by extension, the amount of language exposure they’ve had so far in their life. Clearly, it is not their weight that is <em>causing</em> them to understand more words. Unfortunately, it’s not always that obvious. Going back to <code>model1</code>, it is very likely that some of the younger participants in the <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> dataset were still in formal education at the time of data collection; this includes all those who reported being students. In other words, for at least some of the participants, the <code>EduTotal</code> variable confounds age and years spent in formal education.</p></li>
<li><p>Even if there is a causal effect, it may not be in the <strong>direction</strong> that we assume. For example, the vocabulary knowledge of adult learners of a foreign language is probably a fairly good predictor of how many foreign language classes these adult learners have attended. However, this does not mean that vocabulary knowledge <em>causes</em> adults to attend classes. If anything, it is more likely to be the other way around. Whilst it seems rather obvious in this example, in linguistics and education, complex interdependencies between predictors are very common. Consider reading ability: the more a child reads, the better they become at reading. Therefore, we might conclude that spending more time reading leads to better reading skills. However, for some children, poor reading skills may actually <em>cause</em> a lack of motivation and interest in reading in the first place. Clearly, determining causal relationships is tricky!</p></li>
<li><p>Finally, it is important to consider the possibility that even a statistically significant association could be entirely <strong>spurious</strong>. This happens more often than you might think, and it is more likely to happen with smaller datasets. Moreover, the more we test associations, the more likely we are to find statistically significant ones (see <a href="11_Inferential.html#sec-pHacking" class="quarto-xref"><span>Section 11.7</span></a> on the multiple testing problem and Type 1 errors). When associations are very strong, we may be tempted to think that they are real, but this may not be the case. To raise awareness of this risk, <a href="https://tylervigen.com/about-spurious-correlations">Tyler Vigen</a> conducted correlation tests on millions of combinations of randomly selected variables and created a website featuring thousands of examples of very large and highly significant correlations that are all entirely spurious (e.g. <a href="#fig-SpuriousCorrelation" class="quarto-xref">Figure&nbsp;<span>12.6</span></a>).</p>
<div id="fig-SpuriousCorrelation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A linear line chart with years as the X-axis and two variables on the Y-axis. The first variable is Air pollution in Johnstown, Pennsylvania and the second variable is Master's degrees awarded in Education.  The chart goes from 2012 to 2021, and the two variables track closely in value over that time. The following statistics are displayed on the graph: Pearson's r = 0.989, r-squared = 0.979, p < 0.01 Source: tylervigen.com/spurious/correlation/3139">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SpuriousCorrelation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/Vigen_unhealthy-air-quality-in-johnstown-pennsylvania_correlates-with_masters-degrees-awarded-in-education.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;12.6: Find this spurious correlation (CC BY 4.0) and thousands more by Tyler Vigen at https://tylervigen.com/spurious-correlations."><img src="images/Vigen_unhealthy-air-quality-in-johnstown-pennsylvania_correlates-with_masters-degrees-awarded-in-education.png" class="img-fluid figure-img" alt="A linear line chart with years as the X-axis and two variables on the Y-axis. The first variable is Air pollution in Johnstown, Pennsylvania and the second variable is Master's degrees awarded in Education.  The chart goes from 2012 to 2021, and the two variables track closely in value over that time. The following statistics are displayed on the graph: Pearson's r = 0.989, r-squared = 0.979, p < 0.01 Source: tylervigen.com/spurious/correlation/3139"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SpuriousCorrelation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.6: Find this spurious correlation (CC BY 4.0) and thousands more by Tyler Vigen at <a href="https://tylervigen.com/spurious-correlations" class="uri">https://tylervigen.com/spurious-correlations</a>.
</figcaption>
</figure>
</div></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In this task, you will seek answers to the research question: To what extent can the results of the non-verbal IQ <code>Blocks</code> test be used to predict <code>Vocab</code> scores among L1 and L2 speakers of English based on the data from <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span>? As we will be answering this question within a linear regression framework, what we are really asking is: To what extent are these variables linearly associated with each other?</p>
<p><span style="color:green;"><strong>Q12.1</strong></span> Fit a linear model to predict <code>Vocab</code> scores among L1 participants based on their <code>Blocks</code> test scores. What is the adjusted R<sup>2</sup> value of this model?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_53559" onsubmit="return validate_form_53559()" method="post">
<label>
<input type="radio" name="answer_53559" id="answer_53559_1" value="0.0009">
0.0009
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_2" value="0.006">
0.006
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_3" value="0.007">
0.007
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_4" value="0.07">
0.07
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_5" value="0.08">
0.08
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_6" value="0.7">
0.7
</label>
<br>
<label>
<input type="radio" name="answer_53559" id="answer_53559_7" value="0.9">
0.9
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_53559"></div>
</form>
<script>function validate_form_53559() {var x, text; var x = document.forms['form_53559']['answer_53559'].value;if (x == '0.07'){text = 'That’s right, well done!';} else {text = 'No, that’s not it. Are you modelling the L1 data only?';} document.getElementById('result_53559').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!';text = res1;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.1.</summary>
<div class="sourceCode cell-code" id="cb36" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>taskmodel1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> Blocks,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> L1.data)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel1) <span class="co"># Adjusted R-squared:  0.07232 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.2</strong></span> According to your model, which of these values is the predicted <code>Vocab</code> score of an L1 speaker with a <code>Blocks</code> score of 20?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_35078" onsubmit="return validate_form_35078()" method="post">
<label>
<input type="radio" name="answer_35078" id="answer_35078_1" value="About 75">
About 75
</label>
<br>
<label>
<input type="radio" name="answer_35078" id="answer_35078_2" value="About 21">
About 21
</label>
<br>
<label>
<input type="radio" name="answer_35078" id="answer_35078_3" value="About 55">
About 55
</label>
<br>
<label>
<input type="radio" name="answer_35078" id="answer_35078_4" value="About 1">
About 1
</label>
<br>
<label>
<input type="radio" name="answer_35078" id="answer_35078_5" value="Just over 0">
Just over 0
</label>
<br>
<label>
<input type="radio" name="answer_35078" id="answer_35078_6" value="About -54">
About -54
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_35078"></div>
</form>
<script>function validate_form_35078() {var x, text; var x = document.forms['form_35078']['answer_35078'].value;if (x == 'About 75'){text = 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. <code>predict(taskmodel1, data.frame(Blocks = 20))</code>';} else {text = 'Humm, are you sure?';} document.getElementById('result_35078').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))';text = res1 + res2;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_15607" onmouseover="return show_hint_15607()">🦉 Hover over the owl for a first hint.</div>
<div id="result_15607" onmouseover="return show_hint_15607()"></div>
<script>function show_hint_15607(){var x = document.getElementById('result_15607').innerHTML; if(!x){document.getElementById('result_15607').innerHTML = 'You can answer this question either by plotting the predicted values of your model and reading the value off your graph or by doing some maths using the coefficient estimates provided in the summary of your model.';} else {document.getElementById('result_15607').innerHTML = '';}}</script>
</div>
<div class="cell-output-display">
<div id="hint_2707" onclick="return show_hint_2707()">🐭 Click on the mouse for a second hint.</div>
<div id="result_2707" onclick="return show_hint_2707()"></div>
<script>function show_hint_2707(){var x = document.getElementById('result_2707').innerHTML; if(!x){document.getElementById('result_2707').innerHTML = 'If you choose to do solve this question numerically, you will need to multiply the coefficient estimate for the Blocks variable by 20 and add this to the coefficient estimate for the intercept.';} else {document.getElementById('result_2707').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to answer Q12.2</summary>
<div class="sourceCode cell-code" id="cb37" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Taking a numerical approach, you can add up the model coefficients printed in the model summary. As always, start with the intercept coefficient and add to it the coefficient corresponding to an increase in one point on the Blocks test multiplied by the number of points that this participant achieved (20):</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel1)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fl">54.5614</span> <span class="sc">+</span> <span class="fl">1.0527</span><span class="sc">*</span><span class="dv">20</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, we can take the coefficient estimate values directly from the model object to get an even more precise prediction like this:</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>taskmodel1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> (taskmodel1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">20</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Taking a graphical approach, we need to plot the model's predicted Vocab scores against all Blocks test scores in the dataset in order to find out how what the model's prediction is for a Blocks test score of 20. The ggplot code below adds an arrow and a dotted line to help you read the predicted Vocab score from the plot:</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(L1.data, </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Blocks, </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">predict</span>(taskmodel1))) <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">20</span>, </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">50</span>, </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> <span class="dv">75</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> <span class="fl">19.5</span>, </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">75.6</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">'Predicted Vocab scores'</span>, </span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'Blocks test scores'</span>) <span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.3</strong></span> Now fit a new linear model to predict <code>Vocab</code> scores among L2 participants based on their <code>Blocks</code> test scores. Comparing the adjusted R<sup>2</sup> value of this new L2 model to your previous L1 model, which of these statements is/are true?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_20558" onsubmit="return validate_form_20558()" method="post">
<label>
<input type="checkbox" id="answer_20558_1" value="Blocks test scores are a much more useful predictor of Vocab scores for L1 than L2 participants.">
Blocks test scores are a much more useful predictor of Vocab scores for L1 than L2 participants.
</label>
<br>
<label>
<input type="checkbox" id="answer_20558_2" value="Blocks test scores are a much useful predictor of Vocab scores for L2 than L1 participants.">
Blocks test scores are a much useful predictor of Vocab scores for L2 than L1 participants.
</label>
<br>
<label>
<input type="checkbox" id="answer_20558_3" value="Higher Blocks test scores lead to statistically significantly higher Vocab scores among L1 participants.">
Higher Blocks test scores lead to statistically significantly higher Vocab scores among L1 participants.
</label>
<br>
<label>
<input type="checkbox" id="answer_20558_4" value="Blocks test scores allow us to almost perfectly predict Vocab scores among L1 participants.">
Blocks test scores allow us to almost perfectly predict Vocab scores among L1 participants.
</label>
<br>
<label>
<input type="checkbox" id="answer_20558_5" value="Blocks test scores allow us to almost perfectly predict Vocab scores among L2 participants.">
Blocks test scores allow us to almost perfectly predict Vocab scores among L2 participants.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_20558"></div>
</form>
<script>function validate_form_20558() {var text; var x1 = document.getElementById('answer_20558_1'); var x2 = document.getElementById('answer_20558_2'); var x3 = document.getElementById('answer_20558_3'); var x4 = document.getElementById('answer_20558_4'); var x5 = document.getElementById('answer_20558_5'); if (x1.checked == true&x2.checked == false&x3.checked == false&x4.checked == false&x5.checked == false){text = 'That’s right, well done!';} else {text = 'No, compare the adjusted R-squared values of the two models.';} document.getElementById('result_20558').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!';text = res1 + res2 + res3;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_24013" onmouseover="return show_hint_24013()">🦉 Hover over the owl for a first hint.</div>
<div id="result_24013" onmouseover="return show_hint_24013()"></div>
<script>function show_hint_24013(){var x = document.getElementById('result_24013').innerHTML; if(!x){document.getElementById('result_24013').innerHTML = 'Remember that we cannot interpret linear regression models causally.';} else {document.getElementById('result_24013').innerHTML = '';}}</script>
</div>
<div class="cell-output-display">
<div id="hint_25602" onclick="return show_hint_25602()">🐭 Click on the mouse for a second hint.</div>
<div id="result_25602" onclick="return show_hint_25602()"></div>
<script>function show_hint_25602(){var x = document.getElementById('result_25602').innerHTML; if(!x){document.getElementById('result_25602').innerHTML = 'Only one of these statements is true.';} else {document.getElementById('result_25602').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.3.</summary>
<div class="sourceCode cell-code" id="cb38" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>taskmodel2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> Blocks,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> L2.data)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel2) <span class="co"># Adjusted R-squared:  0.007177 </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel1) <span class="co"># Adjusted R-squared:  0.07232 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.4</strong></span> In your L2 model, the <em>p</em>-value for the <code>Blocks</code> predictor should be <code>0.228620</code>. True or false: This <em>p</em>-value means that there is a 23% chance of obtaining a Blocks coefficient estimate of 0.72 or higher in a random sample of 67 L2 speakers of English when there is actually no association between the results of the <code>Blocks</code> test and those of the <code>Vocab</code> test?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_68806" onsubmit="return validate_form_68806()" method="post">
<label>
<input type="radio" name="answer_68806" id="answer_68806_1" value="True.">
True.
</label>
<br>
<label>
<input type="radio" name="answer_68806" id="answer_68806_2" value="False.">
False.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_68806"></div>
</form>
<script>function validate_form_68806() {var x, text; var x = document.forms['form_68806']['answer_68806'].value;if (x == 'True.'){text = 'Indeed!';} else {text = 'No, remember that the <em>p</em>-value is statement about the likelihood of the data given the null hypothesis of no association.';} document.getElementById('result_68806').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!';text = res1 + res2 + res3 + res4;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-Ttestsregression" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sec-Ttestsregression"><span class="header-section-number">12.2</span> <em>t</em>-tests as regression over a binary variable</h2>
<p>Let us now see how much of the variation across all receptive English vocabulary test scores in the <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> data we can accurately predict if we only include a single <strong>categorical binary variable</strong> predictor in our model: whether the <code>Vocab</code> scores belong to L1 or L2 speakers of English. Hence, in the following model, we keep the same outcome variable (<code>Vocab</code>), but now we try to predict it using the <code>Group</code> variable as our single predictor.</p>
<p>We know that, on average, L1 speakers score better on the <code>Vocab</code> test than L2 speakers. However, as illustrated in <a href="#fig-IQL1L2" class="quarto-xref">Figure&nbsp;<span>12.7</span></a>, we also know that there is quite a bit of variability around the mean scores of the L1 and L2 speakers.</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb39" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_vocab =</span> <span class="fu">mean</span>(Vocab))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Dabrowska.data, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Group, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Vocab)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean,                     <span class="co"># what to plot</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>,                 <span class="co"># as a point</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">18</span>,                     <span class="co"># in a diamond shape</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,                       <span class="co"># a little larger than the default</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> group_means,                   </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(Group), </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> mean_vocab),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> group_means,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(Group), </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> mean_vocab,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, mean_vocab)), <span class="co"># print the means to two decimal points</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.4</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Non-verbal IQ (Blocks) test"</span>) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-IQL1L2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Box plot comparing non-verbal IQ scores between two groups, L1 and L2. A blue dashed trend line connects the medians, showing that the median L1 score is lower than the median L2 score. Both groups display outliers at the lower end of their distributions.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-IQL1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-IQL1L2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;12.7: Comparison of non-verbal IQ (Blocks) test scores between L1 and L2 groups"><img src="12_SimpleLinearRegression_files/figure-html/fig-IQL1L2-1.png" class="img-fluid figure-img" alt="Box plot comparing non-verbal IQ scores between two groups, L1 and L2. A blue dashed trend line connects the medians, showing that the median L1 score is lower than the median L2 score. Both groups display outliers at the lower end of their distributions." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IQL1L2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.7: Comparison of non-verbal IQ (Blocks) test scores between L1 and L2 groups
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <em>t</em>-test shows that the mean difference between L1 and L2 speakers is statistically significant (<em>p</em>&nbsp;=&nbsp;<code>7.032e-06</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Vocab <span class="sc">~</span> Group, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> Dabrowska.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    Welch Two Sample t-test

data:  Vocab by Group
t = 4.6768, df = 133.83, p-value = 7.032e-06
alternative hypothesis: true difference in means between group L1 and group L2 is not equal to 0
95 percent confidence interval:
  9.425801 23.240497
sample estimates:
mean in group L1 mean in group L2 
        69.13580         52.80265 </code></pre>
</div>
</div>
<p>Cohen’s <em>d</em> is large (<code>0.77</code>) and the 95% confidence interval does not go anywhere near zero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(Vocab <span class="sc">~</span> Group, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> Dabrowska.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Cohen's d |       95% CI
------------------------
0.77      | [0.44, 1.09]

- Estimated using pooled SD.</code></pre>
</div>
</div>
<p>So we can be confident that the <code>Group</code> variable will be a useful predictor to predict <code>Vocab</code> in a simple linear regression model. We can use exactly the same formula as earlier to fit our model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> Group, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ Group, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-66.136 -13.580   2.753  17.531  38.308 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   69.136      2.247  30.763  &lt; 2e-16 ***
GroupL2      -16.333      3.440  -4.748 4.64e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.32 on 155 degrees of freedom
Multiple R-squared:  0.127, Adjusted R-squared:  0.1213 
F-statistic: 22.54 on 1 and 155 DF,  p-value: 4.644e-06</code></pre>
</div>
</div>
<p>Let’s break down the model summary:</p>
<ul>
<li><p>The <strong>intercept coefficient estimate</strong> is the predicted <code>Vocab</code> score when <code>Group</code> is at its reference level. By default, in <code>R</code>, the reference level of a categorical variable is the level that comes first alphabetically. Here, it’s therefore ‘L1’ for the English native speaker group. The model’s estimated <code>Vocab</code> test score for an L1 participant is therefore <code>69.136</code> points. If you check <a href="#fig-IQL1L2" class="quarto-xref">Figure&nbsp;<span>12.7</span></a>, you will see that this value corresponds to the mean L1 <code>Vocab</code> score in our data.</p></li>
<li><p>The <strong>GroupL2 coefficient</strong> <strong>estimate</strong> is the estimated change in <code>Vocab</code> score for an L2 speaker as compared to the reference level of an L1 speaker. The estimate is <code>-16.333</code>, which means that L2 speakers are predicted to score 16.333 points <em>lower</em> than L1 speakers on this test. If you subtract this <code>GroupL2</code> coefficient estimate from the <code>Intercept</code>, you will find that it corresponds to the mean L2 <code>Vocab</code> score in our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fl">69.136</span> <span class="sc">-</span> <span class="fl">16.333</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 52.803</code></pre>
</div>
</div></li>
<li><p>The <strong><em>p</em>-value</strong> associated with the coefficient <code>GroupL2</code> is extremely small (<code>4.64e-06</code>). It informs us that <code>Group</code> is a statistically significant predictor of receptive English vocabulary knowledge based on our data.</p></li>
<li><p>The <strong>adjusted R-squared</strong> value indicates the proportion of variation in <code>Vocab</code> scores that the model can account for when we know a participant’s native-speaker status: 12.13% (<code>0.1213</code>). This value is not particularly impressive. However, this is not surprising given that our model attempts to predict vocabulary scores based solely on whether someone is an L1 or L2 speaker of English. With only this information, the model can only predict that L1 speakers will achieve the mean L1 score and L2 speakers the mean L2 score of the sample data.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
It’s (still) all linear regression!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Here, too, it is worth noticing that fitting a simple linear regression model with a single binary predictor is — under the hood — exactly the same thing as conducting an <strong>independent</strong> <strong>two-sample <em>t</em>-test</strong>. Compare the <strong><em>t</em>-statistic</strong> of the <em>t</em>-test that we computed earlier with that of the <em>t</em>-statistic of the <code>GroupL2</code> coefficient reported in the summary of our second model. If we ignore the signs of the <em>t</em>-values, we can see that they are almost identical!</p>
<p>Also, notice how the <strong><em>p</em>-value</strong> computed by the <code>t.test()</code> function and that reported for our <code>GroupL2</code> coefficient are almost identical. They both correspond to values that are extremely close to zero.</p>
<p>The very small differences between these values are due to the default correction that the <code>t.test()</code> function in <code>R</code> makes for unequal group variances (see <a href="8_DescriptiveStats.html#sec-Variability" class="quarto-xref"><span>Section 8.3</span></a>). If we switch off this correction, both the <em>t</em>-statistic and the <em>p</em>-value are exactly the same as those reported in the summary of our second linear model above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Vocab <span class="sc">~</span> Group, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> Dabrowska.data,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    Two Sample t-test

data:  Vocab by Group
t = 4.7478, df = 155, p-value = 4.644e-06
alternative hypothesis: true difference in means between group L1 and group L2 is not equal to 0
95 percent confidence interval:
  9.537477 23.128821
sample estimates:
mean in group L1 mean in group L2 
        69.13580         52.80265 </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><span style="color:green;"><strong>Q12.5</strong></span> Draw a boxplot showing the distribution of <code>Vocab</code> scores among male and female participants in <code>Dabrowska.data</code>. Based on your boxplot, do you expect <code>Gender</code> to be a statistically significant predictor of <code>Vocab</code> scores?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_71636" onsubmit="return validate_form_71636()" method="post">
<label>
<input type="radio" name="answer_71636" id="answer_71636_1" value="No, because there is a lot of overlap between the two distributions and the female and male median Vocab scores are very close to each other.">
No, because there is a lot of overlap between the two distributions and the female and male median Vocab scores are very close to each other.
</label>
<br>
<label>
<input type="radio" name="answer_71636" id="answer_71636_2" value="No, because the female and male mean Vocab scores are very close to each other.">
No, because the female and male mean Vocab scores are very close to each other.
</label>
<br>
<label>
<input type="radio" name="answer_71636" id="answer_71636_3" value="Yes, because the mean Vocab score of male participants is higher than that of female participants.">
Yes, because the mean Vocab score of male participants is higher than that of female participants.
</label>
<br>
<label>
<input type="radio" name="answer_71636" id="answer_71636_4" value="Yes, because there are a lot of very low Vocab scores among female participants.">
Yes, because there are a lot of very low Vocab scores among female participants.
</label>
<br>
<label>
<input type="radio" name="answer_71636" id="answer_71636_5" value="Yes, because there are significantly more female participants in this dataset.">
Yes, because there are significantly more female participants in this dataset.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_71636"></div>
</form>
<script>function validate_form_71636() {var x, text; var x = document.forms['form_71636']['answer_71636'].value;if (x == 'No, because there is a lot of overlap between the two distributions and the female and male median Vocab scores are very close to each other.'){text = 'Well done!';} else {text = 'No, that’s not it. Remember that the middle line in a boxplot represents the median.';} document.getElementById('result_71636').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!';text = res1 + res2 + res3 + res4 + res5;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.5.</summary>
<div class="sourceCode cell-code" id="cb50" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Gender,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> Vocab)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gender"</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.6</strong></span> Fit a model with <code>Vocab</code> as the outcome variable and <code>Gender</code> as the predictor to test your intuition based on your boxplot. Is <code>Gender</code> a statistically significant predictor of <code>Vocab</code> score in this simple linear regression model?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_156" onsubmit="return validate_form_156()" method="post">
<label>
<input type="radio" name="answer_156" id="answer_156_1" value="No, the p-value associated with GenderM coefficient is higher than 0.05.">
No, the p-value associated with GenderM coefficient is higher than 0.05.
</label>
<br>
<label>
<input type="radio" name="answer_156" id="answer_156_2" value="Yes, the p-value associated with GenderM coefficient is higher than 0.05.">
Yes, the p-value associated with GenderM coefficient is higher than 0.05.
</label>
<br>
<label>
<input type="radio" name="answer_156" id="answer_156_3" value="No, the p-value associated with GenderM coefficient is lower than 0.05.">
No, the p-value associated with GenderM coefficient is lower than 0.05.
</label>
<br>
<label>
<input type="radio" name="answer_156" id="answer_156_4" value="Yes, the p-value associated with GenderM coefficient is lower than 0.05.">
Yes, the p-value associated with GenderM coefficient is lower than 0.05.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_156"></div>
</form>
<script>function validate_form_156() {var x, text; var x = document.forms['form_156']['answer_156'].value;if (x == 'No, the p-value associated with GenderM coefficient is higher than 0.05.'){text = 'That’s right!';} else {text = 'Are you sure? You should have obtained a p-value of 0.957.';} document.getElementById('result_156').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!';text = res1 + res2 + res3 + res4 + res5 + res6;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_95173" onclick="return show_hint_95173()">🐭 Click on the mouse for a hint.</div>
<div id="result_95173" onclick="return show_hint_95173()"></div>
<script>function show_hint_95173(){var x = document.getElementById('result_95173').innerHTML; if(!x){document.getElementById('result_95173').innerHTML = 'You will need to fit a linear model with <code>Vocab</code> as the outcome variable and <code>Gender</code> as the predictor.';} else {document.getElementById('result_95173').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to answer Q12.6</summary>
<div class="sourceCode cell-code" id="cb51" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>taskmodel3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> Gender,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel3) <span class="co"># p-value associated with coefficient estimate for GenderM = 0.957</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.7</strong></span> The adjusted R<sup>2</sup> coefficient of the model is <code>-0.006433</code>. True or false: This means that male participants, on average, score 0.006433 fewer points than female participants on the <code>Vocab</code> test?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_63340" onsubmit="return validate_form_63340()" method="post">
<label>
<input type="radio" name="answer_63340" id="answer_63340_1" value="True.">
True.
</label>
<br>
<label>
<input type="radio" name="answer_63340" id="answer_63340_2" value="False.">
False.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_63340"></div>
</form>
<script>function validate_form_63340() {var x, text; var x = document.forms['form_63340']['answer_63340'].value;if (x == 'False.'){text = 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.';} else {text = 'No, that’s incorrect.';} document.getElementById('result_63340').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</section>
<section id="sec-Categoricalpredictor" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="sec-Categoricalpredictor"><span class="header-section-number">12.3</span> Regressing over a categorical predictor with more than two levels</h2>
<p>The beauty of the statistical modelling approach — as opposed to the testing approach — is that we can include all kinds of predictors in our models using a single function, <code>lm()</code>, and <code>R</code>’s formula syntax. So far, we have seen that predictors can be numeric variables (e.g.&nbsp;<code>EduTotal</code>) and categorical binary variables (e.g.&nbsp;<code>Group</code>). In this section, we see how a categorical variable with more than two levels can be entered in a linear regression model.</p>
<p>To demonstrate this, we will now attempt to predict participants’ <code>Vocab</code> scores based on their occupational group (<code>OccupGroup</code>), which can be one of four broad categories (see <a href="10_Dataviz.html#sec-geoms" class="quarto-xref"><span>Section 10.1.4</span></a>):</p>
<blockquote class="blockquote">
<p><strong>C</strong>: Clerical positions</p>
<p><strong>I</strong>: Occupationally inactive (i.e., unemployed, retired, or homemakers)</p>
<p><strong>M</strong>: Manual jobs</p>
<p><strong>PS</strong>: Professional-level jobs or studying for a degree</p>
</blockquote>
<p>According to the descriptive statistics visualised in <a href="#fig-VocabByOccupation" class="quarto-xref">Figure&nbsp;<span>12.8</span></a>, it looks like participants’ professional occupation group is unlikely to be terribly useful to predict their vocabulary knowledge. Nonetheless, we can see that — perhaps somewhat counter-intuitively — so-called “occupationally inactive” participants (“I”) tend to score higher than the other participants.</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">y =</span> Vocab, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> OccupGroup,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> OccupGroup,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> OccupGroup)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">outliers =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># If the outliers are plotted as part of the boxplot, these data points will be duplicated by the geom_jitter() function.</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-VocabByOccupation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Box plot showing predicted vocabulary scores across four occupational groups (C, I, M, and PS). Individual data points are overlaid as dots on each box plot. All groups show substantial variability and some extreme outliers at the lower end of the distribution.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VocabByOccupation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-VocabByOccupation-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;12.8: Distribution of vocabulary test scores across four occupational groups"><img src="12_SimpleLinearRegression_files/figure-html/fig-VocabByOccupation-1.png" class="img-fluid figure-img" alt="Box plot showing predicted vocabulary scores across four occupational groups (C, I, M, and PS). Individual data points are overlaid as dots on each box plot. All groups show substantial variability and some extreme outliers at the lower end of the distribution." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VocabByOccupation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.8: Distribution of vocabulary test scores across four occupational groups
</figcaption>
</figure>
</div>
</div>
</div>
<p>So, let’s compute a simple linear model with <code>OccupGroup</code> as a predictor of <code>Vocab</code> and examine its summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> OccupGroup, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ OccupGroup, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-74.406 -13.504   3.372  16.705  34.688 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    63.333      3.867  16.379   &lt;2e-16 ***
OccupGroupI    12.393      5.775   2.146   0.0335 *  
OccupGroupM    -9.133      5.160  -1.770   0.0787 .  
OccupGroupPS   -2.261      4.817  -0.469   0.6395    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.87 on 153 degrees of freedom
Multiple R-squared:  0.09288,   Adjusted R-squared:  0.07509 
F-statistic: 5.222 on 3 and 153 DF,  p-value: 0.001849</code></pre>
</div>
</div>
<ul>
<li><p>The estimate of the <strong>intercept</strong> corresponds to the reference level of the <code>OccupGroup</code> variable. Remember that the <strong>reference level</strong> is always the first level. We can check the order of the levels in any factor variable using the <code>levels()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Dabrowska.data<span class="sc">$</span>OccupGroup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "C"  "I"  "M"  "PS"</code></pre>
</div>
</div>
<p>By default, the levels are ordered alphabetically. In the <code>OccupGroup</code> variable, the first level is “C”, which corresponds to a clerical position. This means that our third model predicts that English speakers in a clerical position will score <code>63.333</code> points on the <code>Vocab</code> test. Those that belong to the “inactive” group (“I”) will score <code>12.393</code> <em>more</em> points than those, i.e.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fl">63.333</span> <span class="sc">+</span> <span class="fl">12.393</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 75.726</code></pre>
</div>
</div>
<p>Participants who have manual jobs (“M”) are predicted to score <code>-9.133</code> points <em>fewer</em> than those in clerical positions, and so-called “professionals” (“PS”) will do slightly worse than clerks (<code>-2.261</code> points). Compare these predicted values to those observed in the data shown in <a href="#fig-VocabByOccupation" class="quarto-xref">Figure&nbsp;<span>12.8</span></a>.</p></li>
<li><p>The <strong>adjusted R<sup>2</sup> value</strong> for our model is relatively low (<code>0.07509</code>). This means that our model accounts for about 7.5% of the total variance in <code>Vocab</code> scores across the dataset. Given that the R<sup>2</sup> of <code>model1</code> was <code>0.1213</code>, this indicates that <code>OccupGroup</code> is a considerably less useful predictor variable to help us predict participants’ <code>Vocab</code> scores than whether or not they are an L1 speaker (<code>Group</code>).</p></li>
<li><p>What’s more, the model summary reveals that only one of the <code>model3</code>’s three coefficient estimates is statistically significantly different from 0 at the α-level of 0.05: <code>OccupGroupI</code> with a <strong><em>p</em>-value</strong> of <code>0.0335</code>. This means that we can reject the null hypothesis that there is no difference in <code>Vocab</code> scores between speakers of the occupational group “C” (the reference level) and those of the occupational group “I”. For the other two occupational groups, we do not have enough evidence to reject the null hypothesis of no difference compared to the reference level “C”.</p></li>
</ul>
<p>We can display the predicted <code>Vocab</code> scores for each occupational group, together with a 95% confidence interval around these predicted values using the <code>emmeans()</code> function from the <a href="https://rvlenth.github.io/emmeans/index.html">{emmeans}</a> package <span class="citation" data-cites="lenthEmmeansEstimatedMarginal2025a">(<a href="99_references.html#ref-lenthEmmeansEstimatedMarginal2025a" role="doc-biblioref">Lenth 2025</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("emmeans")</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(model3, <span class="sc">~</span> OccupGroup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> OccupGroup emmean   SE  df lower.CL upper.CL
 C            63.3 3.87 153     55.7     71.0
 I            75.7 4.29 153     67.3     84.2
 M            54.2 3.42 153     47.5     60.9
 PS           61.1 2.87 153     55.4     66.7

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>The <a href="https://pbreheny.github.io/visreg/index.html">{visreg}</a> package <span class="citation" data-cites="brehenyVisualizationRegressionModels2017">(<a href="99_references.html#ref-brehenyVisualizationRegressionModels2017" role="doc-biblioref">Breheny &amp; Burchett 2017</a>)</span> provides an efficient way of visualising model predictions and residuals. In <a href="#fig-PredictedVocabByOccupation" class="quarto-xref">Figure&nbsp;<span>12.9</span></a> we visualise the model’s predicted values (as blue lines) and the confidence intervals output by the <code>emmeans()</code> function (as grey bands), together with the model’s residuals (as grey dots).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model3, <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Occupational groups"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PredictedVocabByOccupation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Box plot showing predicted vocabulary scores across four occupational groups (C, I, M, and PS). Individual data points are shown as gray dots overlaid on gray box plots with blue median lines.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabByOccupation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-PredictedVocabByOccupation-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;12.9: Distribution of predicted vocabulary test scores across four occupational groups"><img src="12_SimpleLinearRegression_files/figure-html/fig-PredictedVocabByOccupation-1.png" class="img-fluid figure-img" alt="Box plot showing predicted vocabulary scores across four occupational groups (C, I, M, and PS). Individual data points are shown as gray dots overlaid on gray box plots with blue median lines." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabByOccupation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.9: Distribution of predicted vocabulary test scores across four occupational groups
</figcaption>
</figure>
</div>
</div>
</div>
<p>When we use the argument “gg = TRUE”, the <code>visreg()</code> function outputs a ggplot object that we can then manipulate and customise just like any other ggplot object (see <a href="10_Dataviz.html" class="quarto-xref"><span>Chapter 10</span></a>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What about ANOVAs?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>You may come across the type of simple linear regression model that we have just covered, involving a continuous numeric outcome variable and a categorical predictor with more than two levels, under the guise of a statistical significance test, namely the <strong>one-way ANOVA</strong> (ANalysis Of VAriance).</p>
<p>If you compare the summary of the following one-way ANOVA with that of the third model (<code>model3</code>), you will spot some similarities. However, it is necessary to carry out so-called post-hoc tests to get as much information out of an ANOVA as we can get from the summary of our simple linear regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>anova1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> OccupGroup, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
OccupGroup    3   7495  2498.5   5.222 0.00185 **
Residuals   153  73205   478.5                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In this task, you will explore whether L2 participants’ native language is a useful predictor when trying to model their English <code>Vocab</code> scores.</p>
<p><span style="color:green;"><strong>Q12.8</strong></span> Fit a linear model to model L2 participants’ <code>Vocab</code> score based on their native language (<code>NativeLg</code>). According to the model’s adjusted R<sup>2</sup> coefficient, how much of the variance in <code>Vocab</code> scores among L2 participants does this model account for?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_1488" onsubmit="return validate_form_1488()" method="post">
<label>
<input type="radio" name="answer_1488" id="answer_1488_1" value="Practically 0%">
Practically 0%
</label>
<br>
<label>
<input type="radio" name="answer_1488" id="answer_1488_2" value="About 5%">
About 5%
</label>
<br>
<label>
<input type="radio" name="answer_1488" id="answer_1488_3" value="About 13%">
About 13%
</label>
<br>
<label>
<input type="radio" name="answer_1488" id="answer_1488_4" value="About 26%">
About 26%
</label>
<br>
<label>
<input type="radio" name="answer_1488" id="answer_1488_5" value="About 49%">
About 49%
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_1488"></div>
</form>
<script>function validate_form_1488() {var x, text; var x = document.forms['form_1488']['answer_1488'].value;if (x == 'About 13%'){text = 'That’s right!';} else {text = 'No, this is not the correct value.';} document.getElementById('result_1488').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.8.</summary>
<div class="sourceCode cell-code" id="cb64" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>taskmodel3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> NativeLg,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> L2.data) </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel3) <span class="co"># Adjusted R-squared:  0.1331 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.9</strong></span> In this model, there is a greater difference between the multiple R<sup>2</sup> and the adjusted R<sup>2</sup> coefficients than in all previous models in this chapter. Why might that be?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_4743" onsubmit="return validate_form_4743()" method="post">
<label>
<input type="checkbox" id="answer_4743_1" value="Because knowing a participant's native language is a particularly useful predictor of Vocab scores.">
Because knowing a participant's native language is a particularly useful predictor of Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_4743_2" value="Because the NativeLg variable includes 10 different levels.">
Because the NativeLg variable includes 10 different levels.
</label>
<br>
<label>
<input type="checkbox" id="answer_4743_3" value="Because a participant's native language is inherently connected to their English vocabulary knowledge.">
Because a participant's native language is inherently connected to their English vocabulary knowledge.
</label>
<br>
<label>
<input type="checkbox" id="answer_4743_4" value="Because the model's p-value is only just below 0.05.">
Because the model's p-value is only just below 0.05.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_4743"></div>
</form>
<script>function validate_form_4743() {var text; var x1 = document.getElementById('answer_4743_1'); var x2 = document.getElementById('answer_4743_2'); var x3 = document.getElementById('answer_4743_3'); var x4 = document.getElementById('answer_4743_4'); if (x1.checked == false&x2.checked == true&x3.checked == false&x4.checked == false){text = 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.';} else {text = 'No, that’s not the reason.';} document.getElementById('result_4743').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!'; res9 = document.getElementById('result_4743').innerText == 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_57394" onclick="return show_hint_57394()">🐭 Click on the mouse for a hint.</div>
<div id="result_57394" onclick="return show_hint_57394()"></div>
<script>function show_hint_57394(){var x = document.getElementById('result_57394').innerHTML; if(!x){document.getElementById('result_57394').innerHTML = 'Only one of these reasons is correct.';} else {document.getElementById('result_57394').innerHTML = '';}}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q12.10</strong></span> One way to reduce the number of levels in the <code>NativeLg</code> variable is to model <code>Vocab</code> scores based on L2 participants’ native language family, instead. Fit a model that attempts to predict <code>Vocab</code> scores among L2 participants based on the <code>NativeLgFamily</code> variable (the creation of this variable was a <span style="color:green;">Your turn!</span> task in <a href="9_DataWrangling.html#sec-casewhen" class="quarto-xref"><span>Section 9.6.4</span></a>). Based on your comparison of the two models, which of the following statements is/are true?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_73058" onsubmit="return validate_form_73058()" method="post">
<label>
<input type="checkbox" id="answer_73058_1" value="When adjusted for the number of predictors, the language family model is better at predicting Vocab scores.">
When adjusted for the number of predictors, the language family model is better at predicting Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_73058_2" value="When adjusted for the number of predictors, the language family model is worse at predicting Vocab scores.">
When adjusted for the number of predictors, the language family model is worse at predicting Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_73058_3" value="The more predictors there are, the easier it is to predict the Vocab scores of the sample. This is why the language family model has a lower multiple R-squared coefficient.">
The more predictors there are, the easier it is to predict the Vocab scores of the sample. This is why the language family model has a lower multiple R-squared coefficient.
</label>
<br>
<label>
<input type="checkbox" id="answer_73058_4" value="The language family model is statistically less significant than the other model because it features fewer predictors.">
The language family model is statistically less significant than the other model because it features fewer predictors.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_73058"></div>
</form>
<script>function validate_form_73058() {var text; var x1 = document.getElementById('answer_73058_1'); var x2 = document.getElementById('answer_73058_2'); var x3 = document.getElementById('answer_73058_3'); var x4 = document.getElementById('answer_73058_4'); if (x1.checked == false&x2.checked == true&x3.checked == false&x4.checked == false){text = 'Yes, well done!';} else {text = 'No, not quite.';} document.getElementById('result_73058').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!'; res9 = document.getElementById('result_4743').innerText == 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.'; res10 = document.getElementById('result_73058').innerText == 'Yes, well done!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to answer Q.12.10</summary>
<div class="sourceCode cell-code" id="cb65" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>taskmodel4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> NativeLgFamily,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> L2.data) </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.11</strong></span> According to your <code>NativeLgFamily</code> model, what is the predicted <code>Vocab</code> score of an L2 participant with a Baltic L1?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_74201" onsubmit="return validate_form_74201()" method="post">
<label>
<input type="radio" name="answer_74201" id="answer_74201_1" value="0.1133">
0.1133
</label>
<br>
<label>
<input type="radio" name="answer_74201" id="answer_74201_2" value="9.497">
9.497
</label>
<br>
<label>
<input type="radio" name="answer_74201" id="answer_74201_3" value="7.768">
7.768
</label>
<br>
<label>
<input type="radio" name="answer_74201" id="answer_74201_4" value="73.778">
73.778
</label>
<br>
<label>
<input type="radio" name="answer_74201" id="answer_74201_5" value="-23.749">
-23.749
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_74201"></div>
</form>
<script>function validate_form_74201() {var x, text; var x = document.forms['form_74201']['answer_74201'].value;if (x == '73.778'){text = 'Absolutely!';} else {text = 'No, check the hint if you can’t find the right coefficient.';} document.getElementById('result_74201').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!'; res9 = document.getElementById('result_4743').innerText == 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.'; res10 = document.getElementById('result_73058').innerText == 'Yes, well done!'; res11 = document.getElementById('result_74201').innerText == 'Absolutely!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_89879" onclick="return show_hint_89879()">🐭 Click on the mouse for a hint.</div>
<div id="result_89879" onclick="return show_hint_89879()"></div>
<script>function show_hint_89879(){var x = document.getElementById('result_89879').innerHTML; if(!x){document.getElementById('result_89879').innerHTML = 'The Baltic language family is the first and, therefore reference, level in the variable <code>NativeLgFamily</code>.';} else {document.getElementById('result_89879').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.11</summary>
<div class="sourceCode cell-code" id="cb66" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Baltic language family is the first level in this categorical predictor (because we haven't changed the order which, by default, is alphabetical):</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(L2.data<span class="sc">$</span>NativeLgFamily)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The Intercept coefficient corresponds to an L2 participant with a Baltic native language:</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.12</strong></span> According to your <code>NativeLgFamily</code> model, what is the predicted <code>Vocab</code> score of an L2 participant with a Slavic L1?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_93346" onsubmit="return validate_form_93346()" method="post">
<label>
<input type="radio" name="answer_93346" id="answer_93346_1" value="73.778">
73.778
</label>
<br>
<label>
<input type="radio" name="answer_93346" id="answer_93346_2" value="-23.749">
-23.749
</label>
<br>
<label>
<input type="radio" name="answer_93346" id="answer_93346_3" value="23.749">
23.749
</label>
<br>
<label>
<input type="radio" name="answer_93346" id="answer_93346_4" value="50.029">
50.029
</label>
<br>
<label>
<input type="radio" name="answer_93346" id="answer_93346_5" value="10.088">
10.088
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_93346"></div>
</form>
<script>function validate_form_93346() {var x, text; var x = document.forms['form_93346']['answer_93346'].value;if (x == '50.029'){text = '✅ Absolutely!';} else {text = 'No, check the hint if you’re not sure how to proceed.';} document.getElementById('result_93346').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!'; res9 = document.getElementById('result_4743').innerText == 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.'; res10 = document.getElementById('result_73058').innerText == 'Yes, well done!'; res11 = document.getElementById('result_74201').innerText == 'Absolutely!'; res12 = document.getElementById('result_93346').innerText == '✅ Absolutely!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_93915" onclick="return show_hint_93915()">🐭 Click on the mouse for a hint.</div>
<div id="result_93915" onclick="return show_hint_93915()"></div>
<script>function show_hint_93915(){var x = document.getElementById('result_93915').innerHTML; if(!x){document.getElementById('result_93915').innerHTML = 'Remember that, to find the predicted score for Slavic L1 speakers, you need to add the Slavic L1 coefficient to the Intercept coefficient. Alternatively, you can plot the predicted values and read the prediction off the graph.';} else {document.getElementById('result_93915').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.12</summary>
<div class="sourceCode cell-code" id="cb67" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Numeric approach</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(taskmodel4)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fl">73.778</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">23.749</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Graphical approach</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(taskmodel4, <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Participants' L1 language family"</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co"># The predicted value for the Slavic L1 speakers is visualised by the last blue line.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q12.13</strong></span> According to the <code>NativeLgFamily</code> model, Hellenic L1 speakers are predicted to perform considerably better than the reference level of Baltic L1 speakers. However, the <em>p</em>-value associated with this coefficient estimate is very large (<code>0.4591</code>). Why is that?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_13651" onsubmit="return validate_form_13651()" method="post">
<label>
<input type="radio" name="answer_13651" id="answer_13651_1" value="Because the model chose a particularly low α-level.">
Because the model chose a particularly low α-level.
</label>
<br>
<label>
<input type="radio" name="answer_13651" id="answer_13651_2" value="Because the data for Hellenic speakers is less reliable than for the other L2 speakers.">
Because the data for Hellenic speakers is less reliable than for the other L2 speakers.
</label>
<br>
<label>
<input type="radio" name="answer_13651" id="answer_13651_3" value="Because p-values have nothing to do with effect sizes.">
Because p-values have nothing to do with effect sizes.
</label>
<br>
<label>
<input type="radio" name="answer_13651" id="answer_13651_4" value="Because the dataset only includes one Greek L1 speaker.">
Because the dataset only includes one Greek L1 speaker.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_13651"></div>
</form>
<script>function validate_form_13651() {var x, text; var x = document.forms['form_13651']['answer_13651'].value;if (x == 'Because the dataset only includes one Greek L1 speaker.'){text = 'Absolutely!';} else {text = 'No, check the hints if you’re not sure how to proceed. And remember that, if in doubt, visualisation is always a good idea!';} document.getElementById('result_13651').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13;res1 = document.getElementById('result_53559').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_35078').innerText == 'Awesome! Note that we also use the predict() function to extract the model’s predicted value for any combination of predictor values, e.g. predict(taskmodel1, data.frame(Blocks = 20))'; res3 = document.getElementById('result_20558').innerText == 'That’s right, well done!'; res4 = document.getElementById('result_68806').innerText == 'Indeed!'; res5 = document.getElementById('result_71636').innerText == 'Well done!'; res6 = document.getElementById('result_156').innerText == 'That’s right!'; res7 = document.getElementById('result_63340').innerText == 'You’re right. This statement is completely wrong: the model’s R-squared coefficients tell us how much of the variance in Vocab scores our model accounts for. The values of the multiple R-squared are always between 0 and 1: a value of 0 means that the model cannot predict anything using these predictors. A value of 1 means that it can make perfect predictions. Here, the multiple R-squared coefficient is almost 0 (0.0000187). In this model, the multiple R-squared coefficient is so low that, once adjusted, it falls slightly below zero. The adjustment made is based on the number of predictors (or, in the case of categorical predictors, the number of levels in each predictor) that are entered into the model.'; res8 = document.getElementById('result_1488').innerText == 'That’s right!'; res9 = document.getElementById('result_4743').innerText == 'That’s right, given that the dataset only includes 67 L2 participants, 10 different native languages is a lot! There is a strong risk that the model may overfit the data. The adjusted R-squared coefficient accounts for this by drastically reducing its estimation of the amount of variance in Vocab scores that can genuinely be accounted for by a model that only includes participants’ native language.'; res10 = document.getElementById('result_73058').innerText == 'Yes, well done!'; res11 = document.getElementById('result_74201').innerText == 'Absolutely!'; res12 = document.getElementById('result_93346').innerText == '✅ Absolutely!'; res13 = document.getElementById('result_13651').innerText == 'Absolutely!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_78778" onmouseover="return show_hint_78778()">🦉 Hover over the owl for a first hint.</div>
<div id="result_78778" onmouseover="return show_hint_78778()"></div>
<script>function show_hint_78778(){var x = document.getElementById('result_78778').innerHTML; if(!x){document.getElementById('result_78778').innerHTML = 'It is never the model that chooses the α-level, but rather us, the researchers.';} else {document.getElementById('result_78778').innerHTML = '';}}</script>
</div>
<div class="cell-output-display">
<div id="hint_92916" onclick="return show_hint_92916()">🐭 Click on the mouse for a second hint.</div>
<div id="result_92916" onclick="return show_hint_92916()"></div>
<script>function show_hint_92916(){var x = document.getElementById('result_92916').innerHTML; if(!x){document.getElementById('result_92916').innerHTML = 'Remember that p-values depend on three different factors, see Section 11.3';} else {document.getElementById('result_92916').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q12.13</summary>
<div class="sourceCode cell-code" id="cb68" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The plot of predicted values (see code below) shows that the coefficient estimate for Hellenic speakers is based on only one data point (as is also the case for Germanic speakers).</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(taskmodel4, <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Participants' L1 language family"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We can check the distribution of native language family using the `table()`, `summary()` or `count()` functions:</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(L2.data<span class="sc">$</span>NativeLgFamily)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L2.data<span class="sc">$</span>NativeLgFamily)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>L2.data <span class="sc">|&gt;</span> </span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(NativeLgFamily)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</section>
<section id="sec-AssumptionsLR" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="sec-AssumptionsLR"><span class="header-section-number">12.4</span> Regression assumptions</h2>
<p>Similar to the statistical tests that we conducted in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>, linear regression also has a number of assumptions that should be met if we want to obtain reliable results that we can trust. It is therefore very important that we check that these assumptions are met.</p>
<section id="sec-IndependenceSLR" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="sec-IndependenceSLR"><span class="header-section-number">12.4.1</span> Assumption 1: Independence</h3>
<p>This is the same assumption as for the statistical tests that we covered in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a> (see <a href="11_Inferential.html#sec-Independence" class="quarto-xref"><span>Section 11.6.2</span></a>). It means that each observation in our dataset should be unrelated to every other observation. In other words, knowing the value of one data point shouldn’t give us any information about any other data point in our dataset. This assumption is critical because violations can lead to unjustifiably low <em>p</em>-values and narrower confidence intervals.</p>
<p>Independence violations arise from the way data were collected. For example, if we test the same person several times, their test results are likely to be more similar to each other than to the results of other participants. Similarly, if we collect data over time, today’s measurement might be influenced by yesterday’s value. When pupils are sampled from different schools, pupils within the same school or class might be more similar to each other than to pupils from other schools and/or classes.</p>
<p>If our data do not meet the assumption of independence, we need to use a different analysis method that can account for the fact that our data points are related to each other. In the language sciences, this is most commonly achieved using <strong>mixed-effects models</strong>. In this textbook, however, we only cover <strong>fixed-effects</strong> <strong>models</strong> for which the assumption of independence must be held.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Further reading 📚
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Here are some great starting points (in alphabetical order) to learn about mixed-effects models for linguistics research and how to fit them in <code>R</code>:</p>
<ul>
<li><span class="citation" data-cites="griesStatisticsLinguisticsPractical2021">Gries (<a href="99_references.html#ref-griesStatisticsLinguisticsPractical2021" role="doc-biblioref">2021</a>)</span>: Chapter 6</li>
<li><span class="citation" data-cites="LevshinaHowlinguisticsData2015">Levshina (<a href="99_references.html#ref-LevshinaHowlinguisticsData2015" role="doc-biblioref">2015</a>)</span>: Chapter 8</li>
<li><span class="citation" data-cites="WinterStatisticsLinguistsIntroduction2019">Winter (<a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">2019</a>)</span>: Chapters 14-15</li>
</ul>
</div>
</div>
</div>
</section>
<section id="sec-LinearitySLR" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="sec-LinearitySLR"><span class="header-section-number">12.4.2</span> Assumption 2: Linearity</h3>
<p>The linearity assumption requires that the relationship between the numeric predictor variables entered into a model and the outcome variable follows a straight (i.e.&nbsp;linear) line rather than a curved one. This assumption is fundamental because linear regression, as the name suggests, can only ever fit a straight line through the data. If the true relationship between our predictors is curved, forcing a straight line through the data will lead to poor predictions and misleading conclusions.</p>
<p>To check this assumption, it is best to plot the predictor variable against the outcome variable in the form of a scatter plot (see <a href="#fig-RTScatterPLot" class="quarto-xref">Figure&nbsp;<span>12.1</span></a>). When examining such plots, we are looking for rough straight-line patterns. We are not expecting all the same data points to fall on the linear regression line (that would be entirely unrealistic with real data). However, the points should be scattered around an imaginary straight line without showing any obvious curved patterns.</p>
<p>In <a href="#fig-Nonlinear" class="quarto-xref">Figure&nbsp;<span>12.10</span></a>, by contrast, the data points follow a curved pattern. The regression line is forced to be straight, creating systematic prediction errors. Such a pattern of errors indicates that the assumption of linearity is violated.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-Nonlinear" class="quarto-float quarto-figure quarto-figure-center anchored" width="576">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-Nonlinear-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;12.10: "><img src="12_SimpleLinearRegression_files/figure-html/fig-Nonlinear-1.png" id="fig-Nonlinear" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-Nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.10
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-Residuals" class="level3" data-number="12.4.3">
<h3 data-number="12.4.3" class="anchored" data-anchor-id="sec-Residuals"><span class="header-section-number">12.4.3</span> Assumption 3: Homogeneity of residuals</h3>
<p>Linear regression models assume homogeneity — or constant variance — of the residuals (see <a href="11_Inferential.html#sec-Homoscedasticity" class="quarto-xref"><span>Section 11.6.5</span></a>). This assumption is best checked by visually examining the model residuals. In <a href="#fig-VocabResidual" class="quarto-xref">Figure&nbsp;<span>12.11</span></a>, we plot the residuals of <code>model1</code> and check that their variability does not systematically increase or decrease as the outcome variable increases or decreases.</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb69" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame containing the model's residuals and predictions:</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>residual_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fitted_values =</span> <span class="fu">fitted</span>(model1),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">residuals</span>(model1)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot of fitted values vs. residuals:</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residual_data, </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fitted_values, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Vocab scores (fitted values)"</span>, </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Model residuals"</span>) <span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-VocabResidual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VocabResidual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-VocabResidual-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;12.11: Comparison of model residuals with predicted vocabulary scores"><img src="12_SimpleLinearRegression_files/figure-html/fig-VocabResidual-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VocabResidual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.11: Comparison of model residuals with predicted vocabulary scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-VocabResidual" class="quarto-xref">Figure&nbsp;<span>12.11</span></a>, we can see that the residuals are not randomly spread across both sides of the blue line, but rather that they form a funnel-like shape: the spread of residuals tends to be larger for low predicted <code>Vocab</code> scores and becomes progressively smaller for higher predicted scores. This pattern indicates that our model is more accurate when it comes to predicting high <code>Vocab</code> scores than lower ones. This constitutes a violation of the assumption of equal variance or homoscedasticity.</p>
</section>
<section id="sec-NormalityResiduals" class="level3" data-number="12.4.4">
<h3 data-number="12.4.4" class="anchored" data-anchor-id="sec-NormalityResiduals"><span class="header-section-number">12.4.4</span> Assumption 4: Normality of residuals</h3>
<p>Ideally, model residuals also ought to be normally distributed, with a mean of zero. However, this assumption becomes less important as the sample size increases <span class="citation" data-cites="williamsAssumptionsMultipleRegression2013">(<a href="99_references.html#ref-williamsAssumptionsMultipleRegression2013" role="doc-biblioref">Williams, Grajales &amp; Kurkiewicz 2013</a>: 10)</span>. Again, it is best to check the distribution of residuals visually. As shown in <a href="#fig-VocabResidualDensity" class="quarto-xref">Figure&nbsp;<span>12.12</span></a>, the residuals of <code>model1</code> are fairly normally distributed.</p>
<div class="cell">
<details class="code-fold">
<summary>See code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb70" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residual_data, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"purple"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-VocabResidualDensity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VocabResidualDensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="12_SimpleLinearRegression_files/figure-html/fig-VocabResidualDensity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12.12: Distribution of model residuals"><img src="12_SimpleLinearRegression_files/figure-html/fig-VocabResidualDensity-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VocabResidualDensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.12: Distribution of model residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-VocabResidualDensity" class="quarto-xref">Figure&nbsp;<span>12.12</span></a> shows that the distribution of the residuals of <code>model1</code> are slightly left-skewed, but that the distribution is more or less centered around zero. Indeed, the model’s mean residual is almost exactly zero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-57.7253 -10.7158   0.5255   0.0000  12.4168  36.0334 </code></pre>
</div>
</div>
<p>When the sample size is small and the model residuals are not normally distributed, the inferences that we can draw from the model are less trustworthy. However, with larger sample sizes, regression is relatively robust to the assumption of normally distributed residuals <span class="citation" data-cites="williamsAssumptionsMultipleRegression2013">(<a href="99_references.html#ref-williamsAssumptionsMultipleRegression2013" role="doc-biblioref">Williams, Grajales &amp; Kurkiewicz 2013</a>: 3)</span>.</p>
</section>
</section>
<section id="intermediary-summary" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="intermediary-summary"><span class="header-section-number">12.5</span> Intermediary summary</h2>
<p>In this chapter, we fitted simple linear regression models. These models demonstrate that we can – to a greater or lesser degree – predict (or <strong>model</strong>) participants’ receptive vocabulary knowledge test scores on the basis of a single predictor such as the number of years that they spent in formal education or their occupational group.</p>
<p>We have referred to the variable that we are trying to predict as the outcome variable. It is worth knowing that it is sometimes also called the <strong>dependent variable</strong> because we are attempting to model its ‘dependence’ on one or more <strong>independent variables</strong> (which we have called predictors). In <a href="13_MultipleLinearRegression.html" class="quarto-xref"><span>Chapter 13</span></a>, we will continue to use the terminology of <strong>outcome</strong> and <strong>predictor</strong> variables, but you should be aware that some textbooks and researchers will speak of dependent and independent variables, instead.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>While our simple linear regression models did allow us to account for some of the variance in participants’ <code>Vocab</code> test scores, like the statistical tests that we conducted in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>, they still only allow us to capture one aspect of receptive vocabulary knowledge at a time. What we really want to do is to be able to enter several predictor variables into a single model. For example, it would be interesting to know whether the number of years spent in formal education remains a significant predictor of <code>Vocab</code> scores when controlling for participants’ occupational groups. This can be achieved with multiple linear regression, and that’s coming up in the next chapter!</p>
<section id="check-your-progress" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="check-your-progress">Check your progress 🌟</h3>
<p>Well done! You have successfully completed this chapter introducing the linear regression modelling. You have answered <span style="color:green;"><span id="checkdown_final_score">0</span> out of 13 questions</span> correctly.</p>
<p>Are you confident that you can…?</p>
<ul class="task-list">
<li><label><input type="checkbox">Fit a simple linear model to predict a numeric outcome variable</label></li>
<li><label><input type="checkbox">Visualise the predictions of a simple linear regression model</label></li>
<li><label><input type="checkbox">Find out what the intercept of a model corresponds to and interpret the model’s coefficient estimates</label></li>
<li><label><input type="checkbox">Interpret a model’s adjusted R<sup>2</sup> coefficient</label></li>
<li><label><input type="checkbox">Check for the main assumptions of linear regression: independence, linearity, homoscedasticity, and normality of residuals (<a href="#sec-AssumptionsLR" class="quarto-xref"><span>Section 12.4</span></a>)</label></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-brehenyVisualizationRegressionModels2017" class="csl-entry" role="listitem">
Breheny, Patrick &amp; Woodrow Burchett. 2017. Visualization of Regression Models Using visreg. <em>The R Journal</em> 9(2). 56. <a href="https://doi.org/10.32614/RJ-2017-046">https://doi.org/10.32614/RJ-2017-046</a>.
</div>
<div id="ref-DabrowskaExperienceAptitudeIndividual2019" class="csl-entry" role="listitem">
Dąbrowska, Ewa. 2019. Experience, aptitude, and individual differences in linguistic attainment: A comparison of native and nonnative speakers. <em>Language Learning</em> 69(S1). 72–100. <a href="https://doi.org/10.1111/lang.12323">https://doi.org/10.1111/lang.12323</a>.
</div>
<div id="ref-griesStatisticsLinguisticsPractical2021" class="csl-entry" role="listitem">
Gries, Stefan Thomas. 2021. <em>Statistics for linguistics with r: A practical introduction</em> (De Gruyter Mouton Textbook). 3rd revised edition. de Gruyter Mouton.
</div>
<div id="ref-kaufmanIllusionCausalityCognitive2018" class="csl-entry" role="listitem">
Kaufman, Allison B. &amp; James C. Kaufman (eds.). 2018. The illusion of causality: A cognitive bias underlying pseudoscience. In <em>Pseudoscience</em>. The MIT Press. <a href="https://doi.org/10.7551/mitpress/10747.003.0007">https://doi.org/10.7551/mitpress/10747.003.0007</a>.
</div>
<div id="ref-lenthEmmeansEstimatedMarginal2025a" class="csl-entry" role="listitem">
Lenth, Russell V. 2025. <em>Emmeans: Estimated marginal means, aka least-squares means</em>. <a href="https://rvlenth.github.io/emmeans/">https://rvlenth.github.io/emmeans/</a>.
</div>
<div id="ref-LevshinaHowlinguisticsData2015" class="csl-entry" role="listitem">
Levshina, Natalia. 2015. <em>How to do linguistics with r: Data exploration and statistical analysis</em>. John Benjamins.
</div>
<div id="ref-matuteIllusionsCausalityHow2015" class="csl-entry" role="listitem">
Matute, Helena, Fernando Blanco, Ion Yarritu, Marcos Díaz-Lago, Miguel A. Vadillo &amp; Itxaso Barberia. 2015. Illusions of causality: How they bias our everyday thinking and how they could be reduced. <em>Frontiers in Psychology</em>. Frontiers 6. <a href="https://doi.org/10.3389/fpsyg.2015.00888">https://doi.org/10.3389/fpsyg.2015.00888</a>.
</div>
<div id="ref-williamsAssumptionsMultipleRegression2013" class="csl-entry" role="listitem">
Williams, Matt N., Carlos Alberto Gómez Grajales &amp; Dason Kurkiewicz. 2013. Assumptions of multiple regression: Correcting two misconceptions. <em>Practical Assessment, Research, and Evaluation</em> 18(11).
</div>
<div id="ref-WinterStatisticsLinguistsIntroduction2019" class="csl-entry" role="listitem">
Winter, Bodo. 2019. <em>Statistics for linguists: An introduction using <span>R</span></em>. Routledge. <a href="https://doi.org/10.4324/9781315165547">https://doi.org/10.4324/9781315165547</a>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This choice of terminology is largely a personal one but, in my experience, learners find this terminology less confusing as it is immediately obvious what is being predicted (the outcome or dependent variable) and what is used to make the prediction (the predictors or the independent variables). Another advantage is that the term predictor can be used by itself (i.e., without the word “variable”), which is handy because when we enter a categorical variable into a model, there are as many predictors as there are variable levels.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    window.setColorSchemeToggle(window.hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/RstatsTexbook\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./11_Inferential.html" class="pagination-link" aria-label="Infe`R`ential statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Infe<code>R</code>ential statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13_MultipleLinearRegression.html" class="pagination-link" aria-label="Multiple linear reg`R`ession modelling">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple linear reg<code>R</code>ession modelling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p>Data Analysis for the Language Sciences</p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA</a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>