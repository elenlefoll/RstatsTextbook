<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elen Le Foll">

<title>13&nbsp; Multiple linear regRession modelling – Data Analysis for the Language Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14_LiterateProgramming.html" rel="next">
<link href="./12_SimpleLinearRegression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-53f539a478d6ecd1be31ce9fd30fd81c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-3e3370d44295d9fa30cc16d77ad785c2.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-53f539a478d6ecd1be31ce9fd30fd81c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-db8da973c8974479654007bb7dceba98.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-540c66f2be59a33d43b8e94dc657d4ab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-db8da973c8974479654007bb7dceba98.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<style>
.cell-output-stdout code {
  word-break: break-wor !important;
  white-space: pre-wrap !important;
}
</style>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    window.setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      window.setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    window.hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(darkModeDefault) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const darkModeDefault = false;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !window.hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (window.hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13_MultipleLinearRegression.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple linear reg<code>R</code>ession modelling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis for the<br>Language Sciences</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="mailto:elefoll@uni-koeln.de" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://github.com/elenlefoll/RstatsTextbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_OpenScholarship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Open Scholarship</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data files and formats</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_DataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data management</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_InstallingR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Installing <code>R</code> and RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_GettingStaRted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting sta<code>R</code>ted in <code>R</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_ImpoRtingData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Impo<code>R</code>ting data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_VariablesFunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Va<code>R</code>iables and functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_DescriptiveStats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Desc<code>R</code>iptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_DataWrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data w<code>R</code>angling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Gramma<code>R</code> of Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Inferential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Infe<code>R</code>ential statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_SimpleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Int<code>R</code>oduction to statistical modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_MultipleLinearRegression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple linear reg<code>R</code>ession modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_LiterateProgramming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rep<code>R</code>oducible research and academic w<code>R</code>iting in Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_PartingWords.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Resea<code>R</code>ching with AI?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A_FurtherResources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Next-step resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Case studies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Poppy/ThrowVerbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">‘Throw’ verbs in Spanish: Rep<code>R</code>oducing the results of a corpus linguistics study</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Rose-Gina/Emojis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The semantics of emojis: Explo<code>R</code>ing the results of an experimental study</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CaseStudies/Dela/Perdon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">The g<code>R</code>ammaticalization of ‘perdón’ in Spanish varieties</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter overview</a></li>
  <li><a href="#from-simple-to-multiple-linear-regression-models" id="toc-from-simple-to-multiple-linear-regression-models" class="nav-link" data-scroll-target="#from-simple-to-multiple-linear-regression-models"><span class="header-section-number">13.1</span> From simple to multiple linear regression models</a></li>
  <li><a href="#sec-MultipleLM" id="toc-sec-MultipleLM" class="nav-link" data-scroll-target="#sec-MultipleLM"><span class="header-section-number">13.2</span> Combining multiple predictors</a></li>
  <li><a href="#centering-numeric-predictors" id="toc-centering-numeric-predictors" class="nav-link" data-scroll-target="#centering-numeric-predictors"><span class="header-section-number">13.3</span> Centering numeric predictors</a></li>
  <li><a href="#interpreting-a-model-summary" id="toc-interpreting-a-model-summary" class="nav-link" data-scroll-target="#interpreting-a-model-summary"><span class="header-section-number">13.4</span> Interpreting a model summary</a>
  <ul class="collapse">
  <li><a href="#sec-ModelPredictions" id="toc-sec-ModelPredictions" class="nav-link" data-scroll-target="#sec-ModelPredictions"><span class="header-section-number">13.4.1</span> Interpreting model predictions</a></li>
  </ul></li>
  <li><a href="#relative-importance-of-predictors" id="toc-relative-importance-of-predictors" class="nav-link" data-scroll-target="#relative-importance-of-predictors"><span class="header-section-number">13.5</span> Relative importance of predictors</a></li>
  <li><a href="#modelling-interactions-between-predictors" id="toc-modelling-interactions-between-predictors" class="nav-link" data-scroll-target="#modelling-interactions-between-predictors"><span class="header-section-number">13.6</span> Modelling interactions between predictors</a>
  <ul class="collapse">
  <li><a href="#interactions-between-two-numeric-predictors" id="toc-interactions-between-two-numeric-predictors" class="nav-link" data-scroll-target="#interactions-between-two-numeric-predictors"><span class="header-section-number">13.6.1</span> Interactions between two numeric predictors</a></li>
  </ul></li>
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection"><span class="header-section-number">13.7</span> Model selection</a></li>
  <li><a href="#sec-ModelAssumptions" id="toc-sec-ModelAssumptions" class="nav-link" data-scroll-target="#sec-ModelAssumptions"><span class="header-section-number">13.8</span> Checking model assumptions</a></li>
  <li><a href="#tapping-into-the-potential-of-statistical-modelling" id="toc-tapping-into-the-potential-of-statistical-modelling" class="nav-link" data-scroll-target="#tapping-into-the-potential-of-statistical-modelling"><span class="header-section-number">13.9</span> Tapping into the potential of statistical modelling</a>
  <ul class="collapse">
  <li><a href="#check-your-progress" id="toc-check-your-progress" class="nav-link" data-scroll-target="#check-your-progress">Check your progress 🌟</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-MLR" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple linear reg<code>R</code>ession modelling</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>As with the rest of this textbook (see <a href="https://elenlefoll.github.io/RstatsTextbook/">Preface</a>), this chapter is very much <strong>work in progress</strong>. Feedback is very welcome.</p>
</div>
</div>
<section id="chapter-overview" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="chapter-overview">Chapter overview</h3>
<p>In this chapter, you will learn how to:</p>
<ul>
<li>Fit a linear regression model with multiple predictors</li>
<li>Center numeric predictor variables when meaningful</li>
<li>Interpret the coefficient estimates of a multiple linear regression model</li>
<li>Interpret a model’s coefficients of determination (multiple R<sup>2</sup> and adjusted R<sup>2</sup>)</li>
<li>Compute and plot the relative importance of predictors</li>
<li>Fit interaction effects and interpret their coefficient estimates</li>
<li>Visualise the predictions of a multiple linear regression model and its (partial) residuals</li>
<li>Report the results of a multiple linear regression model in tabular and graphical formats</li>
<li>Check that the assumptions of multiple linear regression models are met.</li>
</ul>
</section>
<section id="from-simple-to-multiple-linear-regression-models" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="from-simple-to-multiple-linear-regression-models"><span class="header-section-number">13.1</span> From simple to multiple linear regression models</h2>
<p>In <a href="12_SimpleLinearRegression.html" class="quarto-xref"><span>Chapter 12</span></a>, we used the <code>lm()</code> function to fit simple linear regression models. We saw that, like the <code>t.test()</code> and the <code>cor.test()</code> functions, the <code>lm()</code> function takes a formula as its first argument. Schematically, the formula syntax for a simple linear regression model takes the form of:</p>
<pre data-code-line-numbers=""><code>outcome.variable ~ predictor</code></pre>
<p>In the second half of this chapter, we will continue to try to predict (i.e., try to better understand) <code>Vocab</code> scores among L1 and L2 English speakers, but this time, we will do so with <em>multiple</em> predictors. To this end, we will use the <code>+</code> operator to add predictors to our model formula like this:</p>
<pre data-code-line-numbers=""><code>outcome.variable ~ predictor1 + predictor2 + predictor3</code></pre>
<p>A linear regression model can include as many predictors as we like – or rather, as is meaningful and we have data for! The predictors can be a mixture of numeric and categorical predictors. Multiple linear regression modelling is much more powerful than conducting individual statistical tests (as in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>) or several simple linear regression models (as in <a href="12_SimpleLinearRegression.html" class="quarto-xref"><span>Chapter 12</span></a>) because it enables us to quantify the strength of the association between an outcome variable and a predictor, while <strong>controlling for the other predictors</strong> – in other words, while holding all the other predictors constant. Moreover, it also reduces the risk of reporting false positive results (i.e.&nbsp;Type 1 error, see <a href="11_Inferential.html#sec-pHacking" class="quarto-xref"><span>Section 11.7</span></a>). In this chapter, we will see that we can learn much more about our data from a single multiple linear regression model than from a series of individual statistical tests or simple regression models.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisites
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>As with previous chapters, all the examples, tasks, and quiz questions from this chapter are based on data from:</p>
<blockquote class="blockquote">
<p>Dąbrowska, Ewa. 2019. Experience, Aptitude, and Individual Differences in Linguistic Attainment: A Comparison of Native and Nonnative Speakers. Language Learning 69(S1). 72–100. <a href="https://doi.org/10.1111/lang.12323" class="uri">https://doi.org/10.1111/lang.12323</a>.</p>
</blockquote>
<p>Our starting point for this chapter is the wrangled combined dataset that we created and saved in <a href="9_DataWrangling.html" class="quarto-xref"><span>Chapter 9</span></a>. Follow the instructions in <a href="9_DataWrangling.html#sec-filter" class="quarto-xref"><span>Section 9.8</span></a> to create this <code>R</code> object.</p>
<p>Alternatively, you can download <code>Dabrowska2019.zip</code> from <a href="https://github.com/elenlefoll/RstatsTextbook/blob/main/Dabrowska2019.zip" class="uri">the textbook’s GitHub repository</a>. To launch the project correctly, unzip the file and then double-click on the <code>Dabrowska2019.Rproj</code> file.</p>
<p>To begin, load the <code>combined_L1_L2_data.rds</code> file that we created in <a href="9_DataWrangling.html" class="quarto-xref"><span>Chapter 9</span></a>. This file contains the full data of all the L1 and L2 participants from <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span>. The categorical variables are stored as factors, and obvious data entry inconsistencies and typos have been corrected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"combined_L1_L2_data.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before you get started, check that you have correctly imported the data by examining the output of <code>View(Dabrowska.data)</code> and <code>str(Dabrowska.data)</code>. In addition, run the following lines of code to load the {tidyverse} and create “clean” versions of both the L1 and L2 datasets as separate <code>R</code> objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>L1.data <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">"L1"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>L2.data <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">"L2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you are satisfied that the data have been correctly imported and that you are familiar with the dataset, you are ready to tap into the potential of multiple linear regression modelling! 🚀</p>
</div>
</div>
</div>
</section>
<section id="sec-MultipleLM" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sec-MultipleLM"><span class="header-section-number">13.2</span> Combining multiple predictors</h2>
<p>In the following, we will attempt to model the variability in the receptive English vocabulary test scores of L1 and L2 English participants from <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span>. To this end, we will use multiple numeric and categorical predictors:</p>
<ol type="a">
<li>participants’ native-speaker status (<code>Group</code>)</li>
<li>their <code>Age</code>,</li>
<li>their occupational group (<code>OccupGroup</code>),</li>
<li>their <code>Gender</code></li>
<li>their non-verbal IQ test score (<code>Blocks</code>), and</li>
<li>the number of years they were in formal education (<code>EduTotal</code>).</li>
</ol>
<p>We use the <code>+</code> operator to construct the model formula. It doesn’t matter in which order we list the predictors, as the model will consider them all simultaneously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks <span class="sc">+</span> EduTotal, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then examine the model summary just like we did in <a href="12_SimpleLinearRegression.html" class="quarto-xref"><span>Chapter 12</span></a> using the <code>summary()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ Group + Age + OccupGroup + Gender + Blocks + 
    EduTotal, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-62.825 -10.838   1.831  12.185  38.345 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.2113    10.7831   0.391 0.696691    
GroupL2      -22.2896     3.4854  -6.395 1.98e-09 ***
Age            0.3718     0.1401   2.654 0.008812 ** 
OccupGroupI    9.9519     5.5999   1.777 0.077600 .  
OccupGroupM   -3.9993     4.5139  -0.886 0.377050    
OccupGroupPS  -1.0629     4.3876  -0.242 0.808919    
GenderM       -3.7177     3.1387  -1.184 0.238131    
Blocks         1.3011     0.3218   4.043 8.44e-05 ***
EduTotal       2.4308     0.6293   3.863 0.000167 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.65 on 148 degrees of freedom
Multiple R-squared:  0.3621,    Adjusted R-squared:  0.3276 
F-statistic:  10.5 on 8 and 148 DF,  p-value: 1.327e-11</code></pre>
</div>
</div>
<p>As with the simple linear regression models, we begin our interpretation of the model summary with the coefficient estimate for the <strong>intercept</strong> (see <a href="12_SimpleLinearRegression.html#sec-Ttestsregression" class="quarto-xref"><span>Section 12.2</span></a>). The first question we ask ourselves is:</p>
<ul>
<li>In this model, what does the intercept correspond to?</li>
</ul>
<p>Remember that the reference levels of <strong>categorical predictors</strong> correspond to the <strong>first level</strong> of these variables. This is why, here, the coefficient estimate for the intercept corresponds to a female English native speaker with a clerical occupation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Dabrowska.data<span class="sc">$</span>Gender) <span class="co"># 'Female' is the first level.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "F" "M"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Dabrowska.data<span class="sc">$</span>Group) <span class="co"># 'L1' is the first level.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "L1" "L2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Dabrowska.data<span class="sc">$</span>OccupGroup) <span class="co"># 'C' corresponding to a clerical professional occupation is the first level.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "C"  "I"  "M"  "PS"</code></pre>
</div>
</div>
<p>The reference level of the <strong>numeric predictors</strong>, by contrast, corresponds to the value of&nbsp;<strong>zero</strong>. In <code>model4</code>, therefore, the estimated coefficient for the intercept corresponds to the predicted <code>Vocab</code> score of an adult English native speaker who belongs to the occupational group “C”, is female, who is aged 0 (!), scored 0 on the Blocks test, and spent 0 years (!) in formal education. Needless to say that trying to interpret this value is utterly meaningless! This is why, in this case, it makes sense to <strong>center</strong> our numeric predictor variables before entering them into our model. Another way to go about this would be to standardise the predictors using a <em>z</em>-transformation <span class="citation" data-cites="WinterStatisticsLinguistsIntroduction2019">(see e.g. <a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">Winter 2019</a>: Section 5.2)</span>.</p>
</section>
<section id="centering-numeric-predictors" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="centering-numeric-predictors"><span class="header-section-number">13.3</span> Centering numeric predictors</h2>
<p>Centering involves subtracting a variable’s average from each value in the variable. Typically, we subtract the mean from each value but, given that we know that many of the numeric variables in our dataset are not normally distributed (see <a href="8_DescriptiveStats.html#sec-DistributionsNumeric" class="quarto-xref"><span>Section 8.2.2</span></a>), here, we will subtract the median instead.</p>
<p>To this end, we use the <code>mutate()</code> function to add three columns to the <code>R</code> data object <code>Dabrowska.data</code>. These new columns contain <strong>transformed</strong> versions of the predictor variables that we previously entered into our model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="ot">&lt;-</span> Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_c =</span> Age <span class="sc">-</span> <span class="fu">median</span>(Age),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Blocks_c =</span> Blocks <span class="sc">-</span> <span class="fu">median</span>(Blocks),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">EduTotal_c =</span> EduTotal <span class="sc">-</span> <span class="fu">median</span>(EduTotal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have centred the values of the three numeric predictor variables so that a value of zero in the transformed version corresponds to the variable’s original median value (see <a href="#tbl-Untransformed" class="quarto-xref">Table&nbsp;<span>13.1</span></a>).</p>
<div class="cell">
<div id="tbl-Untransformed" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Untransformed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.1: Comparison of the original, untransformed variables with the new, centered ones in a random sample of observations from the data
</figcaption>
<div aria-describedby="tbl-Untransformed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Age</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Age_c</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Blocks</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Blocks_c</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EduTotal</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EduTotal_c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">21</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-10</td>
<td style="text-align: center; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">16</span></td>
<td style="text-align: center; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">0</span></td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">17</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">3</td>
</tr>
<tr class="even">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">27</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-4</td>
<td style="text-align: center; width: 16%;">21</td>
<td style="text-align: center; width: 16%;">5</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">18</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">25</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-6</td>
<td style="text-align: center; width: 16%;">21</td>
<td style="text-align: center; width: 16%;">5</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">18</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">4</td>
</tr>
<tr class="even">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">31</span></td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">0</span></td>
<td style="text-align: center; width: 16%;">8</td>
<td style="text-align: center; width: 16%;">-8</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">13</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">37</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">6</td>
<td style="text-align: center; width: 16%;">9</td>
<td style="text-align: center; width: 16%;">-7</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">12</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-2</td>
</tr>
<tr class="even">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">60</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">29</td>
<td style="text-align: center; width: 16%;">1</td>
<td style="text-align: center; width: 16%;">-15</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">10</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-4</td>
</tr>
<tr class="odd">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">20</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-11</td>
<td style="text-align: center; width: 16%;">17</td>
<td style="text-align: center; width: 16%;">1</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">12</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-2</td>
</tr>
<tr class="even">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">25</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-6</td>
<td style="text-align: center; width: 16%;">20</td>
<td style="text-align: center; width: 16%;">4</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">12</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">-2</td>
</tr>
<tr class="odd">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">62</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">31</td>
<td style="text-align: center; width: 16%;">8</td>
<td style="text-align: center; width: 16%;">-8</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">14</span></td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;"><span style=" font-weight: bold;    border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: pink !important;">0</span></td>
</tr>
<tr class="even">
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">42</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">11</td>
<td style="text-align: center; width: 16%;">21</td>
<td style="text-align: center; width: 16%;">5</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">15</td>
<td style="text-align: center; background-color: rgba(248, 248, 248, 255) !important; width: 16%;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>For each pair of variables, the value of&nbsp;0 in the centered variable corresponds to the median value of the untransformed variable. As a result, in the centered variables, each data point is expressed in terms of how much it is either above the median (positive score) or below the median (negative score).</p>
</section>
<section id="interpreting-a-model-summary" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="interpreting-a-model-summary"><span class="header-section-number">13.4</span> Interpreting a model summary</h2>
<p>We can now fit a new multiple linear regression model that attempts to predict <code>Vocab</code> scores with the same predictors as <code>model4</code> above, except that we are now entering the centered numeric predictor variables instead of the original untransformed ones. The categorical predictor variables remain the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model4_c <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + 
    EduTotal_c, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-62.825 -10.838   1.831  12.185  38.345 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   70.5852     3.7045  19.054  &lt; 2e-16 ***
GroupL2      -22.2896     3.4854  -6.395 1.98e-09 ***
Age_c          0.3718     0.1401   2.654 0.008812 ** 
OccupGroupI    9.9519     5.5999   1.777 0.077600 .  
OccupGroupM   -3.9993     4.5139  -0.886 0.377050    
OccupGroupPS  -1.0629     4.3876  -0.242 0.808919    
GenderM       -3.7177     3.1387  -1.184 0.238131    
Blocks_c       1.3011     0.3218   4.043 8.44e-05 ***
EduTotal_c     2.4308     0.6293   3.863 0.000167 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.65 on 148 degrees of freedom
Multiple R-squared:  0.3621,    Adjusted R-squared:  0.3276 
F-statistic:  10.5 on 8 and 148 DF,  p-value: 1.327e-11</code></pre>
</div>
</div>
<p>If you compare the summary of <code>model4</code> with that of <code>model4_c</code>, you will notice that, whilst the intercept coefficient estimate has changed, all the other coefficient estimates have stayed the same.</p>
<p>Let’s decipher the summary of <code>model4_c</code> step-by-step:</p>
<ul>
<li><p>In this model, the estimated coefficient for the <strong>intercept</strong> corresponds to the predicted <code>Vocab</code> score of an English native speaker (<code>Group</code>&nbsp;=&nbsp;L1) who is aged 31 (the median <code>Age</code>), belongs to the occupational group <code>C</code>, is female, scored 16 on the Blocks test (the median <code>Blocks</code> score), and was in formal education for 14 years (the median number of years).</p></li>
<li><p>As with the simple linear regression models that we computed in <a href="12_SimpleLinearRegression.html" class="quarto-xref"><span>Chapter 12</span></a>, the <strong>coefficient estimates of the numeric predictors</strong> (<code>Age_c</code>, <code>Blocks_c</code>, and <code>EduTotal_c</code>) correspond to increases or decreases in <code>Vocab</code> scores for each additional unit of that predictor variable, whilst keeping all other predictors at their reference level. Remember that, for numeric predictors, the reference level is 0, which, given that we have centered them, corresponds to the variable’s median value. Looking at the coefficient estimate for <code>Blocks_c</code> (<code>1.3011</code>), this means that someone who scored one point more than the median score in the Blocks test is predicted to have a <code>Vocab</code> test result that is <code>1.3011</code> points higher than the intercept, namely:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fl">70.5852</span> <span class="sc">+</span> <span class="fl">1.3011</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 71.8863</code></pre>
</div>
</div></li>
<li><p>To calculate the predicted <code>Vocab</code> score of an L1 female speaker in a clerical occupation, of median age, who spent the median number of years in formal education, but scored an impressive 26 points on the Blocks test, we multiply the estimated <code>Blocks_c</code> coefficient (<code>1.3011</code>) by 26 minus the median Blocks score (16) and add this to the intercept coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fl">70.5852</span> <span class="sc">+</span> <span class="fl">1.3011</span><span class="sc">*</span>(<span class="dv">26</span> <span class="sc">-</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Blocks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 83.5962</code></pre>
</div>
</div></li>
<li><p>You’ll be pleased to read that the interpretation of <strong>coefficient estimates of categorical predictors</strong> is less involved. Recall that, for categorical variables, the reference level is always the variable’s first level (see <a href="#sec-MultipleLM" class="quarto-xref"><span>Section 13.2</span></a>). If we want to make a prediction for an L2 instead of an L1 female speaker, but keep all other predictors at the reference level (i.e.&nbsp;clerical occupation, median age, median number of years in formal education, and median Blocks score), all we need to do is add the coefficient estimate for <code>GroupL2</code> (<code>-22.2896</code>) to the intercept coefficient. Given that this coefficient is negative, this addition will result in a predicted <code>Vocab</code> score that is lower than the model’s reference level:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fl">70.5852</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">22.2896</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 48.2956</code></pre>
</div>
</div></li>
<li><p>Since very few people are perfectly average, let us now calculate the predicted <code>Vocab</code> score of an actual person: the 154<sup>th</sup> participant in our dataset. As shown below using the {tidyverse} function <code>slice()</code>, the 154<sup>th</sup> participant is a 46-year-old Polish male driver who scored 23 points on the Blocks test and attended formal education for 10 years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">154</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Age, NativeLg, Occupation, OccupGroup, Gender, Blocks, EduTotal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  Group Age NativeLg Occupation OccupGroup Gender Blocks EduTotal
1    L2  46   Polish     Driver          M      M     23       10</code></pre>
</div>
</div>
<p>To obtain the model’s predicted <code>Vocab</code> score for a 46-year-old male L2 speaker with a manual occupation (<code>M</code>) who scored 23 points on the <code>Blocks</code> test and was in formal education for 10 years (<code>EduTotal</code>), we combine the coefficient estimates as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-61" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="1">1</button><span id="annotated-cell-61-1" class="code-annotation-target"><a href="#annotated-cell-61-1" aria-hidden="true" tabindex="-1"></a><span class="fl">70.5852</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="2">2</button><span id="annotated-cell-61-2" class="code-annotation-target"><a href="#annotated-cell-61-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">22.2896</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="3">3</button><span id="annotated-cell-61-3" class="code-annotation-target"><a href="#annotated-cell-61-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3718</span> <span class="sc">*</span> (<span class="dv">46</span> <span class="sc">-</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Age)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="4">4</button><span id="annotated-cell-61-4" class="code-annotation-target"><a href="#annotated-cell-61-4" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">3.9993</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="5">5</button><span id="annotated-cell-61-5" class="code-annotation-target"><a href="#annotated-cell-61-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">3.7177</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="6">6</button><span id="annotated-cell-61-6" class="code-annotation-target"><a href="#annotated-cell-61-6" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3011</span> <span class="sc">*</span> (<span class="dv">23</span> <span class="sc">-</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Blocks)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="7">7</button><span id="annotated-cell-61-7" class="code-annotation-target"><a href="#annotated-cell-61-7" aria-hidden="true" tabindex="-1"></a><span class="fl">2.4308</span> <span class="sc">*</span> (<span class="dv">10</span> <span class="sc">-</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>EduTotal))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-61" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="1" data-code-annotation="1">Intercept coefficient</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="2" data-code-annotation="2">L2 speaker</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="3" data-code-annotation="3">46 years old</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="4" data-code-annotation="4">Manual occupation (OccupGroupM)</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="5" data-code-annotation="5">Male</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="6" data-code-annotation="6">23 points on Blocks test</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="7" data-code-annotation="7">10 years in formal education</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 45.5401</code></pre>
</div>
</div>
<div class="content-visible callout callout-style-default callout-tip callout-titled" data-when-format="html">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can hover your mouse over the circled numbers to find out how this predicted score was calculated. All the coefficient estimates were copied from the model summary output by <code>summary(model4_c)</code>.</p>
</div>
</div></li>
<li><p>We can check that we did the maths correctly by outputting the model’s prediction for the 154<sup>th</sup> observation directly. To this end, we apply the <code>predict()</code> function to the model object <code>model4_c</code> and extract the model’s predicted score for the 154<sup>th</sup> data point:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model4_c)[<span class="dv">154</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     154 
45.53989 </code></pre>
</div>
</div>
<p>As you can see, we obtain the same predicted <code>Vocab</code> score. The minor difference after the decimal point is due to us using coefficient estimates rounded-off to four decimal places (as displayed in the model’s summary output) rather than the exact values to which the <code>predict()</code> function has access.</p></li>
<li><p>This is all very well, but how accurate is this model prediction? To find out, we can compare this <em>predicted</em> score (that our model predicts for any male 46-year old with a manual occupation, a Blocks score of 23, and 10 years in formal education) to the 46-year-old Polish driver’s <em>actual</em> <code>Vocab</code> score:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">154</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, Age, NativeLg, Occupation, OccupGroup, Gender, Blocks, EduTotal, Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  Group Age NativeLg Occupation OccupGroup Gender Blocks EduTotal    Vocab
1    L2  46   Polish     Driver          M      M     23       10 48.88889</code></pre>
</div>
</div></li>
<li><p>Our model prediction (<code>45.53989</code>) is close to our Polish driver’s real <code>Vocab</code> test score (<code>48.88889</code>), but our model has slightly underestimated his performance. This underestimation results in a positive <strong>residual</strong>. The residual is positive because there are points “left over” by the model. Model residuals are calculated by subtracting a model’s prediction from the real, observed value of the outcome variable for any specific data point. In our case, we substract our model’s predicted <code>Vocab</code> score for a male 46-year old with a manual occupation, a Blocks score of 23, and 10 years in formal education from the Polish 46-year-old driver’s actual <code>Vocab</code> score:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fl">48.88889</span> <span class="sc">-</span> <span class="fl">45.53989</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 3.349</code></pre>
</div>
</div>
<p>Residuals are also stored in the model object and be accesssed like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model4_c<span class="sc">$</span>residuals[<span class="dv">154</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     154 
3.348998 </code></pre>
</div>
</div></li>
<li><p>We can compare this particular residual (corresponding to the 154<sup>th</sup> participant in the dataset) to all model residuals (corresponding to all participants) by examining the <strong>summary statistics of all residuals</strong>, which are displayed at the top of the model summary output (<code>summary(model4_c)</code>). These descriptive statistics inform us that the residual for the 154<sup>th</sup> participant is slightly higher than the average (median) residual, but well within the IQR (see <a href="8_DescriptiveStats.html#sec-IQR" class="quarto-xref"><span>Section 8.3.2</span></a>) of model residuals:</p>
<pre data-code-line-numbers=""><code>Residuals:
    Min      1Q  Median      3Q     Max 
-62.825 -10.838   1.831  12.185  38.345 </code></pre>
<p>Looking at the minimum and maximum residuals, we can see that our model overestimates at least one person’s <code>Vocab</code> score by 63 points (this is the most negative residual: <code>Min</code>), whilst in another case it underestimates it by 38 points (this is the largest positive residual: <code>Max</code>).</p>
<div class="cell">
<details class="code-fold">
<summary>Click here to find out whose score was most underestimated!</summary>
<div class="sourceCode cell-code" id="cb35" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the following code to find out more about the participant whose Vocab score was most dramatically underestimated by our model:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.max</span>(model4_c<span class="sc">$</span>residuals)) <span class="sc">|&gt;</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Group, NativeLg, Age, Occupation, Gender, Blocks, EduTotal, Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
<li><p>The <strong><em>p</em>-values</strong> associated with each coefficient estimate in the model summary indicate which predictor variables (or predictor variable <em>levels</em>, in the case of categorical variables) make a statistically significant contribution to the model. You may recall that, in <a href="12_SimpleLinearRegression.html#sec-Categoricalpredictor" class="quarto-xref"><span>Section 12.3</span></a>, we fitted a simple linear regression model (<code>model3</code>) which included only <code>OccupGroup</code> as a single predictor. In this simple model, the coefficient estimate for <code>OccupGroupI</code> made a statistically significant contribution to the model at an α-level of 0.05 (<em>p</em>&nbsp;=&nbsp;0.0335). By contrast, in the present multiple linear regression model, the predictor level <code>OccupGroupI</code> does <em>not</em> make a statistically significant contribution (<em>p</em>&nbsp;=&nbsp;0.077600 which is greater than 0.05). This is because our multiple regression model <code>model4_c</code> includes predictors that account for some of the same variance in <code>Vocab</code> scores in the data that occupational groups accounted for in our earlier model. This leaves less unique variance attributable to occupational group, thereby rendering it statistically non-significant.</p></li>
<li><p>From the <strong>adjusted R-squared</strong> value (<code>0.3276</code>) displayed at the bottom of the model summary output, we can see that our multiple linear regression model accounts for around 33% of the total variance in <code>Vocab</code> scores found in the <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> data. This is considerably more than we achieved with any of the simple linear models that we fitted in <a href="12_SimpleLinearRegression.html" class="quarto-xref"><span>Chapter 12</span></a>.</p></li>
</ul>
<section id="sec-ModelPredictions" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="sec-ModelPredictions"><span class="header-section-number">13.4.1</span> Interpreting model predictions</h3>
<p>Whilst it is important to understand how to interpret the coefficients of a multiple linear regression model from the model summary, in practice, it is also always a very good idea to visualise model predictions. On the one hand, this reduces the risk of making any obvious interpretation errors and, on the other, it is much easier to interpret the residuals of a model when they are visualised alongside model predictions.</p>
<p>To fully visualise the predictions of a multiple linear model, we would need to be able to plot as many dimensions as there are predictors in the model. The trouble is that, as humans, we find it difficult to interpret data visualisations with more than two dimensions. Indeed, although 3D plots can sometimes be useful (and can easily be generated in <code>R</code>), we are much better at interpreting two-dimensional plots. To bypass this inherent human weakness, we will plot the values predicted by our model on several plots: one for each predictor variable (see <a href="#fig-VisregVocab" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>). Run the following command and then follow the instructions displayed in the Console pane to view the plots one by one. You may need to resize your Plot pane for the plots to be displayed. If you have a small screen, you may find the “🔎 Zoom” option in RStudio’s Plots pane useful as it allows you to view the plots in a separate window.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model4_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-VisregVocab" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Six-panel scatter plot showing vocabulary scores predicted by various factors, with partial residual points and blue regression lines in each panel. Categorical predictors show relatively flat trends and continuous predictors show positive linear relationships.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VisregVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-VisregVocab-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;13.1: Vocab scores as predicted by model4_c (blue lines) as a function of various predictor variables and partial model residuals (grey points)"><img src="13_MultipleLinearRegression_files/figure-html/fig-VisregVocab-1.png" class="img-fluid figure-img" alt="Six-panel scatter plot showing vocabulary scores predicted by various factors, with partial residual points and blue regression lines in each panel. Categorical predictors show relatively flat trends and continuous predictors show positive linear relationships." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VisregVocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: <code>Vocab</code> scores as predicted by <code>model4_c</code> (blue lines) as a function of various predictor variables and partial model residuals (grey points)
</figcaption>
</figure>
</div>
</div>
</div>
<p>On plots produced by the <code>visreg()</code> function, as in <a href="12_SimpleLinearRegression.html#fig-PredictedVocabByOccupation" class="quarto-xref">Figure&nbsp;<span>12.9</span></a>, the model’s predicted values are displayed as blue lines. By default, these predictions are surrounded by 95% confidence bands, which are visualised as grey areas. Now that we have several predictors in our model, the points in <code>visreg()</code> plots represent the model’s <strong>partial residuals</strong>. Partial residuals are the left-over variance (i.e., the residual) relative to the predictor that we are examining after having subtracted off the contribution of all the other predictors in the model.</p>
<p>When interpreting the numeric predictors plotted in <a href="#fig-VisregVocab" class="quarto-xref">Figure&nbsp;<span>13.1</span></a> above, it is important to remember that we entered centered numeric predictors in <code>model4_c</code>. This means that an <code>Age_c</code> value of&nbsp;0 corresponds to the median age in the dataset: 31 years. This is why <a href="#fig-VisregVocab" class="quarto-xref">Figure&nbsp;<span>13.1</span></a> features negative ages: the negative values correspond to participants who are younger than 31. By contrast, positive scores correspond to participants who are older than 31 years. This is hardly intuitive so, for the purposes of visualising and interpreting our model, it is best to transform these variables back to their original scale (see <a href="#fig-PredictedVocabAge" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>). This is achieved by adding the following <code>xtrans</code> argument within the <code>visreg()</code> function.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Due to a bug that was introduced in the latest version of the {visreg} package, it is currently necessary to install version 2.7 of the {visreg} package for the <code>xtrans</code> argument to work as expected. You can find out which package version you currently have installed, if any, using this function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"visreg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you have version 2.8.0, begin by deleting your current installation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">"visreg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, install the {remotes} package, which allows you to install older versions of packages (if they are compatible with your <code>R</code> version). You will likely get a message notifying you that it is necessary to restart your <code>R</code> session. Click “yes”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, load the {remotes} library and then install version 2.7.0 of the {visreg} package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_version</span>(<span class="st">"visreg"</span>, <span class="st">"2.7.0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model4_c, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"Age_c"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Age), </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (in years)"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-PredictedVocabAge" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing predicted vocabulary scores versus age in years, with partial residual points and a blue regression line with gray confidence band showing a slight positive trend. Two data points are highlighted: a pink point labeled Lithuanian bar staff showing a large positive residual around age 25, and a purple point labeled Polish driver showing a small residual around age 50.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabAge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAge-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;13.2: Vocab scores as predicted by model4_c for speakers of various ages (blue line) and partial model residuals represented as points. In the version printed in the textbook, two data points are highlighted: one representing a very large positive residual and one representing a very small residual."><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAge-1.png" class="img-fluid figure-img" alt="Scatter plot showing predicted vocabulary scores versus age in years, with partial residual points and a blue regression line with gray confidence band showing a slight positive trend. Two data points are highlighted: a pink point labeled Lithuanian bar staff showing a large positive residual around age 25, and a purple point labeled Polish driver showing a small residual around age 50." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabAge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: <code>Vocab</code> scores as predicted by <code>model4_c</code> for speakers of various ages (blue line) and partial model residuals represented as points. In the version printed in the textbook, two data points are highlighted: one representing a very large positive residual and one representing a very small residual.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-PredictedVocabAge" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>, we focus on one predictor from our model: <code>Age</code>. We know from our model summary that the coefficient estimate for age is positive (<code>0.3718</code>), hence the upward blue line. The grey 95% confidence band visualises the uncertainty around the estimated mean predicted <code>Vocab</code> scores.</p>
<p>The points on <a href="#fig-PredictedVocabAge" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> represent the partial residuals. This means that there are as many points as there are participants in the dataset used to fit the model. The further away a point is from the predicted value (the blue line), the poorer the prediction is for that particular participant.</p>
<p>Some of the partial residuals are particularly large: the <code>Vocab</code> score of the 23-year-old Lithuanian bar staff, for instance, is vastly underestimated. By contrast, the 46-year-old Polish driver’s predicted score is well within the confidence band of the predicted <code>Vocab</code> score for his age, indicating that our model makes a pretty accurate prediction for this L2 speaker.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The dataset from <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> includes a variable that we have not explored yet: <code>ART</code>. It stands for Author Recognition Test <span class="citation" data-cites="acheson2008">(<a href="99_references.html#ref-acheson2008" role="doc-biblioref">Acheson, Wells &amp; MacDonald 2008</a>)</span> and is a measure of print exposure to (almost exclusively Western, English-language) literature. Dąbrowska <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">(<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>:&nbsp;9)</span> explains the testing instrument and her motivation for including it in her battery of tests as follows:</p>
<blockquote class="blockquote">
<p>The test consists of a list of 130 names, half of which are names of real authors. The participants’ task is to mark the names that they know to be those of published authors. To penalize guessing, the score is computed by subtracting the number of foils [wrong guesses] from the number of real authors selected. Thus, the maximum possible score is 65, and the minimum score could be negative if a participant selects more foils than real authors. When this happened, the negative number was replaced with 0.</p>
<p>The ART has been shown to be a valid and reliable measure of print exposure, which, unlike questionnaire-based measures, is not contaminated by socially desirable responses and assesses lifetime reading experience as opposed to current reading (see Acheson et al., 2008; Stanovich &amp; Cunningham, 1992).</p>
</blockquote>
<p><span style="color:green;"><strong>Q13.1</strong></span> For this task, you will fit a new multiple linear regression model that predicts <code>Vocab</code> scores among L1 and L2 speakers using all of the predictors that we used in <code>model4_c</code> plus <code>ART</code> scores. Which formula do you need to specify inside the <code>lm()</code>function to fit this model?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_1" onsubmit="return validate_form_Q13_1()" method="post">
<label>
<input type="radio" name="answer_Q13_1" id="answer_Q13_1_1" value="Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c + ART">
Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c + ART
</label>
<br>
<label>
<input type="radio" name="answer_Q13_1" id="answer_Q13_1_2" value="Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c * ART">
Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c * ART
</label>
<br>
<label>
<input type="radio" name="answer_Q13_1" id="answer_Q13_1_3" value="ART ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c">
ART ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c
</label>
<br>
<label>
<input type="radio" name="answer_Q13_1" id="answer_Q13_1_4" value="Vocab ~ model4_c + ART">
Vocab ~ model4_c + ART
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_1"></div>
</form>
<script>function validate_form_Q13_1() {var x, text; var x = document.forms['form_Q13_1']['answer_Q13_1'].value;if (x == 'Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c + ART'){text = 'That’s right, well done!';} else {text = 'No, try it out for yourself and see which formula generates the right model.';} document.getElementById('result_Q13_1').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!';text = res1;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.2</strong></span> Fit a model using the correct formula from above. Examine the summary of your new model. Which of these statements is/are true?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_2" onsubmit="return validate_form_Q13_2()" method="post">
<label>
<input type="checkbox" id="answer_Q13_2_1" value="The model that does not include ART (model4_c) accounts for more of the variance in Vocab scores than the model that does.">
The model that does not include ART (model4_c) accounts for more of the variance in Vocab scores than the model that does.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_2_2" value="Recognising more real authors on the ART is associated with higher Vocab scores.">
Recognising more real authors on the ART is associated with higher Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_2_3" value="The model that includes ART accounts for more of the variance in Vocab scores than the model that does not (model4_c).">
The model that includes ART accounts for more of the variance in Vocab scores than the model that does not (model4_c).
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_2_4" value="ART makes a statistically significant contribution to the model at the α-level of 0.05.">
ART makes a statistically significant contribution to the model at the α-level of 0.05.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_2_5" value="Recognising more real authors on the ART is associated with lower Vocab scores.">
Recognising more real authors on the ART is associated with lower Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_2_6" value="ART does not make a statistically significant contribution to the model at the α-level of 0.05.">
ART does not make a statistically significant contribution to the model at the α-level of 0.05.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_2"></div>
</form>
<script>function validate_form_Q13_2() {var text; var x1 = document.getElementById('answer_Q13_2_1'); var x2 = document.getElementById('answer_Q13_2_2'); var x3 = document.getElementById('answer_Q13_2_3'); var x4 = document.getElementById('answer_Q13_2_4'); var x5 = document.getElementById('answer_Q13_2_5'); var x6 = document.getElementById('answer_Q13_2_6'); if (x1.checked == false&x2.checked == true&x3.checked == true&x4.checked == true&x5.checked == false&x6.checked == false){text = 'Excellent!';} else {text = 'No, not quite. Check the code below if you need some help.';} document.getElementById('result_Q13_2').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!';text = res1 + res2;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_82123" onclick="return show_hint_82123()">🐭 Click on the mouse for a hint.</div>
<div id="result_82123" onclick="return show_hint_82123()"></div>
<script>function show_hint_82123(){var x = document.getElementById('result_82123').innerHTML; if(!x){document.getElementById('result_82123').innerHTML = 'Three of these statements are correct.';} else {document.getElementById('result_82123').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.2.</summary>
<div class="sourceCode cell-code" id="cb42" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, it is always a good idea to visualise the data before fitting a model to have an idea of what to expect:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> Vocab,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> ART)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We fit the new model with ART as an additional predictor using the formula from Q13.1:</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>model.ART <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> ART, </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># We examine the coefficients of this new model:</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.ART)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># To find out how much variance the model accounts for compared to our prior model, compare the adjusted R-squared values of the two models:</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4_c)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.ART)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Have you noticed how, having added <code>ART</code> as a predictor to your model, <code>Age</code> no longer makes a statistically significant contribution to the model (<em>p</em>&nbsp;=&nbsp;0.070994)? How come? Well, it turns out that <code>ART</code> and <code>Age</code> are correlated (<em>r</em>&nbsp;=&nbsp;0.32, see <a href="#fig-AgeArtPlot" class="quarto-xref">Figure&nbsp;<span>13.3</span></a>). This moderate positive correlation makes intuitive sense: the older you are, the more likely you are to have come across more authors and therefore be able to correctly identify them in the Author Recognition Test. Of the two predictors, our model suggests that ART scores are a more useful predictor of <code>Vocab</code> scores than age. In other words, if we know the ART score of a participant from the <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> dataset, their age does not provide additional information that can help us to better predict their <code>Vocab</code> score.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-AgeArtPlot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing the relationship between age on the x-axis and Author Recognition Test (ART) scores on the y-axis, with data points scattered throughout. A blue regression line with gray confidence band shows a moderate positive correlation.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AgeArtPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-AgeArtPlot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;13.3: Observed relationship between participants’ age and their Author Recognition Test (ART) scores. The blue line shows that there is a moderate positive correlation between these two variables."><img src="13_MultipleLinearRegression_files/figure-html/fig-AgeArtPlot-1.png" class="img-fluid figure-img" alt="Scatter plot showing the relationship between age on the x-axis and Author Recognition Test (ART) scores on the y-axis, with data points scattered throughout. A blue regression line with gray confidence band shows a moderate positive correlation." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AgeArtPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Observed relationship between participants’ age and their Author Recognition Test (ART) scores. The blue line shows that there is a moderate positive correlation between these two variables.
</figcaption>
</figure>
</div>
</div>
</div>
<p><span style="color:green;"><strong>Q13.3</strong></span> What is the predicted <code>Vocab</code> score of a female L1 speaker aged 31 (the median age) with a manual occupation, who scored 16 on the Blocks test (the median score), spent 14 years in formal education (median time period), and scored 20 on the Author Recognition Test?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_3" onsubmit="return validate_form_Q13_3()" method="post">
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_1" value="71.1133">
71.1133
</label>
<br>
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_2" value="8.5405">
8.5405
</label>
<br>
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_3" value="74.1007">
74.1007
</label>
<br>
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_4" value="73.6248">
73.6248
</label>
<br>
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_5" value="74.3556">
74.3556
</label>
<br>
<label>
<input type="radio" name="answer_Q13_3" id="answer_Q13_3_6" value="123.3076">
123.3076
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_3"></div>
</form>
<script>function validate_form_Q13_3() {var x, text; var x = document.forms['form_Q13_3']['answer_Q13_3'].value;if (x == '71.1133'){text = 'Absolutely, well done!';} else {text = 'No, that’s it. Check the hint below.';} document.getElementById('result_Q13_3').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!';text = res1 + res2 + res3;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_26351" onclick="return show_hint_26351()">🐭 Click on the mouse for a hint.</div>
<div id="result_26351" onclick="return show_hint_26351()"></div>
<script>function show_hint_26351(){var x = document.getElementById('result_26351').innerHTML; if(!x){document.getElementById('result_26351').innerHTML = 'The person described corresponds to the reference levels of all the predictors except for their occupational group and ART score.';} else {document.getElementById('result_26351').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.3.</summary>
<div class="sourceCode cell-code" id="cb43" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We must add together the coefficient for the intercept, the coefficient for the manual occupation (which is negative), and the ART coefficient multiplied by 20 (as we did not center this predictor):</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fl">62.5728</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">2.5115</span> <span class="sc">+</span> <span class="fl">0.5526</span><span class="sc">*</span><span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q13.4</strong></span> By default, the <code>visreg()</code> function displays a 95% confidence band around predicted values, corresponding to a significance level of 0.05. How can you change this default to display a 99% confidence band instead? Run the command <code>?visreg()</code> to find out how to achieve this from the function’s help file.</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_4" onsubmit="return validate_form_Q13_4()" method="post">
<label>
<input type="radio" name="answer_Q13_4" id="answer_Q13_4_1" value="visreg(model.ART, xvar = &quot;ART&quot;, trans = CI(0.99))">
visreg(model.ART, xvar = "ART", trans = CI(0.99))
</label>
<br>
<label>
<input type="radio" name="answer_Q13_4" id="answer_Q13_4_2" value="visreg(model.ART, xvar = &quot;ART&quot;, alpha = 99)">
visreg(model.ART, xvar = "ART", alpha = 99)
</label>
<br>
<label>
<input type="radio" name="answer_Q13_4" id="answer_Q13_4_3" value="visreg(model.ART, xvar = &quot;ART&quot;, CI = 0.01)">
visreg(model.ART, xvar = "ART", CI = 0.01)
</label>
<br>
<label>
<input type="radio" name="answer_Q13_4" id="answer_Q13_4_4" value="visreg(model.ART, xvar = &quot;ART&quot;, alpha = &quot;99%&quot;)">
visreg(model.ART, xvar = "ART", alpha = "99%")
</label>
<br>
<label>
<input type="radio" name="answer_Q13_4" id="answer_Q13_4_5" value="visreg(model.ART, xvar = &quot;ART&quot;, alpha = 0.01)">
visreg(model.ART, xvar = "ART", alpha = 0.01)
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_4"></div>
</form>
<script>function validate_form_Q13_4() {var x, text; var x = document.forms['form_Q13_4']['answer_Q13_4'].value;if (x == 'visreg(model.ART, xvar = "ART", alpha = 0.01)'){text = 'That’s right, well done!';} else {text = 'No, that’s not it. Have you tried to run the command to see if it works?';} document.getElementById('result_Q13_4').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!';text = res1 + res2 + res3 + res4;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_42138" onclick="return show_hint_42138()">🐭 Click on the mouse for a hint.</div>
<div id="result_42138" onclick="return show_hint_42138()"></div>
<script>function show_hint_42138(){var x = document.getElementById('result_42138').innerHTML; if(!x){document.getElementById('result_42138').innerHTML = '99% expressed as a probability is 0.99. The significance level is equal to 1 minus the confidence level expressed as a probability.';} else {document.getElementById('result_42138').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.4.</summary>
<div class="sourceCode cell-code" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The argument that you need to change is called "alpha". This is because the significance level is also called the alpha level (see Section 11.3). </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The alpha value that corresponds to a 99% confidence interval is equal to:</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.99</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hence the code should (minimally) include these arguments:</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model.ART, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"ART"</span>, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha =</span> .<span class="dv">01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Observe how the width of the confidence bands changes when you increase the significance level from 0.01 to 0.1: the higher the significance level, the narrower the confidence band becomes. Remember that the significance level corresponds to the risk that we are willing to take of wrongly rejecting the null hypothesis when it is actually true. Therefore, when we lower this risk by choosing a lower significance level (i.e., 0.01), we end up with wider confidence bands that are more likely to allow us to draw a flat line (see <a href="11_Inferential.html#sec-Correlations" class="quarto-xref"><span>Section 11.5</span></a>). If we can draw a flat line through a 99% confidence band, this means that we do not have enough evidence to reject the null hypothesis at the significance level of 0.01.</p>
</div>
</div>
</div>
</section>
</section>
<section id="relative-importance-of-predictors" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="relative-importance-of-predictors"><span class="header-section-number">13.5</span> Relative importance of predictors</h2>
<p>When interpreting a model summary, it is important to remember that the coefficient estimates of each predictor correspond to a change in prediction for a one-unit change in that predictor, e.g.&nbsp;for the predictor <code>Age</code>, an increase of one year. However, within a single model, it’s quite common for the predictor variables to be measured in different units. For example, in <code>summary(model4_c)</code>, the coefficient estimate for <code>Age_c</code> is <code>0.3718</code>, which means that, holding all other predictors constant, for every year that a participant is older than the median age, their predicted <code>Vocab</code> score increases by <code>0.3718</code>. By contrast, the coefficient estimate for the <code>Blocks_c</code> predictor (<code>1.3011</code>) corresponds to an increase in <code>Vocab</code> scores for every additional point that participants score on the non-verbal IQ Blocks test. Its unit is therefore test points. For categorical predictor variables, a single-unit change represents a change from one predictor level to another, e.g.&nbsp;from L1 to L2, or from female to male.</p>
<p>Because they are in different units that represent different quantities or levels, the raw coefficient estimates of a model cannot be compared to each other. Indeed, depending on the predictor, a one-unit change may correspond to either a big or a small change. This is where measures of the relative importance of predictors come in handy. In this chapter, we will use the <strong>lmg</strong> metric <span class="citation" data-cites="lindemanIntroductionBivariateMultivariate1980">(that was first proposed by <strong>L</strong>indeman, <strong>M</strong>erenda &amp; <strong>G</strong>old in <a href="99_references.html#ref-lindemanIntroductionBivariateMultivariate1980" role="doc-biblioref">1980</a>: 119 ff.)</span> to compare the importance of predictors within a single multiple linear regression model.</p>
<p>Although not currently widely used in the language sciences <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">(but see, e.g. <a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">Dąbrowska 2019</a>: 14)</span>, lmg has a number of advantages. Its interpretation is fairly intuitive because it is similar to a coefficient of determination (R<sup>2</sup>): a value of&nbsp;0 means that, in this model, a predictor accounts for 0% of the variance in the outcome variable, while a value of&nbsp;1 would mean that it can be used to perfectly predict the outcome variable. Calculating lmg values is computationally involved because the metric includes both direct effects and is adjusted for all the other predictors of the model. But this need not worry us because a researcher and statistician, Ulrike Grömping, has developed and published an <code>R</code> package that will do the computation for us. 😊</p>
<p>Once we have installed and loaded the {<a href="https://cran.r-universe.dev/relaimpo/doc/manual.html">relaimpo</a>} package<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="citation" data-cites="grömping2006">(<a href="99_references.html#ref-grömping2006" role="doc-biblioref">Grömping 2006</a>)</span>, we can use its <code>calc.relimp()</code> function to calculate a range of relative importance metrics for linear models. With the argument “type”, we specify that we are interested in the lmg metric:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"relaimpo"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(relaimpo)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>rel.imp.metric <span class="ot">&lt;-</span> <span class="fu">calc.relimp</span>(model4_c, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"lmg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output of the function is long. We have therefore saved it as a new <code>R</code> object (<code>rel.imp.metric</code>) in order to retrieve only the part that we are interested in, namely the lmp values for each predictor, as a single data frame (<code>rel.imp.metric.df</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rel.imp.metric.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lmg =</span> rel.imp.metric<span class="sc">$</span>lmg) <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Predictor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We display this data frame in descending order of lmp values, rounded to two decimal values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>rel.imp.metric.df <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lmg =</span> <span class="fu">round</span>(lmg, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>lmg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>   Predictor  lmg
1      Group 0.15
2 OccupGroup 0.07
3 EduTotal_c 0.05
4      Age_c 0.04
5   Blocks_c 0.04
6     Gender 0.00</code></pre>
</div>
</div>
<p>These values indicate that, on average, whether or not a participant is a native or non-native speaker of English (<code>Group</code>) makes the biggest difference in terms of predicted <code>Vocab</code> scores. Gender, by contrast, is practically irrelevant in this model.</p>
<p>We can also visualise these values in the form of a bar plot (see <a href="#fig-ModelLmg" class="quarto-xref">Figure&nbsp;<span>13.4</span></a>). Note that another nice thing about the lmg metric is that the lmg values for all the predictors entered in <code>model4_c</code> add up to the model’s (unadjusted) multiple R<sup>2</sup> (<code>0.3621</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>rel.imp.metric.df <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Predictor, lmg),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> lmg)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predictor in model4_c"</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ModelLmg" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Bar plot showing the relative importance of six predictors in model4_c, with predictor names on the y-axis and lmg values on the x-axis. Group has the highest importance and Gender has the lowest one.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ModelLmg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-ModelLmg-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;13.4: Relative importance of predictors in model 4_c"><img src="13_MultipleLinearRegression_files/figure-html/fig-ModelLmg-1.png" class="img-fluid figure-img" alt="Bar plot showing the relative importance of six predictors in model4_c, with predictor names on the y-axis and lmg values on the x-axis. Group has the highest importance and Gender has the lowest one." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ModelLmg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: Relative importance of predictors in <code>model 4_c</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is also worth noting that the second most important predictor is <code>OccupGroup</code>. This may come as a surprise given that none of its levels (or rather none of the differences between the reference level of <code>C</code> for clerical occupations and the remaining levels) make a statistically significant contribution to the model. This result illustrates the value of this type of analysis compared to only looking at a model’s coefficient estimates.</p>
<p>Many studies will compare the coefficient estimates of multiple regression models using <strong>standardised coefficients</strong> [see e.g.&nbsp;@winterStatisticsLinguistsIntroduction2020: Section 6.2]; however, this approach can lead to misleading conclusions <span class="citation" data-cites="mizumotoCalculatingRelativeImportance2023">(see e.g. <a href="99_references.html#ref-mizumotoCalculatingRelativeImportance2023" role="doc-biblioref">Mizumoto 2023</a>)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In the last <span style="color:green;">Your turn!</span> section, you fitted a multiple linear regression model to predict <code>Vocab</code> scores among L1 and L2 speakers using all of the predictors that we used in <code>model4_c</code> plus <code>ART</code> scores.</p>
<p><span style="color:green;"><strong>Q13.5</strong></span> Calculate the relative importance of each of the predictors in this model using the {relaimpo} package. What is the relative importance of the predictor <code>ART</code> in this model as estimated by the lmg metric and rounded to two decimal places?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_5" onsubmit="return validate_form_Q13_5()" method="post">
<input type="text" placeholder="" name="answer_Q13_5">
<input type="submit" value="Check answer">
<div id="result_Q13_5"></div>
</form>
<script>function validate_form_Q13_5() {var x, text; var x = document.forms['form_Q13_5']['answer_Q13_5'].value;if (x == '0.11'|x == '0,11'){text = 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.';} else {text = 'No, that’s incorrect.';} document.getElementById('result_Q13_5').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.';text = res1 + res2 + res3 + res4 + res5;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.5.</summary>
<div class="sourceCode cell-code" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>model.ART <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> ART, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the lmg values and extract them as a data frame</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(relaimpo)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>rel.imp.metric <span class="ot">&lt;-</span> <span class="fu">calc.relimp</span>(model.ART, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"lmg"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>rel.imp.metric.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lmg =</span> rel.imp.metric<span class="sc">$</span>lmg) <span class="sc">|&gt;</span> </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Predictor"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>rel.imp.metric.df <span class="sc">|&gt;</span> </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lmg =</span> <span class="fu">round</span>(lmg, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>lmg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="modelling-interactions-between-predictors" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="modelling-interactions-between-predictors"><span class="header-section-number">13.6</span> Modelling interactions between predictors</h2>
<p>One of the strengths of multiple linear regression is that we can also model interactions between predictors. This is important because a predictor’s relationship with the outcome variable may depend on another predictor. Consider <code>Age</code> as a predictor of <code>Vocab</code> scores. In <code>model4_c</code>, we saw that this predictor made a statistically significant contribution to the model. The coefficient was positive, which means that the model predicts that the older the participants, the higher their receptive English vocabulary.</p>
<p>However, if you completed <span style="color:green;"><strong>Task 11.1</strong></span>, you might remember that <code>Age</code> correlates positively with <code>Vocab</code> scores among L1 participants, but does not among L2 participants (see <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> below). If anything, the correlation visualised in the right-hand panel of <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> is slightly negative. Moreover, the confidence band is wide enough to draw a horizontal line through it, which suggests that the data are also compatible with the null hypothesis of no correlation. As a result, we can conclude that this slightly negative correlation is not statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> Vocab)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(<span class="sc">~</span> Group) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CorVocabAge" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two-panel scatter plot showing vocabulary scores versus age for L1 and L2 groups, with data points and blue regression lines with gray confidence bands. The L1 panel shows a positive correlation, while the L2 panel shows a negative correlation.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CorVocabAge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-CorVocabAge-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;13.5: Observed correlation between participants’ vocabulary scores and their age in both the L1 and L2 groups"><img src="13_MultipleLinearRegression_files/figure-html/fig-CorVocabAge-1.png" class="img-fluid figure-img" alt="Two-panel scatter plot showing vocabulary scores versus age for L1 and L2 groups, with data points and blue regression lines with gray confidence bands. The L1 panel shows a positive correlation, while the L2 panel shows a negative correlation." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CorVocabAge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: Observed correlation between participants’ vocabulary scores and their age in both the L1 and L2 groups
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> informs us that what we really need is a model that can account for the fact that <code>Age</code> is probably a useful predictor of <code>Vocab</code> scores for L1 speakers, but not so much for L2 speakers. In other words, we’d like to model an <strong>interaction</strong> between the predictors <code>Age</code> and <code>Group</code>.</p>
<p>In <code>R</code>’s formula syntax, interaction terms are denoted with a colon (<code>:</code>) or an asterisk (<code>*</code>). In the following model, therefore, we are attempting to predict <code>Vocab</code> scores on the basis of a person’s native-speaker status (<code>Group</code>), their age, occupational group, gender, Blocks test score, number of years in formal education, and the interaction between their age and native-speaker status (<code>Age_c:Group</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> Age_c<span class="sc">:</span>Group, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + 
    EduTotal_c + Age_c:Group, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-66.720 -10.651   1.224  11.939  45.415 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    69.1314     3.6286  19.052  &lt; 2e-16 ***
GroupL2       -19.9128     3.4699  -5.739 5.26e-08 ***
Age_c           0.5466     0.1471   3.717 0.000286 ***
OccupGroupI     7.8267     5.4824   1.428 0.155525    
OccupGroupM    -4.0769     4.3852  -0.930 0.354058    
OccupGroupPS   -1.7774     4.2686  -0.416 0.677729    
GenderM        -1.6285     3.1213  -0.522 0.602644    
Blocks_c        1.2414     0.3132   3.964 0.000115 ***
EduTotal_c      2.5520     0.6126   4.166 5.27e-05 ***
GroupL2:Age_c  -0.8982     0.2867  -3.133 0.002089 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.12 on 147 degrees of freedom
Multiple R-squared:  0.402, Adjusted R-squared:  0.3654 
F-statistic: 10.98 on 9 and 147 DF,  p-value: 5.537e-13</code></pre>
</div>
</div>
<p>In the model summary above, the interaction term between <code>Age</code> and <code>Group</code> is the last coefficient listed (<code>GroupL2:Age_c</code>). The values confirm our intuition based on our descriptive visualisation of the data (<a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a>): there is a statistically significant interaction between age and native-speaker status (<em>p</em>&nbsp;=&nbsp;0.002089) and the interaction coefficient for this interaction term (<code>Age_c:Group</code>) is negative (<code>-0.8982</code>). This means that, whilst being older is generally associated with higher <code>Vocab</code> scores for the reference level of L1 speakers, if a participant is an L2 English speaker, this trend is reversed.</p>
<p>To understand how this works in practice, let’s compare the predicted <code>Vocab</code> scores of two 35-year-olds: one a native English speaker and the other a non-native. For the purposes of this illustration, we will assume that, apart from their native-speaker status, all their other characteristics correspond to the reference level in our model (i.e.&nbsp;they are both female, have a clerical occupation, scored average on the Blocks test and were in formal education for the median number of years). For the L1 speaker, we calculate their predicted <code>Vocab</code> score as before. We take the intercept (<code>69.1314</code>) as our starting point and then add the <code>Age_c</code> coefficient (<code>0.5466</code>) multiplied by the difference between their age and the median age (which is the reference level of our centered predictor) (i.e., 35&nbsp;-&nbsp;31&nbsp;=&nbsp;4). This means that their predicted <code>Vocab</code> score is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fl">69.1314</span> <span class="sc">+</span> <span class="fl">0.5466</span><span class="sc">*</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 71.3178</code></pre>
</div>
</div>
<p>For the L2 speaker, we begin by combining the same coefficient estimates as above but, this time, we also add the <code>GroupL2</code> coefficient (<code>-19.9128</code>), and the interaction coefficient (<code>GroupL2:Age_c</code>). The interaction coefficient (<code>-0.8982</code>) has to be multiplied by the difference between the speaker’s age and the median age (which remains 4 years). This L2 speaker’s predicted score is therefore:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fl">69.1314</span> <span class="sc">+</span> <span class="fl">0.5466</span><span class="sc">*</span><span class="dv">4</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">19.9128</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.8982</span><span class="sc">*</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 47.8122</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Whenever we have a model with an interaction, we can no longer interpret the individual coefficient estimates of the predictors that enter into the interaction by themselves: instead, we must interpret our model’s main effects together with their interaction!</p>
<p>For example, in <code>model5</code>, if we only took account of the model’s main effect for age, we would be misled into thinking that age is <em>always</em> positively associated with <code>Vocab</code> scores. However, as illustrated in <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a>, we know that this is not true for L2 speakers — hence the statistically significant interaction between <code>Age_c</code> and <code>Group</code> in <code>model5</code>.</p>
</div>
</div>
<p>The best way to avoid misinterpreting interaction effects is to make sure you always visualise the predictions of models that involve interactions. The <code>visreg()</code> function includes a “by” argument, which is ideal for this:</p>
<div class="cell" data-source-line-numbers="3">
<div class="sourceCode cell-code" id="cb60" data-source-line-numbers="3" data-code-line-numbers="3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model5, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"Age_c"</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"Group"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Age), </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (in years)"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PredictedVocabAgeInteraction" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two-panel plot showing vocabulary scores versus age for L1 and L2 groups, with data points and blue regression lines with gray confidence bands. The L1 panel shows a positive correlation, while the L2 panel shows a negative correlation.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabAgeInteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeInteraction-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;13.6: Vocab scores as predicted by model5 for L1 and L2 speakers of various ages (blue lines) and partial model residuals (grey points)"><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeInteraction-1.png" class="img-fluid figure-img" alt="Two-panel plot showing vocabulary scores versus age for L1 and L2 groups, with data points and blue regression lines with gray confidence bands. The L1 panel shows a positive correlation, while the L2 panel shows a negative correlation." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabAgeInteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: <code>Vocab</code> scores as predicted by <code>model5</code> for L1 and L2 speakers of various ages (blue lines) and partial model residuals (grey points)
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we compare <a href="#fig-PredictedVocabAgeInteraction" class="quarto-xref">Figure&nbsp;<span>13.6</span></a> (in which the points represent the model’s partial residuals) to <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> (in which the points represent the actual, observed values), we can see that the partial residuals are, on average, smaller than the differences between the observed values and the regression lines of <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a>. This is because the regression lines of <a href="#fig-CorVocabAge" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> correspond to a model that only includes three coefficients, <code>Age_c</code>, <code>Group</code> and their interaction (<code>Age_c:Group</code>), whereas the partial residuals in <a href="#fig-PredictedVocabAgeInteraction" class="quarto-xref">Figure&nbsp;<span>13.6</span></a> correspond to the left-over variance in <code>Vocab</code> scores once all other predictors of the <code>model5</code> have been taken into account.</p>
<p>Comparing the model summaries of <code>model4_c</code> and <code>model5</code>, we can see that adding the interaction term between age and native-speaker status considerably boosted the amount of variance in <code>Vocab</code> scores that our model now accounts for: whereas the adjusted R<sup>2</sup> of the model without the interaction was <code>0.3276</code> (33%), it has now reached <code>0.3654</code> (37%) thanks to the added interaction.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In this task, we will explore the possibility of an interaction between participants’ native-speaker status (<code>Group</code>) and the number of years they spent in formal education (<code>EduTotal</code>). The underlying idea is that, for the L1 speakers, their formal education will most likely have been in English; hence the longer they were in formal education, the higher they might score on the <code>Vocab</code> test. For the L2 speakers, however, their formal education will more likely have been in a language other than English. As a result, years in formal education may be a weaker predictor of <code>Vocab</code> scores than for L1 speakers.</p>
<p><span style="color:green;"><strong>Q13.6</strong></span> To begin, generate a plot to visualise this interaction in the observed data: map the <code>EduTotal</code> variable onto the <em>x</em>-axis and <code>Vocab</code> onto the <em>y</em>-axis, and split the plot into two facets, one for L1 and the other for L2 participants. Based on your interpretation of your plot, which of these statements is/are correct?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_6" onsubmit="return validate_form_Q13_6()" method="post">
<label>
<input type="checkbox" id="answer_Q13_6_1" value="For both L1 and L2 participants, the correlation between the number of years that they spent in formal education and their Vocab scores is not statistically significant.">
For both L1 and L2 participants, the correlation between the number of years that they spent in formal education and their Vocab scores is not statistically significant.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_6_2" value="For both L1 and L2 participants, the number of years that they spent in formal education is positively correlated with their Vocab scores.">
For both L1 and L2 participants, the number of years that they spent in formal education is positively correlated with their Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_6_3" value="For both L1 and L2 participants, the number of years that they spent in formal education is negatively correlated with their Vocab scores.">
For both L1 and L2 participants, the number of years that they spent in formal education is negatively correlated with their Vocab scores.
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_6_4" value="The number of years that L1 participants spent in formal education is positively correlated with their Vocab scores. This is not the case for L2 participants.">
The number of years that L1 participants spent in formal education is positively correlated with their Vocab scores. This is not the case for L2 participants.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_6"></div>
</form>
<script>function validate_form_Q13_6() {var text; var x1 = document.getElementById('answer_Q13_6_1'); var x2 = document.getElementById('answer_Q13_6_2'); var x3 = document.getElementById('answer_Q13_6_3'); var x4 = document.getElementById('answer_Q13_6_4'); if (x1.checked == false&x2.checked == true&x3.checked == false&x4.checked == false){text = 'That’s right, well done!';} else {text = 'No, that’s incorrect. Check the code below if you’re struggling to generate the plot.';} document.getElementById('result_Q13_6').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!';text = res1 + res2 + res3 + res4 + res5 + res6;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_55978" onclick="return show_hint_55978()">🐭 Click on the mouse for a hint.</div>
<div id="result_55978" onclick="return show_hint_55978()"></div>
<script>function show_hint_55978(){var x = document.getElementById('result_55978').innerHTML; if(!x){document.getElementById('result_55978').innerHTML = 'Only one of these statements is correct.';} else {document.getElementById('result_55978').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to generate the plot needed to complete Q13.6</summary>
<div class="sourceCode cell-code" id="cb61" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>Dabrowska.data <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> EduTotal, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> Vocab)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(<span class="sc">~</span> Group) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q13.7</strong></span> Below is the model formula for <code>model5</code>:</p>
<pre data-code-line-numbers=""><code>Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + EduTotal_c + Age_c:Group</code></pre>
<p>What do you need to add to this formula to also model the interaction that you just visualised?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_7" onsubmit="return validate_form_Q13_7()" method="post">
<label>
<input type="radio" name="answer_Q13_7" id="answer_Q13_7_1" value="+ EduTotal:Group">
+ EduTotal:Group
</label>
<br>
<label>
<input type="radio" name="answer_Q13_7" id="answer_Q13_7_2" value="+ Vocab ~ EduTotal_c:Group">
+ Vocab ~ EduTotal_c:Group
</label>
<br>
<label>
<input type="radio" name="answer_Q13_7" id="answer_Q13_7_3" value="+ EduTotal_c:Group">
+ EduTotal_c:Group
</label>
<br>
<label>
<input type="radio" name="answer_Q13_7" id="answer_Q13_7_4" value="+ EduTotal_c:Group:Vocab">
+ EduTotal_c:Group:Vocab
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_7"></div>
</form>
<script>function validate_form_Q13_7() {var x, text; var x = document.forms['form_Q13_7']['answer_Q13_7'].value;if (x == '+ EduTotal_c:Group'){text = 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!';} else {text = 'No, that’s not it.';} document.getElementById('result_Q13_7').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.8</strong></span> Fit the model with the added interaction. Does the interaction make a statistically significant contribution to the model at the significance level of 0.05?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_8" onsubmit="return validate_form_Q13_8()" method="post">
<label>
<input type="radio" name="answer_Q13_8" id="answer_Q13_8_1" value="No, it does not.">
No, it does not.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_8" id="answer_Q13_8_2" value="Yes, it does.">
Yes, it does.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_8"></div>
</form>
<script>function validate_form_Q13_8() {var x, text; var x = document.forms['form_Q13_8']['answer_Q13_8'].value;if (x == 'No, it does not.'){text = 'That’s right. The <em>p</em>-value associated with the interaction coefficient is greater than 0.05.';} else {text = 'No. The <em>p</em>-value associated with the interaction coefficient is greater than 0.05.';} document.getElementById('result_Q13_8').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to complete Q13.8</summary>
<div class="sourceCode cell-code" id="cb63" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>model5.int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> Age_c<span class="sc">:</span>Group <span class="sc">+</span> EduTotal_c<span class="sc">:</span>Group,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model5.int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q13.9</strong></span> Use the {visreg} package to visualise the interaction effect <code>EduTotal_c:Group</code> as predicted by your model. Looking at your plot of predicted values and partial residuals, which conclusion can you draw?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_9" onsubmit="return validate_form_Q13_9()" method="post">
<label>
<input type="radio" name="answer_Q13_9" id="answer_Q13_9_1" value="Years in formal education is a statistically significant predictor of Vocab scores for both L1 and L2 speakers, and there is no striking difference in the strength of this association between the L1 and the L2 group.">
Years in formal education is a statistically significant predictor of Vocab scores for both L1 and L2 speakers, and there is no striking difference in the strength of this association between the L1 and the L2 group.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_9" id="answer_Q13_9_2" value="Years in formal education is a statistically significant predictor of Vocab scores for L1 speakers, but not L2 speakers.">
Years in formal education is a statistically significant predictor of Vocab scores for L1 speakers, but not L2 speakers.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_9" id="answer_Q13_9_3" value="Years in formal education is a statistically significant predictor of Vocab scores for L2 speakers, but not L1 speakers.">
Years in formal education is a statistically significant predictor of Vocab scores for L2 speakers, but not L1 speakers.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_9" id="answer_Q13_9_4" value="The model makes almost perfect predictions for L1 speakers, but not L2 speakers.">
The model makes almost perfect predictions for L1 speakers, but not L2 speakers.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_9" id="answer_Q13_9_5" value="None of these conclusions can be drawn from the plot alone.">
None of these conclusions can be drawn from the plot alone.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_9"></div>
</form>
<script>function validate_form_Q13_9() {var x, text; var x = document.forms['form_Q13_9']['answer_Q13_9'].value;if (x == 'Years in formal education is a statistically significant predictor of Vocab scores for both L1 and L2 speakers, and there is no striking difference in the strength of this association between the L1 and the L2 group.'){text = 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.';} else {text = 'No. Remember that the strength of the association is represented by the gradient of the slope of the regression lines.';} document.getElementById('result_Q13_9').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_12413" onclick="return show_hint_12413()">🐭 Click on the mouse for a hint.</div>
<div id="result_12413" onclick="return show_hint_12413()"></div>
<script>function show_hint_12413(){var x = document.getElementById('result_12413').innerHTML; if(!x){document.getElementById('result_12413').innerHTML = 'Think about whether a horizontal line indicating no correlation (i.e. the null hypothesis) could be drawn within the confidence bands.';} else {document.getElementById('result_12413').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code to help you complete Q13.9</summary>
<div class="sourceCode cell-code" id="cb64" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model5.int, </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"EduTotal_c"</span>, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"Group"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>EduTotal), </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years in formal education"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<section id="interactions-between-two-numeric-predictors" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="interactions-between-two-numeric-predictors"><span class="header-section-number">13.6.1</span> Interactions between two numeric predictors</h3>
<p>We can also model interactions between two numeric predictors. For instance, we may hypothesise that the positive effect of time spent in formal education is moderated by age. If this interaction effect were negative, this would mean that, as people get older, the fact that they spent longer in formal education becomes less relevant to predict their current vocabulary knowledge.</p>
<p>Let’s add an <code>Age_c:EduTotal_c</code> interaction to our model to find out if our data support this hypothesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> Group <span class="sc">+</span> Age_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> Gender <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> Group<span class="sc">:</span>Age_c <span class="sc">+</span> Age_c<span class="sc">:</span>EduTotal_c,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Dabrowska.data)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ Group + Age_c + OccupGroup + Gender + Blocks_c + 
    EduTotal_c + Group:Age_c + Age_c:EduTotal_c, data = Dabrowska.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-68.346 -10.460   0.981  11.830  45.360 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       69.27826    3.65827  18.937  &lt; 2e-16 ***
GroupL2          -20.11637    3.51829  -5.718 5.89e-08 ***
Age_c              0.53820    0.14902   3.612 0.000418 ***
OccupGroupI        7.56857    5.53734   1.367 0.173781    
OccupGroupM       -4.14901    4.40173  -0.943 0.347449    
OccupGroupPS      -1.88806    4.29021  -0.440 0.660525    
GenderM           -1.74885    3.14526  -0.556 0.579044    
Blocks_c           1.24165    0.31409   3.953 0.000120 ***
EduTotal_c         2.66662    0.68007   3.921 0.000135 ***
GroupL2:Age_c     -0.87396    0.29409  -2.972 0.003464 ** 
Age_c:EduTotal_c  -0.01776    0.04520  -0.393 0.694947    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.17 on 146 degrees of freedom
Multiple R-squared:  0.4027,    Adjusted R-squared:  0.3618 
F-statistic: 9.842 on 10 and 146 DF,  p-value: 1.78e-12</code></pre>
</div>
</div>
<p>Looking at the last coefficient estimate in the model summary (<code>Age_c:EduTotal_c</code>), we can see that this second interaction coefficient is negative – in line with our hypothesis. However, this coefficient is also very small (<code>-0.01776</code>). Moreover, its associated <em>p</em>-value (<code>0.694947</code>) warns us that, if there were no interaction effect (i.e.&nbsp;under the null hypothesis), we would have a 69% probability of observing such a small effect in a dataset this size simply due to random variation alone.</p>
<p>The model summary also tells us that the amount of variance in <code>Vocab</code> scores that <code>model6</code> accounts for is 36.18% (<code>Adjusted R-squared:  0.3618</code>). This is actually slightly <em>less</em> than <code>model5</code> (<code>Adjusted R-squared:  0.3654</code>), which did not include this interaction. In other words, this additional interaction does not help us to model the association between our predictor variables and <code>Vocab</code> scores more accurately.</p>
<p>In <a href="#fig-PredictedVocabAgeByEdu" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>, we visualise this statistically non-significant interaction to better understand what it corresponds to. When used to visualise an interaction effect between two numeric predictors, the <code>visreg()</code> function automatically splits the second predictor variable (the “by” variable) into three categories corresponding to low, middle, and high values of the variable. It therefore shows the predicted effect of the numeric predictor predicted on the <em>x</em>-axis in these three different contexts. If, as in <a href="#fig-PredictedVocabAgeByEdu" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>, the three slopes are of the same gradient and the regression lines therefore run parallel to each other, this indicates that there is no noteworthy interaction between the two numeric predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model6,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"Age_c"</span>, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"EduTotal_c"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Age), </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PredictedVocabAgeByEdu" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three-panel plot showing predicted vocabulary scores versus age for different education levels, with partial residual points and blue regression lines with gray confidence bands. All three panels show positive correlations between age and vocabulary scores, with higher education levels showing higher predicted scores overall.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabAgeByEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeByEdu-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;13.7: Vocab scores as predicted by model6 for English speakers of various ages who were in formal education for a below-average, average, and above-average length of time (in blue) and partial model residuals (grey points)"><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeByEdu-1.png" class="img-fluid figure-img" alt="Three-panel plot showing predicted vocabulary scores versus age for different education levels, with partial residual points and blue regression lines with gray confidence bands. All three panels show positive correlations between age and vocabulary scores, with higher education levels showing higher predicted scores overall." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabAgeByEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: <code>Vocab</code> scores as predicted by <code>model6</code> for English speakers of various ages who were in formal education for a below-average, average, and above-average length of time (in blue) and partial model residuals (grey points)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Examining <a href="#fig-PredictedVocabAgeByEdu" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>, we can therefore conclude that the effect of age on <code>Vocab</code> scores is not moderated by the number of years that participants spent in formal education.</p>
<p>The <code>visreg()</code> function provides two ways to visualise interaction effects between two numeric variables: in <a href="#fig-PredictedVocabAgeByEdu" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>, below-average, average, and above-average number of years in formal education were visualised across three panels. <a href="#fig-PredictedVocabAgeRL" class="quarto-xref">Figure&nbsp;<span>13.8</span></a> shows the same predictions but, this time, the code includes the argument “overlay = TRUE”, which results in a single panel with three coloured regression lines superimposed. This can make it easier to check whether the lines are parallel. From <a href="#fig-PredictedVocabAgeRL" class="quarto-xref">Figure&nbsp;<span>13.8</span></a>, it is easier to see that the three lines are pretty much parallel to each other. This suggests that the positive effect of <code>Age</code> on <code>Vocab</code> scores does not change as a function of the number of years that participants were in formal education.</p>
<div class="cell" data-source-line-numbers="4">
<div class="sourceCode cell-code" id="cb68" data-source-line-numbers="4" data-code-line-numbers="4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(model6,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"Age_c"</span>, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"EduTotal_c"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">overlay =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(Dabrowska.data<span class="sc">$</span>Age), </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PredictedVocabAgeRL" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Visreg plot showing predicted vocabulary scores versus age for three education levels, with color-coded partial residual points and regression lines with confidence bands. The red line is rising from approximately 55 to 80, the green line is rising from about 65 to 90, and the blue lines is rising from approximately 75 to 95.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabAgeRL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeRL-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;13.8: Vocab scores as predicted by model4_c for English speakers of various ages who were in formal education for a below-average (red line), average (green line), and above-average (blue line) period of time and partial model residuals (coloured points)."><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabAgeRL-1.png" class="img-fluid figure-img" alt="Visreg plot showing predicted vocabulary scores versus age for three education levels, with color-coded partial residual points and regression lines with confidence bands. The red line is rising from approximately 55 to 80, the green line is rising from about 65 to 90, and the blue lines is rising from approximately 75 to 95." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabAgeRL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: <code>Vocab</code> scores as predicted by <code>model4_c</code> for English speakers of various ages who were in formal education for a below-average (red line), average (green line), and above-average (blue line) period of time and partial model residuals (coloured points).
</figcaption>
</figure>
</div>
</div>
</div>
<p>In order to interpret the output of a model featuring a significant interaction between two numeric predictors, we will now fit a simpler model predicting the <code>Vocab</code> scores of the L1 participants only (<code>L1.data</code>) using only two predictor variables: years in formal education (<code>EduTotal</code>) and Author Recognition Test (<code>ART</code>) scores.</p>
<p>The Author Recognition Test <span class="citation" data-cites="acheson2008">(<a href="99_references.html#ref-acheson2008" role="doc-biblioref">Acheson, Wells &amp; MacDonald 2008</a>)</span> is a measure of print exposure to literature, which is known to be a strong predictor of vocabulary knowledge (see <span style="color:green;"><strong>Your turn!</strong></span> in <a href="#sec-ModelPredictions" class="quarto-xref"><span>Section 13.4.1</span></a> above). This is confirmed in the L1 dataset as <code>ART</code> and <code>Vocab</code> scores are strongly correlated:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(L1.data<span class="sc">$</span>ART, L1.data<span class="sc">$</span>Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.6032758</code></pre>
</div>
</div>
<p>At the same time, we also know that there is a positive, though less strong, correlation between the number of years that L1 participants were in formal education and their <code>Vocab</code> test results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(L1.data<span class="sc">$</span>EduTotal, L1.data<span class="sc">$</span>Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.4268695</code></pre>
</div>
</div>
<p>In the following, we explore the possibility that this positive association between Author Recognition Test (<code>ART</code>) scores and <code>Vocab</code> scores may be moderated by the number of years spent in formal education (<code>EduTotal</code>). If this interaction effect were negative, this would mean that, if two individuals both have the same high <code>ART</code> score, but one spent longer in formal education, then the effect of those extra years of education would not be as strong as they would be for someone with a lower <code>ART</code> score. To test this hypothesis, we formulate the following null hypothesis:</p>
<ul>
<li><strong>H<sub>0</sub></strong>: The number of years spent in formal education does not moderate the association of L1 English speakers’ <code>ART</code> scores with their <code>Vocab</code> scores.</li>
</ul>
<p>We now fit a model to find out if we have enough evidence to reject this null hypothesis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we center the numeric variables in the L1 dataset:</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>L1.data <span class="ot">&lt;-</span> L1.data <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">EduTotal_c =</span> EduTotal <span class="sc">-</span> <span class="fu">median</span>(EduTotal),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Blocks_c =</span> Blocks <span class="sc">-</span> <span class="fu">median</span>(Blocks),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">Age_c =</span> Age <span class="sc">-</span> <span class="fu">median</span>(Age))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, we fit the model with both variables and their two-way interaction as predictors:</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>L1.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> ART <span class="sc">+</span> EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> L1.data)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we inspect the model:</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L1.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ ART + EduTotal_c + ART:EduTotal_c, data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-54.807  -6.113   0.065  10.927  26.379 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     51.9162     2.7622  18.795  &lt; 2e-16 ***
ART              1.3088     0.1955   6.696 2.09e-09 ***
EduTotal_c       5.2626     1.3272   3.965 0.000151 ***
ART:EduTotal_c  -0.1803     0.0530  -3.402 0.001017 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.18 on 86 degrees of freedom
Multiple R-squared:  0.4625,    Adjusted R-squared:  0.4437 
F-statistic: 24.67 on 3 and 86 DF,  p-value: 1.311e-11</code></pre>
</div>
</div>
<p>The model summary confirms that both predictors individually (i.e.&nbsp;as main effects) make statistically significant, positive contributions to the prediction of <code>Vocab</code> scores. Crucially, the summary also indicates that the interaction effect (<code>ART:EduTotal_c</code>) is statistically significant at α&nbsp;=&nbsp;0.05 (<em>p</em>&nbsp;=&nbsp;<code>0.001017</code>). The negative coefficient estimate of <code>-0.1803</code> means that, for each additional year of formal education, our model predicts that the effect of a participant’s <code>ART</code> score on <code>Vocab</code> decreases by 0.1803 points. In simpler terms, the positive effect of reading literature, as measured by the Author Recognition Test <span class="citation" data-cites="acheson2008">(<a href="99_references.html#ref-acheson2008" role="doc-biblioref">Acheson, Wells &amp; MacDonald 2008</a>)</span>, decreases slightly for every year spent in formal education.</p>
<p>Remember that, whenever we report an interaction, we can no longer interpret the estimated coefficients of the individual predictors in isolation. That is because we must also consider the interaction effect. To understand what this means in practice, let’s compare two speakers from the L1 dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>L1.data <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>, <span class="dv">18</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Occupation, OccupGroup, ART, EduTotal, Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>              Occupation OccupGroup ART EduTotal    Vocab
1 Student/Support Worker         PS  31       13 95.55556
2              Housewife          I  31       17 84.44444</code></pre>
</div>
</div>
<ul>
<li><p>Participant No.&nbsp;2 is a student and support worker with an ART score of 31 points, who has (so far) spent 13 years in formal education.</p></li>
<li><p>Participant No.&nbsp;18 is a housewife who also scored 31 points on the ART, but who was in formal education for a total of 17 years.</p></li>
</ul>
<p>In general, we can calculate the <code>Vocab</code> scores that our <code>L1.model</code> predicts by combining the model’s coefficient estimates like this:</p>
<blockquote class="blockquote">
<p>Intercept +<br>
<code>ART</code> coefficient*<code>ART</code> score +<br>
<code>EduTotal</code> coefficient*(<code>EduTotal</code> in years - median <code>EduTotal</code>) +<br>
<code>ART:EduTotal</code> coefficient*<code>ART</code> score*(<code>EduTotal</code> in years - median <code>EduTotal</code>)</p>
</blockquote>
<p>Based on the coefficient estimates of the model summary, we can therefore calculate the predicted <code>Vocab</code> score of the student / support worker as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="1">1</button><span id="annotated-cell-28-1" class="code-annotation-target"><a href="#annotated-cell-28-1" aria-hidden="true" tabindex="-1"></a><span class="fl">51.9162</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="2">2</button><span id="annotated-cell-28-2" class="code-annotation-target"><a href="#annotated-cell-28-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3088</span> <span class="sc">*</span> <span class="dv">31</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="3">3</button><span id="annotated-cell-28-3" class="code-annotation-target"><a href="#annotated-cell-28-3" aria-hidden="true" tabindex="-1"></a><span class="fl">5.2626</span> <span class="sc">*</span> (<span class="dv">13</span> <span class="sc">-</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="4">4</button><span id="annotated-cell-28-4" class="code-annotation-target"><a href="#annotated-cell-28-4" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.1803</span> <span class="sc">*</span> <span class="dv">31</span> <span class="sc">*</span> (<span class="dv">13</span> <span class="sc">-</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-28" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="1" data-code-annotation="1">Intercept coefficient</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="2" data-code-annotation="2">Main effect of 31 points on the ART test</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="3" data-code-annotation="3">Main effect of 13 years in formal education</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="4" data-code-annotation="4">Interaction effect between 31 points on the ART and having spent 13 years in formal education</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 92.489</code></pre>
</div>
</div>
<p>And similarly for the housewife with the same ART score:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-1" class="code-annotation-target"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a><span class="fl">51.9162</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="2">2</button><span id="annotated-cell-29-2" class="code-annotation-target"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3088</span> <span class="sc">*</span> <span class="dv">31</span> <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="3">3</button><span id="annotated-cell-29-3" class="code-annotation-target"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a><span class="fl">5.2626</span> <span class="sc">*</span> (<span class="dv">17</span> <span class="sc">-</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="4">4</button><span id="annotated-cell-29-4" class="code-annotation-target"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.1803</span> <span class="sc">*</span> <span class="dv">31</span> <span class="sc">*</span> (<span class="dv">17</span> <span class="sc">-</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="1" data-code-annotation="1">Intercept coefficient</span>
</dd>
<dt data-target-cell="annotated-cell-29" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="2" data-code-annotation="2">Main effect of 31 points on ART test</span>
</dd>
<dt data-target-cell="annotated-cell-29" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="3" data-code-annotation="3">Main effect of 17 years in formal education</span>
</dd>
<dt data-target-cell="annotated-cell-29" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="4" data-code-annotation="4">Interaction effect between scoring 31 points on the ART and having spent 17 years in formal education</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 91.1822</code></pre>
</div>
</div>
<p>We can check that we did the maths correctly by checking the model’s prediction for these two individuals. Remember that minor differences after the decimal point are due to us using rounded coefficient estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(L1.model)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>       2 
92.49038 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(L1.model)[<span class="dv">18</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>      18 
91.18172 </code></pre>
</div>
</div>
<p>Notice how these two predicted scores are very similar, even though the housewife spent longer in formal education than the student / support worker. This is because, for L1 speakers, greater print exposure and more education generally lead to a larger vocabulary (as indicated by the positive main-effect coefficient estimates in <code>L1.model</code>), but the increase in vocabulary for each additional year of education is predicted to be smaller for individuals with higher ART scores.</p>
<p><a href="#fig-VocabEduART" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> visualises the predictions of <code>L1.model</code>. How can we interpret these three regression lines?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code to generate plot.</summary>
<div class="sourceCode cell-code" id="cb83" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(L1.model,</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"EduTotal_c"</span>, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"ART"</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal), </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years in formal education"</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-VocabEduART" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three-panel plot showing predicted vocabulary scores versus years in formal education for three ART scores (3, 10, and 31), with partial residual points and blue regression lines with gray confidence bands. The left panel (ART: 3) shows a strong positive correlation, the middle panel (ART: 10) shows a moderate positive correlation, and the right panel (ART: 31) shows a nearly flat but negative relationship around 90.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VocabEduART-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-VocabEduART-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;13.9: Vocab scores as predicted by L1.model (in blue) and partial model residuals (grey points) as a function of the number of years speakers were in formal education and for three ART test scores"><img src="13_MultipleLinearRegression_files/figure-html/fig-VocabEduART-1.png" class="img-fluid figure-img" alt="Three-panel plot showing predicted vocabulary scores versus years in formal education for three ART scores (3, 10, and 31), with partial residual points and blue regression lines with gray confidence bands. The left panel (ART: 3) shows a strong positive correlation, the middle panel (ART: 10) shows a moderate positive correlation, and the right panel (ART: 31) shows a nearly flat but negative relationship around 90." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VocabEduART-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: <code>Vocab</code> scores as predicted by <code>L1.model</code> (in blue) and partial model residuals (grey points) as a function of the number of years speakers were in formal education and for three ART test scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>For low and mid-level ART scores, the model predicts a positive correlation between the number of years a participant has spent in formal education and their predicted <code>Vocab</code> scores. However, this is not the case for participants who scored high on the ART test (third panel). The three regression lines representing the model’s predicted scores are clearly not parallel, and it would not be possible to draw three parallel lines that each stay within their respective 95% confidence bands. This confirms that, in this L1 model, the interaction between ART scores and years in formal education is statistically significant at α&nbsp;=&nbsp;0.05. The main effects of these two predictors cannot be meaningfully interpreted without considering this interaction.</p>
</section>
</section>
<section id="model-selection" class="level2 page-columns page-full" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="model-selection"><span class="header-section-number">13.7</span> Model selection</h2>
<p>Typically, the more predictors we enter in a model, the better the model fits the data. However, having predictors that contribute very little to the model and/or whose contributions are not statistically significant risks lowering the accuracy of the model’s predictions on new data. In this case, we say that the model <strong>overfits</strong>. A model that overfits the sample data risks not generalising to other data. If the aim of our statistical modelling is to infer from our sample to the general population (see <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>), it can sometimes make sense to try to find an ‘optimal’ model that accounts for as much of the variance in the outcome variable as possible whilst relying only on association effects that we can be fairly confident could not have occurred due to chance only. This is where model selection comes into play.</p>
<p>Some people consider model selection to be a bit of an art. This chapter only aims to introduce the topic and does not cover — let alone compare or endorse — different model selection procedures. Ultimately, what really matters is that, <em>if</em> we intend to apply a model selection procedure, we decide on the method <em>before</em> analysing the data. This is because method selection bears the very real risk of (consciously or unconsciously) “fishing” for statistically significant results. Fishing is a highly Questionable Research Practice (QRP, see <a href="11_Inferential.html#sec-pHacking" class="quarto-xref"><span>Section 11.7</span></a>) that consists in trying out different methods until we arrive at findings that match our theory and/or hypotheses. For this reason, selection procedures in regression modelling have been heavily criticised over the years and there are very good arguments for not engaging in any model selection at all <span class="citation" data-cites="thompsonStepwiseRegressionStepwise1995 smithStepAwayStepwise2018 harrellRegressionModelingStrategies2015">(<a href="99_references.html#ref-thompsonStepwiseRegressionStepwise1995" role="doc-biblioref">Thompson 1995</a>; <a href="99_references.html#ref-smithStepAwayStepwise2018" role="doc-biblioref">Smith 2018</a>; <a href="99_references.html#ref-harrellRegressionModelingStrategies2015" role="doc-biblioref">Harrell 2015</a>: Section 4.3)</span>.</p>
<blockquote class="blockquote">
<p>A fundamental problem with stepwise regression is that some real explanatory variables that have causal effects on the dependent variable may happen to not be statistically significant, while nuisance variables may be coincidentally significant. As a result, the model may fit the data well in-sample, but do poorly out-of-sample. <span class="citation" data-cites="smithStepAwayStepwise2018">(<a href="99_references.html#ref-smithStepAwayStepwise2018" role="doc-biblioref">Smith 2018</a>: 1)</span></p>
</blockquote>
<p>Nonetheless, in the following section, we will see how we might - <em>if</em> we decide to narrow down predictor variables using model selection - arrive at an optimal model of <code>Vocab</code> scores among L1 and L2 speakers of English using the <strong>adjusted R<sup>2</sup></strong> as our model selection decision criterion. Recall that R<sup>2</sup> values correspond to the amount of variance in the outcome variable that a model can predict. The adjusted R<sup>2</sup> is particularly useful because it is adjusted for the number of predictors entered in the model; models with more predictors are penalised.</p>
<blockquote class="blockquote">
<p>When using adjusted R<sup>2</sup> as the decision criterion, we seek to eliminate or add predictors depending on whether they lead to the largest improvement in adjusted R<sup>2</sup> and we stop when adding or eliminating another predictor does not lead to further improvement in adjusted R<sup>2</sup>.</p>
<p>Adjusted R<sup>2</sup> describes the strength of a model fit, and it is a useful tool for evaluating which predictors are adding value to the model, where <em>adding value</em> means they are (likely) improving the accuracy in predicting future outcomes. <span class="citation" data-cites="cetinkaya-rundelIntroductionModernStatistics2021">(<a href="99_references.html#ref-cetinkaya-rundelIntroductionModernStatistics2021" role="doc-biblioref">Çetinkaya-Rundel &amp; Hardin 2021</a>: <a href="https://openintro-ims.netlify.app/model-mlr#sec-model-selection">Section 8.4</a>)</span></p>
</blockquote>
<p>There are two common ways to add or remove predictors in a multiple regression model. These are called backward elimination and forward selection. They are often called <strong>stepwise selection</strong> because they add or remove one variable at a time.</p>
<blockquote class="blockquote">
<p><strong>Backward elimination</strong> starts with the full model – the model that includes all potential predictor variables. Predictors are eliminated one-at-a-time from the model until we cannot improve the model any further.</p>
<p><strong>Forward selection</strong> is the reverse of the backward elimination technique. Instead of eliminating predictors one-at-a-time, we add predictors one-at-a-time until we cannot find any predictors that improve the model any further. <span class="citation" data-cites="cetinkaya-rundelIntroductionModernStatistics2021">(<a href="99_references.html#ref-cetinkaya-rundelIntroductionModernStatistics2021" role="doc-biblioref">Çetinkaya-Rundel &amp; Hardin 2021</a>: <a href="https://openintro-ims.netlify.app/model-mlr#sec-model-selection">Section 8.4</a>)</span></p>
</blockquote>
<p>We will use backward elimination as it allows us to start with a <strong>full model</strong> that includes all the predictors and any interactions that we believe are justified on the basis of theory and/or prior research. At this stage, it is absolutely crucial to think about which variables and which interactions are genuinely meaningful and which are not!</p>
<p>With the <span class="citation" data-cites="DabrowskaExperienceAptitudeIndividual2019">Dąbrowska (<a href="99_references.html#ref-DabrowskaExperienceAptitudeIndividual2019" role="doc-biblioref">2019</a>)</span> data, several full models can be justified. In this section, we will attempt to model <code>Vocab</code> scores among L1 participants using four predictors (<code>ART</code>, <code>Blocks_c</code>, <code>Age_c</code>, <code>EduTotal_c</code>, and <code>OccupGroup</code>) and the following four interactions (<code>ART:EduTotal_c</code>, <code>Blocks_c:EduTotal_c</code>, <code>ART:Age_c</code>, and <code>Blocks:Age_c</code>). We can justify this choice of predictors based on our current understanding of language learning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>L1.model.full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> Age_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c <span class="sc">+</span> Blocks_c<span class="sc">:</span>EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>Age_c <span class="sc">+</span> Blocks_c<span class="sc">:</span>Age_c, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> L1.data)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L1.model.full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ ART + Blocks_c + Age_c + EduTotal_c + OccupGroup + 
    ART:EduTotal_c + Blocks_c:EduTotal_c + ART:Age_c + Blocks_c:Age_c, 
    data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.927  -4.064  -0.374   8.295  28.282 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         53.1677121  3.7269444  14.266  &lt; 2e-16 ***
ART                  1.1304963  0.2330505   4.851 6.16e-06 ***
Blocks_c             1.4066157  0.3164938   4.444 2.88e-05 ***
Age_c                0.5955643  0.1895092   3.143  0.00237 ** 
EduTotal_c           4.4423564  1.3560678   3.276  0.00157 ** 
OccupGroupI          4.0757889  4.7833634   0.852  0.39678    
OccupGroupM          0.1584647  4.3523775   0.036  0.97105    
OccupGroupPS         0.4096426  4.3947432   0.093  0.92597    
ART:EduTotal_c      -0.1523719  0.0513417  -2.968  0.00398 ** 
Blocks_c:EduTotal_c -0.1428729  0.1311735  -1.089  0.27942    
ART:Age_c           -0.0125418  0.0096286  -1.303  0.19656    
Blocks_c:Age_c      -0.0007549  0.0194954  -0.039  0.96921    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.45 on 78 degrees of freedom
Multiple R-squared:  0.6172,    Adjusted R-squared:  0.5632 
F-statistic: 11.43 on 11 and 78 DF,  p-value: 2.492e-12</code></pre>
</div>
</div>
<p>Our full model has an adjusted R<sup>2</sup> of <code>0.5632</code>, which means that the combination of these variables and the four interactions account for about 56% of the variance in <code>Vocab</code> scores in the L1 data. However, many of the model coefficients in <code>L1.model.full</code> are not statistically significant, so we could try to remove them to see whether this leads to a lower adjusted R<sup>2</sup> or not. Strictly speaking, a stepwise selection procedure would entail removing each interaction one-by-one. To save space here, we remove all three non-significant interaction terms in a single backward step:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>L1.model.back1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> Age_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> OccupGroup <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> L1.data)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L1.model.back1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ ART + Blocks_c + Age_c + EduTotal_c + OccupGroup + 
    ART:EduTotal_c, data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.282  -4.835   0.367   8.867  29.110 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    53.61458    3.60809  14.860  &lt; 2e-16 ***
ART             0.97262    0.20158   4.825 6.48e-06 ***
Blocks_c        1.37827    0.31278   4.407 3.19e-05 ***
Age_c           0.42996    0.13122   3.276  0.00155 ** 
EduTotal_c      4.17372    1.30919   3.188  0.00204 ** 
OccupGroupI     4.00028    4.65106   0.860  0.39228    
OccupGroupM     0.74751    4.29748   0.174  0.86235    
OccupGroupPS   -0.22682    4.17410  -0.054  0.95680    
ART:EduTotal_c -0.13709    0.04903  -2.796  0.00646 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.38 on 81 degrees of freedom
Multiple R-squared:  0.6067,    Adjusted R-squared:  0.5679 
F-statistic: 15.62 on 8 and 81 DF,  p-value: 1.153e-13</code></pre>
</div>
</div>
<p>This procedure has actually led to a (very) small increase in our adjusted R<sup>2</sup>, which is now <code>0.5679</code>, or 57%. Can we simplify our model even further and still account for as much variance in <code>Vocab</code> scores by dropping categorical predictor variable <code>OccupGroup</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>L1.model.back2 <span class="ot">&lt;-</span>  <span class="fu">lm</span>(Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> Age_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> L1.data)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L1.model.back2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ ART + Blocks_c + Age_c + EduTotal_c + ART:EduTotal_c, 
    data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-43.379  -5.410   0.824   8.369  32.573 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     54.2022     2.4512  22.113  &lt; 2e-16 ***
ART              0.9970     0.1922   5.187 1.46e-06 ***
Blocks_c         1.3251     0.3030   4.373 3.49e-05 ***
Age_c            0.4843     0.1092   4.434 2.78e-05 ***
EduTotal_c       4.3116     1.2812   3.365  0.00115 ** 
ART:EduTotal_c  -0.1472     0.0471  -3.125  0.00244 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.21 on 84 degrees of freedom
Multiple R-squared:  0.6025,    Adjusted R-squared:  0.5788 
F-statistic: 25.46 on 5 and 84 DF,  p-value: 1.521e-15</code></pre>
</div>
</div>
<p>This new model has a slightly higher adjusted R<sup>2</sup> (<code>0.5788</code>), so it looks like this was another sensible simplification of our model. All of the remaining coefficient estimates in <code>L1.model.back2</code> make statistically significant contributions to the model. If we try to remove one, we can expect that the amount of variance that our model can account for will drop. For example, we can try to remove <code>Age</code> as a predictor from our model to see what happens:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>L1.model.back3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c, </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> L1.data)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L1.model.back3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = Vocab ~ ART + Blocks_c + EduTotal_c + ART:EduTotal_c, 
    data = L1.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.816  -7.486  -0.458   9.970  26.546 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    52.08245    2.65487  19.618  &lt; 2e-16 ***
ART             1.38099    0.18951   7.287  1.5e-10 ***
Blocks_c        0.90754    0.31806   2.853  0.00543 ** 
EduTotal_c      3.59093    1.40344   2.559  0.01228 *  
ART:EduTotal_c -0.15028    0.05201  -2.890  0.00489 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.59 on 85 degrees of freedom
Multiple R-squared:  0.5095,    Adjusted R-squared:  0.4864 
F-statistic: 22.07 on 4 and 85 DF,  p-value: 1.615e-12</code></pre>
</div>
</div>
<p>Indeed, <code>L1.model.back3</code> accounts for 49% of the variance (adjusted R<sup>2</sup> = <code>0.4864</code>), which is considerably less than <code>L1.model.back2</code>. We will therefore report and interpret <code>L1.model.back2</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reporting a multiple regression model
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are many ways to report the <strong>numerical</strong> results of a statistical model. Researchers typically include a table reporting the model’s coefficient estimates (sometimes referred to as β, “beta”), together with a measure of variability around these estimates (e.g., standard error or confidence intervals), as well as their associated <em>p</em>-values. In addition, it is important to report the accuracy of the model. Different so-called <strong>goodness-of-fit measures</strong> are used for this; one of the most common being the adjusted coefficient of determination, R<sup>2</sup>. The output of the <code>summary()</code> function includes all of these statistics and is therefore suitable for a research report.</p>
<p>Alternatively, the <a href="https://strengejacke.github.io/sjPlot/">{sjPlot}</a> library <span class="citation" data-cites="lüdecke2020">(<a href="99_references.html#ref-lüdecke2020" role="doc-biblioref">Lüdecke 2020</a>)</span> includes a handy function that produces nicely formatted tables to report all kinds of models, including multiple linear regression models. When you run the <code>tab_model()</code> function in RStudio, the table will be displayed in the Viewer pane. By default, it includes the model’s coefficient estimates and 95% confidence intervals around these estimates, as well as <em>p</em>-values formatted in bold if they are below 0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sjPlot"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(L1.model.back2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Vocab</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">54.20</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">49.33&nbsp;–&nbsp;59.08</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">ART</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.61&nbsp;–&nbsp;1.38</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Blocks c</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.33</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.72&nbsp;–&nbsp;1.93</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Age c</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.48</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.27&nbsp;–&nbsp;0.70</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">EduTotal c</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.76&nbsp;–&nbsp;6.86</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">ART × EduTotal c</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.24&nbsp;–&nbsp;-0.05</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.002</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">90</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.603 / 0.579</td>
</tr>
</tbody>
</table>
</div>
</div>

<p>Check the documentation of the <code>tab_model()</code> function and the <a href="https://strengejacke.github.io/sjPlot/">sjPlot website</a> to learn about its many useful formatting options:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>?tab_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is also recommended to <strong>visualise</strong> the model’s predictions and its (partial) residuals. Again, there are many ways to achieve this in <code>R</code>, but we will stick to using the {visreg} library. Run the following command and follow the instructions displayed in the Console to view all the plots in RStudio. You may need to resize your Plot pane or use the Zoom button to properly view the plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(L1.model.back2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running the <code>visreg()</code> function on this multiple regression model outputs several warning messages in the Console. These messages are important and should not be ignored:</p>
<pre data-code-line-numbers=""><code>Note that you are attempting to plot a 'main effect' in a model that contains an interaction. This is potentially misleading; you may wish to consider using the 'by' argument.</code></pre>
<p>The message warns us that we should not attempt to interpret <code>ART</code> and <code>EduTotal_c</code> as <strong>main effects</strong> because our model includes an <strong>interaction</strong> that involves these two variables. Indeed, the fourth plot (see <a href="#fig-PredictedVocabEduL1" class="quarto-xref">Figure&nbsp;<span>13.10</span></a>) suggests that the more years an L1 speaker spends in formal education, the greater their <code>Vocab</code> score; however, because our model includes an interaction effect, the authors of the {visreg} package are warning us that the strength or even the direction of this effect could change depending on individuals’ <code>ART</code> score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(<span class="at">fit =</span> L1.model.back2, </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"EduTotal_c"</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal), </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years in formal education"</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Conditions used in construction of plot
ART: 10.5
Blocks_c: 0
Age_c: 0</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-PredictedVocabEduL1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing predicted vocabulary scores versus years in formal education for L1 speakers, with partial residual points and a blue regression line with gray confidence band. The plot shows a positive correlation, with predicted scores increasing from approximately 57 at 10 years of education to approximately 87 at 21 years of education.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabEduL1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabEduL1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;13.10: Predicted vocabulary scores for L1 speakers as a function of the number of years that they were in formal education (in blue) and partial residuals (grey points)."><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabEduL1-1.png" class="img-fluid figure-img" alt="Scatter plot showing predicted vocabulary scores versus years in formal education for L1 speakers, with partial residual points and a blue regression line with gray confidence band. The plot shows a positive correlation, with predicted scores increasing from approximately 57 at 10 years of education to approximately 87 at 21 years of education." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabEduL1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.10: Predicted vocabulary scores for L1 speakers as a function of the number of years that they were in formal education (in blue) and partial residuals (grey points).
</figcaption>
</figure>
</div>
</div>
</div>
<p>As suggested by the warning message, we can (and should!) visualise interactions like this one using the “by” argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(<span class="at">fit =</span> L1.model.back2, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"EduTotal_c"</span>, </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtrans =</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="fu">median</span>(L1.data<span class="sc">$</span>EduTotal), </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"ART"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">gg =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years in formal education"</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Vocab scores"</span>) <span class="sc">+</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PredictedVocabEduLit" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three-panel plot showing predicted vocabulary scores versus years in formal education for L1 speakers at different ART scores (3, 10, and 31), with partial residual points and blue regression lines with gray confidence bands. The relationship between education and vocabulary scores weakens with higher ART scores.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PredictedVocabEduLit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabEduLit-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;13.11: Predicted vocabulary scores for L1 speakers as a function of the number of years that they were in formal education and across three different ART scores (in blue) and partial residuals (grey points)."><img src="13_MultipleLinearRegression_files/figure-html/fig-PredictedVocabEduLit-1.png" class="img-fluid figure-img" alt="Three-panel plot showing predicted vocabulary scores versus years in formal education for L1 speakers at different ART scores (3, 10, and 31), with partial residual points and blue regression lines with gray confidence bands. The relationship between education and vocabulary scores weakens with higher ART scores." width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PredictedVocabEduLit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.11: Predicted vocabulary scores for L1 speakers as a function of the number of years that they were in formal education and across three different ART scores (in blue) and partial residuals (grey points).
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-PredictedVocabEduLit" class="quarto-xref">Figure&nbsp;<span>13.11</span></a> shows the predicted effect of the number of years in formal education on <code>Vocab</code> scores for participants who scored 3, 10, and 31 points on the <code>ART</code>. The regression line shows a positive relation between <code>Vocab</code> scores and years in formal education for below-average and average <code>ART</code> scores, but the regression line is almost flat for above-average <code>ART</code> scores. This indicates that, for individuals who score very high on the <code>ART</code>, years in education is no longer a useful predictor of their <code>Vocab</code> scores.</p>
<p>Finally, we should also report the outcome of our model assumption checks. This is covered in the following section.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="callout-margin-content">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/hex_sjPlot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Hex sticker of the {sjPlot} package"><img src="images/hex_sjPlot.png" class="img-fluid figure-img" width="100" alt="Hex sticker of the {sjPlot} package"></a></p>
<figcaption>Hex sticker of the <a href="https://strengejacke.github.io/sjPlot/">{sjPlot}</a> package</figcaption>
</figure>
</div>
</div></div></section>
<section id="sec-ModelAssumptions" class="level2 page-columns page-full" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="sec-ModelAssumptions"><span class="header-section-number">13.8</span> Checking model assumptions</h2>
<p>As we saw in <a href="12_SimpleLinearRegression.html#sec-AssumptionsLR" class="quarto-xref"><span>Section 12.4</span></a>, it is crucial that we check that our models meet the assumptions of linear regression models before we interpret them because, if they don’t, our models may be unreliable. In some cases, modelling issues may already be visible from the model summary. Warning signs include very large model residuals, coefficient estimates reported as <code>NA</code>, and warning messages stating that the model is “singular” or that it has “failed to converge”.</p>
<p>These problems can occur for a number of reasons, but most often because the model is too complex given the data available: the sample size may be too small or the data too sparse for certain combinations of predictors (e.g.&nbsp;if you try to enter gender and native language as predictors in a model, but for some languages only female native speakers are represented in the dataset). There are often ways around these issues, but they are beyond the scope of this introductory textbook (see recommended readings below and <a href="https://elenlefoll.github.io/RstatsTextbook/A_FurtherResources.html">next-step resources</a>).</p>
<p>The model assumptions for multiple linear regression models are the same as for simple linear regression models (see <a href="12_SimpleLinearRegression.html#sec-AssumptionsLR" class="quarto-xref"><span>Section 12.4</span></a>):</p>
<ul>
<li>Independence of the data points (see <a href="11_Inferential.html#sec-Independence" class="quarto-xref"><span>Section 11.6.2</span></a> and <a href="12_SimpleLinearRegression.html#sec-IndependenceSLR" class="quarto-xref"><span>Section 12.4.1</span></a>)</li>
<li>Linear relationships between the predictors (see <a href="11_Inferential.html#sec-Linearity" class="quarto-xref"><span>Section 11.6.4</span></a> and <a href="12_SimpleLinearRegression.html#sec-LinearitySLR" class="quarto-xref"><span>Section 12.4.2</span></a>)</li>
<li>Homogeneity of the model residuals (see <a href="11_Inferential.html#sec-Homoscedasticity" class="quarto-xref"><span>Section 11.6.5</span></a> and <a href="12_SimpleLinearRegression.html#sec-Residuals" class="quarto-xref"><span>Section 12.4.3</span></a>)</li>
<li>Normality of the model residuals (see <a href="11_Inferential.html#sec-Normality" class="quarto-xref"><span>Section 11.6.3</span></a>)</li>
<li>No overly influential outliers (see <a href="11_Inferential.html#sec-Linearity" class="quarto-xref"><span>Section 11.6.4</span></a>)</li>
</ul>
<p>There is only one additional assumption that is specific to models that include multiple predictors:</p>
<ul>
<li>No multicollinearity</li>
</ul>
<p>In the following, we use the <code>check_model()</code> function from the {<a href="https://easystats.github.io/performance">performance</a>} package <span class="citation" data-cites="ludeckePerformancePackageAssessment2021">(<a href="99_references.html#ref-ludeckePerformancePackageAssessment2021" role="doc-biblioref">Lüdecke, Ben-Shachar, et al. 2021</a>)</span> to check these assumptions graphically. The <code>check_model()</code> function also requires the installation of the {<a href="https://aloy.github.io/qqplotr/index.html">qqplotr</a>} <span class="citation" data-cites="almeidaGgplot2CompatibleQuantilequantile2018">(<a href="99_references.html#ref-almeidaGgplot2CompatibleQuantilequantile2018" role="doc-biblioref">Almeida, Loy &amp; Hofmann 2018</a>)</span> and {<a href="https://easystats.github.io/see/">see</a>} <span class="citation" data-cites="ludeckeSeePackageVisualizing2021">(<a href="99_references.html#ref-ludeckeSeePackageVisualizing2021" role="doc-biblioref">Lüdecke, Patil, et al. 2021</a>)</span> packages to work.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/hex_performance.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Hex sticker of the {performance} package"><img src="images/hex_performance.png" class="img-fluid figure-img" width="100" alt="Hex sticker of the {performance} package"></a></p>
<figcaption>Hex sticker of the <a href="https://easystats.github.io/performance/">{performance}</a> package</figcaption>
</figure>
</div>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb99" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"performance"</span>, <span class="st">"qqplotr"</span>, <span class="st">"see"</span>))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running the function on the saved model object should generate a large figure comprising six plots<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (see <a href="#fig-6plots" class="quarto-xref">Figure&nbsp;<span>13.12</span></a>). In the following, we will learn to interpret them one-by-one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(L1.model.back2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-6plots" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Six-panel plot for linear regression model assessment. Posterior Predictive Check shows green model-predicted density curve closely overlapping blue observed data density; Linearity plot shows residuals versus fitted values with points scattered around a horizontal dashed reference line. Homogeneity of Variance shows square root of absolute residuals versus fitted values with a green trend line; Influential Observations shows standardized residuals versus leverage. Collinearity shows VIF values for predictors in blue; Normality of Residuals shows standard normal distribution quantiles and sample quantile deviations.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-6plots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;13.12: Six plots output by the check_model() function for assessing key assumptions of linear regression models"><img src="13_MultipleLinearRegression_files/figure-html/fig-6plots-1.png" class="img-fluid figure-img" alt="Six-panel plot for linear regression model assessment. Posterior Predictive Check shows green model-predicted density curve closely overlapping blue observed data density; Linearity plot shows residuals versus fitted values with points scattered around a horizontal dashed reference line. Homogeneity of Variance shows square root of absolute residuals versus fitted values with a green trend line; Influential Observations shows standardized residuals versus leverage. Collinearity shows VIF values for predictors in blue; Normality of Residuals shows standard normal distribution quantiles and sample quantile deviations." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.12: Six plots output by the <code>check_model()</code> function for assessing key assumptions of linear regression models
</figcaption>
</figure>
</div>
</div>
</div>
<p>By default, <code>check_model()</code> outputs a single figure that allows us to check the most important model assumptions. This large figure is useful for reporting purposes, but it is rather unwieldy for interpretation. Changing the “panel” argument of the <code>check_model()</code> function to <code>FALSE</code> returns a list of {ggplot} objects that we can save to our local environment as <code>diagnostic.plots</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_model</span>(L1.model.back2, <span class="at">panel =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can use the double square bracket operator to display a single diagnostic plot from this saved list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-PosteriorPredictiveCheck" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PosteriorPredictiveCheck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-PosteriorPredictiveCheck-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;13.13: Comparing the distribution of observed vocabulary scores (green) with data simulated based on model predictions (blue)"><img src="13_MultipleLinearRegression_files/figure-html/fig-PosteriorPredictiveCheck-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PosteriorPredictiveCheck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.13: Comparing the distribution of observed vocabulary scores (green) with data simulated based on model predictions (blue)
</figcaption>
</figure>
</div>
</div>
</div>
<p>This first plot (<a href="#fig-PosteriorPredictiveCheck" class="quarto-xref">Figure&nbsp;<span>13.13</span></a>) is another way to compare the model’s predicted values (represented as here blue distributions) with the real-life (i.e observed) outcome variable (represented here in green). We can see that the center of the distribution of observed <code>Vocab</code> scores is slightly shifted to the right compared to most distributions of model-predicted data. That said, the simulated distributions are close to the real distribution and largely follow a similar shape. If they didn’t, this would suggest that a linear regression model may not be suitable for our data.</p>
<p>The second plot (<a href="#fig-Linearity" class="quarto-xref">Figure&nbsp;<span>13.14</span></a>) is designed to check the assumption of <strong>linearity</strong>. If the predictors are linearly related, the green reference line should be flat and horizontal. Our reference line is slightly curved, but it remains possible to draw a horizontal line through the grey band, hence we can conclude that the assumption of linearity is not severely violated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-Linearity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;13.14: The relationship between model predictions (fitted values) and model residuals"><img src="13_MultipleLinearRegression_files/figure-html/fig-Linearity-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.14: The relationship between model predictions (fitted values) and model residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that <a href="#fig-Linearity" class="quarto-xref">Figure&nbsp;<span>13.14</span></a> is actually the same kind of plot as <a href="12_SimpleLinearRegression.html#fig-VocabResidual" class="quarto-xref">Figure&nbsp;<span>12.11</span></a> that we generated to check the assumption of equal (or constant) variance, i.e.&nbsp;<strong>homoscedasticity</strong>. Fitted values is another term for predicted values. Thus, in <a href="#fig-Linearity" class="quarto-xref">Figure&nbsp;<span>13.14</span></a>, the <em>x</em>-axis represents the <code>Vocab</code> scores predicted by the model. When the assumption of homoscedasticity is met, the model residuals are randomly distributed above and below 0, i.e.&nbsp;they do not notably increase or decrease as predicted values increase.</p>
<p>The {performance} package proposes a different kind of diagnostic plot to check the assumption of <strong>homoscedasticity</strong> (see <a href="#fig-Homoscedasticity" class="quarto-xref">Figure&nbsp;<span>13.15</span></a>) with the square-root of the absolute standardised residuals on the <em>y</em>-axis. A roughly flat and horizontal green reference line indicates homoscedasticity. Again, although the reference line in <a href="#fig-Homoscedasticity" class="quarto-xref">Figure&nbsp;<span>13.15</span></a> is by no means perfectly flat, a flat line can be drawn within the grey band, suggesting that the assumption is met.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Homoscedasticity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Homoscedasticity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-Homoscedasticity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;13.15: The relationship between the model predictions (fitted values) and the square root of absolute standardised residuals"><img src="13_MultipleLinearRegression_files/figure-html/fig-Homoscedasticity-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Homoscedasticity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.15: The relationship between the model predictions (fitted values) and the square root of absolute standardised residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p>The fourth diagnostic plot (<a href="#fig-Influential" class="quarto-xref">Figure&nbsp;<span>13.16</span></a>) helps to detect <strong>outliers</strong> in the data that may have a particularly strong influence on our model. It is based on Cook’s distance <span class="citation" data-cites="LevshinaHowlinguisticsData2015 sondereggerRegressionModelingLinguistic2023">(see <a href="99_references.html#ref-LevshinaHowlinguisticsData2015" role="doc-biblioref">Levshina 2015</a>: Section 7.2.4; <a href="99_references.html#ref-sondereggerRegressionModelingLinguistic2023" role="doc-biblioref">Sonderegger 2023</a>: Section 5.7.3)</span>. Any points that fall outside the dashed green lines fall outside Cook’s distance and are considered <strong>influential observations</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Influential" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Influential-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-Influential-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;13.16: The relationship between leverage as estimated using Cook’s distance and standardised residuals"><img src="13_MultipleLinearRegression_files/figure-html/fig-Influential-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Influential-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.16: The relationship between leverage as estimated using Cook’s distance and standardised residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-Influential" class="quarto-xref">Figure&nbsp;<span>13.16</span></a>, no data point falls outside of Cook’s distance so we are not concerned about influential observations violating the assumptions of our model. Still, it is interesting to briefly explore the most influential observations, which are labelled by their index number in the dataset. In <a href="#fig-Influential" class="quarto-xref">Figure&nbsp;<span>13.16</span></a>, one of these is participant number&nbsp;21:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>L1.data <span class="sc">|&gt;</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">21</span>) <span class="sc">|&gt;</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, Occupation, Blocks, EduTotal, ART, Vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  Age Gender      Occupation Blocks EduTotal ART    Vocab
1  41      F Senior Lecturer      9       21  43 93.33333</code></pre>
</div>
</div>
<p>As you can see, this female senior lecturer is rather unusual: she performed below average in the non-verbal IQ test (<code>Blocks</code>), yet achieved the second-highest <code>Vocab</code> score. She also performed far above average on the author recognition test (<code>ART</code>) and reported the longest period in formal education among the L1 participants (<code>EduTotal</code>).</p>
<p>In some cases, it may be justified to remove overly influential outliers; however, this should typically only be done when we are fairly certain that the outliers were caused by a technical error, such as a measuring instrument not functioning properly, or a human error, such as a participant misunderstanding the direction of a response scale. All other outliers may be theoretically interesting: if our aim is to generalise our model to the full population, we must be prepared to include some unusual observations that also belong to that population. In the case of L1 English speakers, this includes people who spent more than 20 years in formal education and are seemingly much more into languages than the kind of abstract puzzles typically found in non-verbal IQ tests!</p>
<p>The fifth diagnostic plot output by the <code>check_model()</code> function (<a href="#fig-Collinearity" class="quarto-xref">Figure&nbsp;<span>13.17</span></a>) serves to check the assumption of a no <strong>multicollinearity</strong>. Multicollinearity, or <strong>high collinearity</strong>, refers to a strong linear dependence between predictors such that they do not contribute unique or independent information to the model. Multicollinearity should not be confused with a strong correlation between two individual predictors as measured using the <code>cor.test()</code> function (see <a href="11_Inferential.html#sec-Correlations" class="quarto-xref"><span>Section 11.5</span></a>). What matters here is the association between one or more predictor variables, conditional on the other variables in the model. This is considerably more complex to calculate, but luckily, there are several functions that allow us to do just that in <code>R</code>.</p>
<p>The {performance} package relies on the Variance Inflation Factor (VIF) to quantify collinearity. Typically, VIF scores above 10 are considered to indicate a problematic degree of collinearity between some predictors. <a href="#fig-Collinearity" class="quarto-xref">Figure&nbsp;<span>13.17</span></a> indicates that our model does not suffer from multicollinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Collinearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Collinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-Collinearity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;13.17: VIF factor and 95% confidence interval for each predictor in the model"><img src="13_MultipleLinearRegression_files/figure-html/fig-Collinearity-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Collinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.17: VIF factor and 95% confidence interval for each predictor in the model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Finally, the sixth plot output by the <code>check_model()</code> function serves to check the assumption of the normality of the residuals. In <a href="12_SimpleLinearRegression.html#sec-NormalityResiduals" class="quarto-xref"><span>Section 12.4.4</span></a>, we achieved this by visualising the distribution of residuals as a density plot (see <a href="12_SimpleLinearRegression.html#fig-VocabResidualDensity" class="quarto-xref">Figure&nbsp;<span>12.12</span></a>). The diagnostic plot presented in <a href="#fig-Normality" class="quarto-xref">Figure&nbsp;<span>13.18</span></a>, by contrast, is a so-called Q-Q plot (quantile-quantile plot). These plots are designed to compare the shapes of distributions. If the residuals follow a perfect normal distribution, the points should all fall along the straight reference line (in green).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots[[<span class="dv">6</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Normality" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Normality-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="13_MultipleLinearRegression_files/figure-html/fig-Normality-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;13.18: Q-Q plot"><img src="13_MultipleLinearRegression_files/figure-html/fig-Normality-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Normality-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.18: Q-Q plot
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-Normality" class="quarto-xref">Figure&nbsp;<span>13.18</span></a>, we see that most residuals follow a normal distribution, except some observations at the tails of the distribution. This is fairly typical and, if the other model assumptions are not violated, minor deviations from normality like this are unlikely to be a problem, especially with larger sample sizes.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>check_model()</code> vignette provides more detailed information on these diagnostic plots, how to interpret them, and what to do if the assumptions are not met: <a href="https://easystats.github.io/performance/articles/check_model.html" class="uri">https://easystats.github.io/performance/articles/check_model.html</a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>So far in this chapter, we have fitted a model of L1 speakers’ <code>Vocab</code> scores. We have found that participants’ print exposure (as measured by the ART), non-verbal intelligence (as measured by the Blocks test), their age, the number of years they were in formal education, and the interaction between ART scores and years in education all contribute to being able to predict how well they performed on the <code>Vocab</code> test. The model that we selected as the optimal model (<code>L1.model.back2</code>) was able to predict 58% of the variance in <code>Vocab</code> scores among L1 speakers.</p>
<p>In this task, your aim is to find out which predictors and interactions among predictors can be used to predict <code>Vocab</code> scores among L2 speakers and to what degree of accuracy. In addition to the predictors that we entered in our full L1 model, you can enter three additional predictors in your model that are relevant to L2 speakers only:</p>
<ul>
<li>Age at which they started living in an English-speaking country (<code>Arrival</code>)</li>
<li>Total number of years they have been living in an English-speaking country (<code>LoR</code>)</li>
<li>Number of hours they spend reading in English in a typical week (<code>ReadEng</code>)</li>
</ul>
<p>Run the following code to median-center some of these numeric variables in <code>L2.data</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>L2.data <span class="ot">&lt;-</span> L2.data <span class="sc">|&gt;</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Blocks_c =</span> Blocks <span class="sc">-</span> <span class="fu">median</span>(Blocks),</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Age_c =</span> Age <span class="sc">-</span> <span class="fu">median</span>(Age),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">EduTotal_c =</span> EduTotal <span class="sc">-</span> <span class="fu">median</span>(EduTotal),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_c =</span> Arrival <span class="sc">-</span> <span class="fu">median</span>(Arrival),</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">LoR_c =</span> LoR <span class="sc">-</span> <span class="fu">median</span>(LoR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, fit the following multiple linear regression model on the L2 dataset and examine the model summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>L2.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> Age_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> Arrival_c <span class="sc">+</span> LoR_c <span class="sc">+</span> ReadEng <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>ReadEng <span class="sc">+</span> EduTotal_c<span class="sc">:</span>ReadEng <span class="sc">+</span> Arrival_c<span class="sc">:</span>Age_c <span class="sc">+</span> LoR_c<span class="sc">:</span>Arrival_c,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> L2.data)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L2.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span style="color:green;"><strong>Q13.10</strong></span> How many interaction terms contribute to the predictions made by <code>L2.model</code>?</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<form name="form_Q13_10" onsubmit="return validate_form_Q13_10()" method="post">
<select name="answer_Q13_10">
<option>0</option>
<option>1</option>
<option>2</option>
<option>3</option>
<option>4</option>
<option>5</option>
</select>
<input type="submit" value="Check answer">
<div id="result_Q13_10"></div>
</form>
<script>function validate_form_Q13_10() {var x, text; var x = document.forms['form_Q13_10']['answer_Q13_10'].value;if (x == '5'){text = 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.';} else {text = 'No, that’s incorrect.';} document.getElementById('result_Q13_10').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_71048" onclick="return show_hint_71048()">🐭 Click on the mouse for a hint.</div>
<div id="result_71048" onclick="return show_hint_71048()"></div>
<script>function show_hint_71048(){var x = document.getElementById('result_71048').innerHTML; if(!x){document.getElementById('result_71048').innerHTML = 'By definition, all of the interactions entered in a model make a contribution, however small, to the model. Note that the question here is not about whether these contributions are statistically significantly different from zero.';} else {document.getElementById('result_71048').innerHTML = '';}}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.11</strong></span> Use the <code>check_model()</code> function to visually check whether <code>L2.model</code> meets the most important assumptions of multiple linear regression models. Which assumption(s) are obviously violated?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_11" onsubmit="return validate_form_Q13_11()" method="post">
<label>
<input type="checkbox" id="answer_Q13_11_1" value="Independence of the data points">
Independence of the data points
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_2" value="Linear relationships between the predictors">
Linear relationships between the predictors
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_3" value="Homogeneity of the model residuals">
Homogeneity of the model residuals
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_4" value="Normality of the model residuals">
Normality of the model residuals
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_5" value="No overly influential outliers">
No overly influential outliers
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_6" value="No multicollinearity">
No multicollinearity
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_11_7" value="None of these assumptions">
None of these assumptions
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_11"></div>
</form>
<script>function validate_form_Q13_11() {var text; var x1 = document.getElementById('answer_Q13_11_1'); var x2 = document.getElementById('answer_Q13_11_2'); var x3 = document.getElementById('answer_Q13_11_3'); var x4 = document.getElementById('answer_Q13_11_4'); var x5 = document.getElementById('answer_Q13_11_5'); var x6 = document.getElementById('answer_Q13_11_6'); var x7 = document.getElementById('answer_Q13_11_7'); if (x1.checked == false&x2.checked == false&x3.checked == false&x4.checked == false&x5.checked == false&x6.checked == true&x7.checked == false){text = 'Yes, well done!';} else {text = 'No, not quite.';} document.getElementById('result_Q13_11').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_96905" onclick="return show_hint_96905()">🐭 Click on the mouse for a hint.</div>
<div id="result_96905" onclick="return show_hint_96905()"></div>
<script>function show_hint_96905(){var x = document.getElementById('result_96905').innerHTML; if(!x){document.getElementById('result_96905').innerHTML = 'From the six diagnostic plots produced by the check_model() function, it transpires that one of these assumptions is severely violated.';} else {document.getElementById('result_96905').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.11.</summary>
<div class="sourceCode cell-code" id="cb112" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_model</span>(L2.model, <span class="at">panel =</span> <span class="cn">FALSE</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">1</span>]] <span class="co"># No issues here.</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">2</span>]] <span class="co"># Also no issues here.</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">3</span>]] <span class="co"># Nothing major to worry about: the reference line is not perfectly flat, but it's not far off.</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">4</span>]] <span class="co"># No observation points appear to have an overly large influence on the model</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">5</span>]] <span class="co"># Here we have three coefficients with VIF scores &gt; 10. This is problematic!</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>diagnostic.plots.L2[[<span class="dv">6</span>]] <span class="co"># The residuals are not normally distributed, but the largest deviation is at lowest end of the distribution which is not terribly unusual.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can display the exact VIF values of a model using the <code>vif()</code> function from the <a href="https://www.john-fox.ca/Companion/index.html">{car}</a> package <span class="citation" data-cites="foxCompanionAppliedRegression2019">(<a href="99_references.html#ref-foxCompanionAppliedRegression2019" role="doc-biblioref">Fox &amp; Weisberg 2019</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(L2.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>               ART           Blocks_c              Age_c         EduTotal_c 
          5.987790           1.216035          25.347847           5.490682 
         Arrival_c              LoR_c            ReadEng     ART:EduTotal_c 
         23.746278          11.102277           3.661388           2.237536 
       ART:ReadEng EduTotal_c:ReadEng    Age_c:Arrival_c    Arrival_c:LoR_c 
          8.550867           4.412402           3.349661           1.398937 </code></pre>
</div>
</div>
<p>From this list of VIF values, we can see that three predictors display high collinearity: <code>Age_c</code>, <code>Arrival_c</code>, and <code>LoR_c</code>. This makes sense because, for most L2 participants recruited in the UK, if we know how old they were when they arrived in the UK (<code>Arrival</code>), and their length of residence in the country in years (<code>LoR</code>), then we can probably almost predict their age (<code>Age</code>) to a high degree of accuracy. We can easily check this hypothesis in a random sample of six participants from our <code>L2.data</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>L2.data <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Arrival, LoR, Age) <span class="sc">|&gt;</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>  Arrival LoR Age
1      26   3  29
2      32   6  38
3      22   5  28
4      17   3  20
5      23   4  27
6      16  14  30</code></pre>
</div>
</div>
<p>As you can see, in most cases, participants’ age is equal to their age when they first arrived in the country plus the number of years they’ve been living there since. This is why <code>Age</code> and the combination of the predictors <code>Arrival</code> and <code>LoR</code> are almost perfectly correlated:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(L2.data<span class="sc">$</span>Age, (L2.data<span class="sc">$</span>Arrival <span class="sc">+</span> L2.data<span class="sc">$</span>LoR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.9768833</code></pre>
</div>
</div>
<p>To remedy this, we must remove one of these three predictors from our model. Fit a new model that does <em>not</em> include participants’ age when they first arrived in the UK (<code>Arrival</code>). Save this new model as <code>L2.model.b</code>. Check that it now meets all the model assumptions and then examine its summary.</p>
<p><span style="color:green;"><strong>Q13.12</strong></span> Adjusted for the number of predictors entered into <code>L2.model.b</code>, what percentage of the variance in <code>Vocab</code> scores in the L2 dataset does this model accurately predict?</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<form name="form_Q13_12" onsubmit="return validate_form_Q13_12()" method="post">
<select name="answer_Q13_12">
<option>Practically 0%</option>
<option>About 3%</option>
<option>About 15%</option>
<option>About 20%</option>
<option>About 22%</option>
<option>About 31%</option>
<option>About 57%</option>
</select>
<input type="submit" value="Check answer">
<div id="result_Q13_12"></div>
</form>
<script>function validate_form_Q13_12() {var x, text; var x = document.forms['form_Q13_12']['answer_Q13_12'].value;if (x == 'About 20%'){text = 'Yes, well done!';} else {text = 'No, this is not the correct value.';} document.getElementById('result_Q13_12').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!'; res12 = document.getElementById('result_Q13_12').innerText == 'Yes, well done!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.12.</summary>
<div class="sourceCode cell-code" id="cb119" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>L2.model.b <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Vocab <span class="sc">~</span> ART <span class="sc">+</span> Blocks_c <span class="sc">+</span> Age_c <span class="sc">+</span> EduTotal_c <span class="sc">+</span> LoR_c <span class="sc">+</span> ReadEng <span class="sc">+</span> ART<span class="sc">:</span>EduTotal_c <span class="sc">+</span> ART<span class="sc">:</span>ReadEng <span class="sc">+</span> EduTotal_c<span class="sc">:</span>ReadEng,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> L2.data)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(L2.model.b) <span class="co"># Now all looking much better than earlier!</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L2.model.b) <span class="co"># Adjusted R-squared:  0.2027</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:green;"><strong>Q13.13</strong></span> Which main-effect predictor(s) make a statistically significant contribution to <code>L2.model.b</code> at α&nbsp;=&nbsp;0.05?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_13" onsubmit="return validate_form_Q13_13()" method="post">
<label>
<input type="checkbox" id="answer_Q13_13_1" value="ART">
ART
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_2" value="Blocks_c">
Blocks_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_3" value="Age_c">
Age_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_4" value="EduTotal_c">
EduTotal_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_5" value="Arrival_c">
Arrival_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_6" value="LoR_c">
LoR_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_13_7" value="ReadEng">
ReadEng
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_13"></div>
</form>
<script>function validate_form_Q13_13() {var text; var x1 = document.getElementById('answer_Q13_13_1'); var x2 = document.getElementById('answer_Q13_13_2'); var x3 = document.getElementById('answer_Q13_13_3'); var x4 = document.getElementById('answer_Q13_13_4'); var x5 = document.getElementById('answer_Q13_13_5'); var x6 = document.getElementById('answer_Q13_13_6'); var x7 = document.getElementById('answer_Q13_13_7'); if (x1.checked == false&x2.checked == false&x3.checked == false&x4.checked == false&x5.checked == false&x6.checked == false&x7.checked == true){text = 'That’s right, only one main-effect predictor makes a statistically significant contribution to this model of receptive vocabularly knowledge among L2 speakers of English.';} else {text = 'Humm, not quite. Which coefficient estimate(s) are associated with p-values that are lower than 0.05?';} document.getElementById('result_Q13_13').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!'; res12 = document.getElementById('result_Q13_12').innerText == 'Yes, well done!'; res13 = document.getElementById('result_Q13_13').innerText == 'That’s right, only one main-effect predictor makes a statistically significant contribution to this model of receptive vocabularly knowledge among L2 speakers of English.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.14</strong></span> Does the model’s coefficient estimate for <code>ReadEng</code> make intuitive sense?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_14" onsubmit="return validate_form_Q13_14()" method="post">
<label>
<input type="radio" name="answer_Q13_14" id="answer_Q13_14_1" value="Yes, the ReadEng coefficient is positive, which means that the more time L2 speakers regularly spend reading in English, the higher their predicted receptive English vocabulary test scores.">
Yes, the ReadEng coefficient is positive, which means that the more time L2 speakers regularly spend reading in English, the higher their predicted receptive English vocabulary test scores.
</label>
<br>
<label>
<input type="radio" name="answer_Q13_14" id="answer_Q13_14_2" value="No, the ReadEng coefficient is larger than all other coefficients, which violates the model assumption of no overly influential outliers.">
No, the ReadEng coefficient is larger than all other coefficients, which violates the model assumption of no overly influential outliers.
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_14"></div>
</form>
<script>function validate_form_Q13_14() {var x, text; var x = document.forms['form_Q13_14']['answer_Q13_14'].value;if (x == 'Yes, the ReadEng coefficient is positive, which means that the more time L2 speakers regularly spend reading in English, the higher their predicted receptive English vocabulary test scores.'){text = 'That’s right: Reading is a great way to learn new vocabularly! And reading a statistics textbook is therefore doubly beneficial: you get to learn about quantitative data analysis <em>and</em> expand your English vocabulary! 🤓';} else {text = 'No, only individual observations (i.e. data points) can be considered outliers, not coefficient estimates.';} document.getElementById('result_Q13_14').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!'; res12 = document.getElementById('result_Q13_12').innerText == 'Yes, well done!'; res13 = document.getElementById('result_Q13_13').innerText == 'That’s right, only one main-effect predictor makes a statistically significant contribution to this model of receptive vocabularly knowledge among L2 speakers of English.'; res14 = document.getElementById('result_Q13_14').innerText == 'That’s right: Reading is a great way to learn new vocabularly! And reading a statistics textbook is therefore doubly beneficial: you get to learn about quantitative data analysis and expand your English vocabulary! 🤓';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.15</strong></span> Which interaction effect(s) make a statistically significant contribution to <code>L2.model.b</code> at α&nbsp;=&nbsp;0.05?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_15" onsubmit="return validate_form_Q13_15()" method="post">
<label>
<input type="checkbox" id="answer_Q13_15_1" value="ART:EduTotal_c">
ART:EduTotal_c
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_15_2" value="ART:ReadEng">
ART:ReadEng
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_15_3" value="EduTotal_c:ReadEng">
EduTotal_c:ReadEng
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_15_4" value="None of them">
None of them
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_15"></div>
</form>
<script>function validate_form_Q13_15() {var text; var x1 = document.getElementById('answer_Q13_15_1'); var x2 = document.getElementById('answer_Q13_15_2'); var x3 = document.getElementById('answer_Q13_15_3'); var x4 = document.getElementById('answer_Q13_15_4'); if (x1.checked == false&x2.checked == false&x3.checked == false&x4.checked == true){text = 'That’s right, none of them make a statistically significant contribution to the model. However, that doesn’t necessarily mean that their coefficients do not point to any real associations: we may not have enough data to observe any statistically significant interactions.';} else {text = 'Hummm, are you sure? Check the model summary again.';} document.getElementById('result_Q13_15').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!'; res12 = document.getElementById('result_Q13_12').innerText == 'Yes, well done!'; res13 = document.getElementById('result_Q13_13').innerText == 'That’s right, only one main-effect predictor makes a statistically significant contribution to this model of receptive vocabularly knowledge among L2 speakers of English.'; res14 = document.getElementById('result_Q13_14').innerText == 'That’s right: Reading is a great way to learn new vocabularly! And reading a statistics textbook is therefore doubly beneficial: you get to learn about quantitative data analysis and expand your English vocabulary! 🤓'; res15 = document.getElementById('result_Q13_15').innerText == 'That’s right, none of them make a statistically significant contribution to the model. However, that doesn’t necessarily mean that their coefficients do not point to any real associations: we may not have enough data to observe any statistically significant interactions.';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15;element.innerHTML = text;
         return false;
         }}</script>
</div>
</div>
<p><span style="color:green;"><strong>Q13.16</strong></span> Use the {visreg} library to visualise the model’s predicted <code>Vocab</code> scores (on the <em>y</em>-axis) as a function of all possible <code>ReadEng</code> values (on the <em>x</em>-axis) and subdivide the figure into three panels corresponding to low, mid-level, and high ART scores. Which arguments do you have to use inside the <code>visreg()</code> function to achieve this?</p>
<div class="cell">
<div class="cell-output-display">
<form name="form_Q13_16" onsubmit="return validate_form_Q13_16()" method="post">
<label>
<input type="checkbox" id="answer_Q13_16_1" value="fit = L2.model.b">
fit = L2.model.b
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_16_2" value="xvar = &quot;ART&quot;">
xvar = "ART"
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_16_3" value="xvar = &quot;ReadEng&quot;">
xvar = "ReadEng"
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_16_4" value="xtrans = function(x) x + median(L2.data$ReadEng)">
xtrans = function(x) x + median(L2.data$ReadEng)
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_16_5" value="by = &quot;ReadEng&quot;">
by = "ReadEng"
</label>
<br>
<label>
<input type="checkbox" id="answer_Q13_16_6" value="by = &quot;ART&quot;">
by = "ART"
</label>
<br>
<input type="submit" value="Check answer">
<div id="result_Q13_16"></div>
</form>
<script>function validate_form_Q13_16() {var text; var x1 = document.getElementById('answer_Q13_16_1'); var x2 = document.getElementById('answer_Q13_16_2'); var x3 = document.getElementById('answer_Q13_16_3'); var x4 = document.getElementById('answer_Q13_16_4'); var x5 = document.getElementById('answer_Q13_16_5'); var x6 = document.getElementById('answer_Q13_16_6'); if (x1.checked == true&x2.checked == false&x3.checked == true&x4.checked == false&x5.checked == false&x6.checked == true){text = 'Yes, well done! Now you can focus on interpreting your model’s predicted values (the blue lines) and examine the partial residuals (the grey points that represent the variance in Vocab scores that is not accounted for by this model). It should be clear from this plot that this L2 model is not able to predict <code>Vocab</code> scores as well as our L1 model could (hence the considerably lower adjusted coefficient of determination (R-squared). Is this because L2 learners are more diverse and therefore less predictable? Or is it (also) because the sample size is smaller (67 instead of 90 participants)? We cannot tell from this data alone. What is certain is that more research is needed to answer these fascinating questions!';} else {text = 'No, that won’t quite do.';} document.getElementById('result_Q13_16').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16;res1 = document.getElementById('result_Q13_1').innerText == 'That’s right, well done!'; res2 = document.getElementById('result_Q13_2').innerText == 'Excellent!'; res3 = document.getElementById('result_Q13_3').innerText == 'Absolutely, well done!'; res4 = document.getElementById('result_Q13_4').innerText == 'That’s right, well done!'; res5 = document.getElementById('result_Q13_5').innerText == 'That’s right! Note that entering this predictor in the model changes the relative importance of all the other predictors, too.'; res6 = document.getElementById('result_Q13_6').innerText == 'That’s right, well done!'; res7 = document.getElementById('result_Q13_7').innerText == 'That’s right. Now fit the model and check the model summary to see if this interaction makes a significant contribution to the model!'; res8 = document.getElementById('result_Q13_8').innerText == 'That’s right. The p-value associated with the interaction coefficient is greater than 0.05.'; res9 = document.getElementById('result_Q13_9').innerText == 'That’s right, well done! We can tell from the plot that years in education is a statistically significant predictor because, in both the L1 and the L2 panel, it is impossible to draw a horizontal line that stays within the confidence band. A horizontal line would represent the null hypothesis of no association and, if we cannot draw it within the confidence band, this means that we can reject the null hypothesis. Concerning the statistical significance of the interaction, however, it is not obvious that the slopes of the two lines differ much. All the predicted Vocab scores for L2 speakers are lower than for L1 speakers, but the increase associated with more years of formal education, as represented by the gradients of the two slopes, look about the same. This is why the interaction coefficient turned out not to be statistically significant.'; res10 = document.getElementById('result_Q13_10').innerText == 'That’s right. The model formula includes five interactions and they all contribute to the model predictions. That said, their coefficient estimates are very small and none of their contributions to the model are statistically significantly different from zero.'; res11 = document.getElementById('result_Q13_11').innerText == 'Yes, well done!'; res12 = document.getElementById('result_Q13_12').innerText == 'Yes, well done!'; res13 = document.getElementById('result_Q13_13').innerText == 'That’s right, only one main-effect predictor makes a statistically significant contribution to this model of receptive vocabularly knowledge among L2 speakers of English.'; res14 = document.getElementById('result_Q13_14').innerText == 'That’s right: Reading is a great way to learn new vocabularly! And reading a statistics textbook is therefore doubly beneficial: you get to learn about quantitative data analysis and expand your English vocabulary! 🤓'; res15 = document.getElementById('result_Q13_15').innerText == 'That’s right, none of them make a statistically significant contribution to the model. However, that doesn’t necessarily mean that their coefficients do not point to any real associations: we may not have enough data to observe any statistically significant interactions.'; res16 = document.getElementById('result_Q13_16').innerText == 'Yes, well done! Now you can focus on interpreting your model’s predicted values (the blue lines) and examine the partial residuals (the grey points that represent the variance in Vocab scores that is not accounted for by this model). It should be clear from this plot that this L2 model is not able to predict Vocab scores as well as our L1 model could (hence the considerably lower adjusted coefficient of determination (R-squared). Is this because L2 learners are more diverse and therefore less predictable? Or is it (also) because the sample size is smaller (67 instead of 90 participants)? We cannot tell from this data alone. What is certain is that more research is needed to answer these fascinating questions!';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div class="cell-output-display">
<div id="hint_82268" onclick="return show_hint_82268()">🐭 Click on the mouse for a hint.</div>
<div id="result_82268" onclick="return show_hint_82268()"></div>
<script>function show_hint_82268(){var x = document.getElementById('result_82268').innerHTML; if(!x){document.getElementById('result_82268').innerHTML = 'Three of these arguments are necessary.';} else {document.getElementById('result_82268').innerHTML = '';}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show sample code to answer Q13.16.</summary>
<div class="sourceCode cell-code" id="cb120" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(<span class="at">fit =</span> L2.model.b,</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xvar =</span> <span class="st">"ReadEng"</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">by =</span> <span class="st">"ART"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/hex_car.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Hex sticker of the {car} package"><img src="images/hex_car.png" class="img-fluid figure-img" alt="The hexagonal logo of the car package features a fun-looking yellow cartoon car." width="100"></a></p>
<figcaption>Hex sticker of the <a href="https://www.john-fox.ca/Companion/index.html">{car}</a> package</figcaption>
</figure>
</div>
</div></div></section>
<section id="tapping-into-the-potential-of-statistical-modelling" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="tapping-into-the-potential-of-statistical-modelling"><span class="header-section-number">13.9</span> Tapping into the potential of statistical modelling</h2>
<p>This chapter aimed to provide first insights into the potential of statistical modelling with multiple predictors. It has demonstrated the importance of considering interactions between predictors and of visualising both the observed sample data, as well as simulated values based on the predictions of a statistical model.</p>
<p>You may have noted that <em>p</em>-values were <em>not</em> at the heart of this chapter. Instead, we focused on model accuracy (as measured by the adjusted R<sup>2</sup>), coefficient estimates and their relative importance (as measured by the lmg metric), predicted values, and (partial) model residuals. This is because there is an unfortunate tendency among some students and researchers to be misled into thinking that, if a result turns out to be statistically significant, it must be true. As statistician Andrew Gelman puts it, some confuse statistics for “a form of modern alchemy, transforming the uncertainty and variation of the laboratory and field measurements into clean scientific conclusions that can be taken as truth” <span class="citation" data-cites="gelmanEthicsStatisticalPractice2018">(<a href="99_references.html#ref-gelmanEthicsStatisticalPractice2018" role="doc-biblioref">Gelman 2018</a>: 43)</span>.</p>
<p>I hope that working through <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a> to <a href="#sec-MLR" class="quarto-xref"><span>13</span></a> has shown you that a big part of learning to work with quantitative data in the language sciences is really about “embracing variation and accepting uncertainty” <span class="citation" data-cites="gelmanEmbracingVariationAccepting2019">(<a href="99_references.html#ref-gelmanEmbracingVariationAccepting2019" role="doc-biblioref">Gelman 2019</a>)</span>. If we intend to report inferential statistics based on sample data, it is important that we decide on significance level thresholds, model selection criteria, and other such parameters <em>before</em> conducting our data analysis <span class="citation" data-cites="mertzenBenefitsPreregistrationHypothesisdriven2021 roettgerPreregistrationExperimentalLinguistics2021">(on the benefits of preregistrating protocols and methods in the language sciences, see e.g. <a href="99_references.html#ref-mertzenBenefitsPreregistrationHypothesisdriven2021" role="doc-biblioref">Mertzen, Lago &amp; Vasishth 2021</a>; <a href="99_references.html#ref-roettgerPreregistrationExperimentalLinguistics2021" role="doc-biblioref">Roettger 2021</a>)</span>. If we want to test hypotheses, these must be well-defined hypotheses and we must strive to quantify (and ideally also visualise!) <strong>uncertainty</strong>. Ultimately, it is worth remembering that “in almost all practical data analysis situations – we can only draw uncertain conclusions from data, regardless of whether we manage to obtain statistical significance or not” <span class="citation" data-cites="vasishthHowEmbraceVariation2021">(<a href="99_references.html#ref-vasishthHowEmbraceVariation2021" role="doc-biblioref">Vasishth &amp; Gelman 2021</a>: 1311)</span>. Crucially, we must be extremely careful when extrapolating our results beyond the range of our observed data.</p>
<p>As explained in <a href="11_Inferential.html" class="quarto-xref"><span>Chapter 11</span></a>, statistical inference based on NHST and <em>p</em>-values comes from a statistical framework called <strong>frequentism</strong>, which happens to (currently) be the most widely used framework in the language sciences. Taking a frequentist approach means that the statistical properties of the hypothesis tests that we conduct are considered under hypothetical replications of our study with new sample data. This is because, in the frequentist framework, we estimate the long-run probability of observing certain effects, were we to repeat the study many times. This is one of the reasons why <strong>replication</strong> (see <a href="14_LiterateProgramming.html#sec-Reproducibility" class="quarto-xref"><span>Section 14.2</span></a>) is key to advancing our knowledge of linguistics and language teaching and learning. Whenever we have small sample sizes, small effect sizes (i.e.&nbsp;small coefficient estimates in statistical models), large measurement error, and/or lots of variability among the target population – as is often the case in the language sciences – we simply cannot get <strong>reliable</strong> results from a single sample.</p>
<p>Does this mean that we should give up with quantitative data analysis and statistics all together? No, of course not. On the contrary, this uncertainty makes research in the language sciences all the more interesting and worth pursuing! It also means that there is much more to be learnt in terms of methods. In this chapter, you have learnt about <strong>frequentist fixed-effects linear regression models</strong>. These models are incredibly useful and can be used in many contexts, but they make a number of important assumptions that do not always hold:</p>
<ul>
<li><p>Perhaps the most obvious, yet one that we have not discussed so far, is that the <strong>outcome variable</strong> of a linear regression model must be <strong>quantitative</strong>, like the <code>Vocab</code> variable in <code>Dabrowska.data</code>, which ranges from -13.33 to 95.56 (see <a href="7_VariablesFunctions.html#sec-Variables" class="quarto-xref"><span>Section 7.2</span></a>). Other types of statistical models can be used to model other types of outcome variables, including:</p>
<ul>
<li><p><strong>Binomial (or binary) logistic regression models</strong> allow us to predict <strong>binary</strong> outcomes (e.g.&nbsp;whether or not a verb is negated) <span class="citation" data-cites="LevshinaHowlinguisticsData2015 sondereggerRegressionModelingLinguistic2023 WinterStatisticsLinguistsIntroduction2019">(to find out more, see e.g. <a href="99_references.html#ref-LevshinaHowlinguisticsData2015" role="doc-biblioref">Levshina 2015</a>: Chapter&nbsp;12; <a href="99_references.html#ref-sondereggerRegressionModelingLinguistic2023" role="doc-biblioref">Sonderegger 2023</a>: Chapter&nbsp;6; <a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">Winter 2019</a>: Chapter&nbsp;12)</span>.</p></li>
<li><p><strong>Multinomial logistic regression models</strong> can be used to model <strong>categorical</strong> outcome variables with more than two levels (e.g.&nbsp;which modal verb is used in certain constructions) <span class="citation" data-cites="LevshinaHowlinguisticsData2015">(to find out more, see e.g. <a href="99_references.html#ref-LevshinaHowlinguisticsData2015" role="doc-biblioref">Levshina 2015</a>: Chapter&nbsp;13)</span>.</p></li>
<li><p><strong>Poisson regression models</strong> are used to model <strong>count</strong> variables, i.e.&nbsp;discrete numeric variables such as the frequency of fillers (such as <em>uh</em> and <em>oh</em>) in certain contexts <span class="citation" data-cites="WinterStatisticsLinguistsIntroduction2019">(to find out more, see e.g. <a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">Winter 2019</a>: Chapter&nbsp;13)</span>.</p></li>
</ul></li>
<li><p>The observations (i.e.&nbsp;the data points) used to fit a <strong>fixed-effect model</strong> must be independent of each other. In the language sciences, such a situation is actually quite rare (see <a href="12_SimpleLinearRegression.html#sec-IndependenceSLR" class="quarto-xref"><span>Section 12.4.1</span></a>). To model interdependencies between observations, we can fit <strong>mixed-effects models</strong> (also called multilevel or hierarchical models) <span class="citation" data-cites="griesStatisticsLinguisticsPractical2021 sondereggerRegressionModelingLinguistic2023 WinterStatisticsLinguistsIntroduction2019">(to learn more, see e.g. <a href="99_references.html#ref-griesStatisticsLinguisticsPractical2021" role="doc-biblioref">Gries 2021</a>: Chapter&nbsp;6; <a href="99_references.html#ref-sondereggerRegressionModelingLinguistic2023" role="doc-biblioref">Sonderegger 2023</a>: Chapters&nbsp;8-10; <a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">Winter 2019</a>: Chapters&nbsp;14-15)</span>.</p></li>
<li><p>Linear regression models assume <strong>linear</strong> relationships between the predictors. There are different ways to circumvent this problem. In some cases, predictors can be <strong>transformed</strong> to meet this assumption <span class="citation" data-cites="WinterStatisticsLinguistsIntroduction2019">(see <a href="99_references.html#ref-WinterStatisticsLinguistsIntroduction2019" role="doc-biblioref">Winter 2019</a>: Chapter&nbsp;5)</span>. In others, it may be wiser to model non-linear associations with other kinds of models such as Generalised Additive Mixed Models <span class="citation" data-cites="soskuthyGeneralisedAdditiveMixed2017">Wieling (<a href="99_references.html#ref-wielingAnalyzingDynamicPhonetic2018" role="doc-biblioref">2018</a>)</span>.</p></li>
<li><p>Finally, we need not stick to the <strong>frequentist</strong> school of statistics. In fact, quantitative linguists are increasingly turning to <strong>Bayesian</strong> statistics and finding that Bayesian models help them work with the particularities of linguistic data <span class="citation" data-cites="levshinaComparingBayesianFrequentist2022 nicenboimIntroductionBayesianData2026">(to learn more about Bayesian statistics, see e.g. <a href="99_references.html#ref-levshinaComparingBayesianFrequentist2022" role="doc-biblioref">Levshina 2022</a>; <a href="99_references.html#ref-nicenboimIntroductionBayesianData2026" role="doc-biblioref">Nicenboim, Schad &amp; Vasishth 2026</a>)</span>.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recommended further reading 📚
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this textbook, we have only just scratched the surface of statistical modelling. We can do much, much more with these kinds of models, and there are lots of additional things to take into account. The good news is that there are lots of excellent resources to help you continue your statistical modelling journey. Here are some good places to get started (in alphabetical order):</p>
<ul>
<li>Gries, Stefan Thomas. 2021. <em>Statistics for linguistics with R: A practical introduction</em> (De Gruyter Mouton Textbook). 3<sup>rd</sup> revised edition. De Gruyter Mouton.</li>
<li>Levshina, Natalia. 2015. <em>How to do linguistics with R: Data exploration and statistical analysis</em>. John Benjamins.</li>
<li>Nicenboim, Bruno, Daniel Schad &amp; Shravan Vasishth. 2026. Introduction to Bayesian Data Analysis for cognitive science (Chapman &amp; Hall/CRC Statistics in the Social and Behavioral Sciences Series). CRC Press. Open Access version: <a href="https://bruno.nicenboim.me/bayescogsci/" class="uri">https://bruno.nicenboim.me/bayescogsci/</a>.</li>
<li>Sonderegger, Morgan. 2023. <em>Regression modeling for linguistic data</em>. Cambridge, Massachusetts: The MIT Press. Open Access version: <a href="https://osf.io/pnumg/" class="uri">https://osf.io/pnumg/</a>.</li>
<li>Winter, Bodo. 2019. Statistics for Linguists: An Introduction Using R. Routledge.</li>
</ul>
<p>Although they go further than the present textbook, you will also find that these resources begin by explaining many of the things already covered in this chapter and previous chapters, and that’s actually a good thing. There’s no harm in revising these complex topics from a different perspective, with different examples, <code>R</code> packages, and coding styles.</p>
</div>
</div>
<section id="check-your-progress" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="check-your-progress">Check your progress 🌟</h3>
<p>Congratulations: you have successfully completed the most difficult chapter of this textbook! You have answered <span style="color:green;"><span id="checkdown_final_score">0</span> out of 16 questions</span> correctly.</p>
<p>Are you confident that you can…?</p>
<ul class="task-list">
<li><label><input type="checkbox">Fit a linear regression model in <code>R</code> with multiple numeric and categorical predictors and interpret the intercept and predictor coefficients</label></li>
<li><label><input type="checkbox">Center numeric predictors to make the intercept more meaningful and improve model interpretability</label></li>
<li><label><input type="checkbox">Assess the importance of predictors using metrics like lmg</label></li>
<li><label><input type="checkbox">Visualise and interpret model predictions (with confidence bands) and partial residuals using the {visreg} library</label></li>
<li><label><input type="checkbox">Model and interpret interactions between predictors in multiple linear regression models, and visualise these interactions to see how one predictor moderates the effect of another on the outcome variable</label></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-acheson2008" class="csl-entry" role="listitem">
Acheson, Daniel J., Justine B. Wells &amp; Maryellen C. MacDonald. 2008. New and updated tests of print exposure and reading abilities in college students. <em>Behavior Research Methods</em> 40(1). 278–289. <a href="https://doi.org/10.3758/brm.40.1.278">https://doi.org/10.3758/brm.40.1.278</a>.
</div>
<div id="ref-almeidaGgplot2CompatibleQuantilequantile2018" class="csl-entry" role="listitem">
Almeida, Alexandre, Adam Loy &amp; Heike Hofmann. 2018. ggplot2 compatible quantile-quantile plots in r. <em>The R Journal</em> 10(2). 248–261. <a href="https://doi.org/10.32614/RJ-2018-051">https://doi.org/10.32614/RJ-2018-051</a>.
</div>
<div id="ref-cetinkaya-rundelIntroductionModernStatistics2021" class="csl-entry" role="listitem">
Çetinkaya-Rundel, Mine &amp; Johanna Hardin. 2021. <em>Introduction to modern statistics</em>. Second. Leanpub. <a href="https://openintro-ims.netlify.app/">https://openintro-ims.netlify.app/</a>.
</div>
<div id="ref-DabrowskaExperienceAptitudeIndividual2019" class="csl-entry" role="listitem">
Dąbrowska, Ewa. 2019. Experience, aptitude, and individual differences in linguistic attainment: A comparison of native and nonnative speakers. <em>Language Learning</em> 69(S1). 72–100. <a href="https://doi.org/10.1111/lang.12323">https://doi.org/10.1111/lang.12323</a>.
</div>
<div id="ref-foxCompanionAppliedRegression2019" class="csl-entry" role="listitem">
Fox, John &amp; Sanford Weisberg. 2019. <em>An r companion to applied regression</em>. Third edition. SAGE.
</div>
<div id="ref-gelmanEthicsStatisticalPractice2018" class="csl-entry" role="listitem">
Gelman, Andrew. 2018. Ethics in statistical practice and communication: Five recommendations. <em>Significance</em> 15(5). 40–43. <a href="https://doi.org/10.1111/j.1740-9713.2018.01193.x">https://doi.org/10.1111/j.1740-9713.2018.01193.x</a>.
</div>
<div id="ref-gelmanEmbracingVariationAccepting2019" class="csl-entry" role="listitem">
Gelman, Andrew. 2019. Embracing variation and accepting uncertainty: Implications for science and metascience. <a href="https://www.youtube.com/watch?v=VQCcMP4A5Ks">https://www.youtube.com/watch?v=VQCcMP4A5Ks</a>.
</div>
<div id="ref-griesStatisticsLinguisticsPractical2021" class="csl-entry" role="listitem">
Gries, Stefan Thomas. 2021. <em>Statistics for linguistics with r: A practical introduction</em> (De Gruyter Mouton Textbook). 3rd revised edition. de Gruyter Mouton.
</div>
<div id="ref-grömping2006" class="csl-entry" role="listitem">
Grömping, Ulrike. 2006. Relative Importance for Linear Regression in<span><em>R</em></span>: The Package<span><strong>relaimpo</strong></span>. <em>Journal of Statistical Software</em> 17(1). <a href="https://doi.org/10.18637/jss.v017.i01">https://doi.org/10.18637/jss.v017.i01</a>.
</div>
<div id="ref-harrellRegressionModelingStrategies2015" class="csl-entry" role="listitem">
Harrell, Frank E. 2015. <em>Regression modeling strategies: With applications to linear models, logistic and ordinal regression, and survival analysis</em> (Springer Series in Statistics). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-19425-7">https://doi.org/10.1007/978-3-319-19425-7</a>.
</div>
<div id="ref-LevshinaHowlinguisticsData2015" class="csl-entry" role="listitem">
Levshina, Natalia. 2015. <em>How to do linguistics with r: Data exploration and statistical analysis</em>. John Benjamins.
</div>
<div id="ref-levshinaComparingBayesianFrequentist2022" class="csl-entry" role="listitem">
Levshina, Natalia. 2022. Comparing Bayesian and Frequentist Models of Language Variation: The Case of Help + (to-)Infinitive. In Ole Schützler &amp; Julia Schlüter (eds.), 224–258. 1st edn. Cambridge University Press. <a href="https://doi.org/10.1017/9781108589314.009">https://doi.org/10.1017/9781108589314.009</a>.
</div>
<div id="ref-lindemanIntroductionBivariateMultivariate1980" class="csl-entry" role="listitem">
Lindeman, Richard Harold, Peter Francis Merenda &amp; Ruth Z. Gold. 1980. <em>Introduction to bivariate and multivariate analysis</em>. Scott, Foresman.
</div>
<div id="ref-lüdecke2020" class="csl-entry" role="listitem">
Lüdecke, Daniel. 2020. <em>sjPlot: Data visualization for statistics in social science</em>. <a href="https://CRAN.R-project.org/package=sjPlot">https://CRAN.R-project.org/package=sjPlot</a>.
</div>
<div id="ref-ludeckePerformancePackageAssessment2021" class="csl-entry" role="listitem">
Lüdecke, Daniel, Mattan S. Ben-Shachar, Indrajeet Patil, Philip Waggoner &amp; Dominique Makowski. 2021. <span class="nocase">performance</span>: An r package for assessment, comparison and testing of statistical models. <em>Journal of Open Source Software</em> 6(60). 3139. <a href="https://doi.org/10.21105/joss.03139">https://doi.org/10.21105/joss.03139</a>.
</div>
<div id="ref-ludeckeSeePackageVisualizing2021" class="csl-entry" role="listitem">
Lüdecke, Daniel, Indrajeet Patil, Mattan S. Ben-Shachar, Brenton M. Wiernik, Philip Waggoner &amp; Dominique Makowski. 2021. See: An r package for visualizing statistical models. <em>Journal of Open Source Software</em> 6(64). 3393. <a href="https://doi.org/10.21105/joss.03393">https://doi.org/10.21105/joss.03393</a>.
</div>
<div id="ref-mertzenBenefitsPreregistrationHypothesisdriven2021" class="csl-entry" role="listitem">
Mertzen, Daniela, Sol Lago &amp; Shravan Vasishth. 2021. The benefits of preregistration for hypothesis-driven bilingualism research. <em>Bilingualism: Language and Cognition</em> 24(5). 807–812. <a href="https://doi.org/10.1017/S1366728921000031">https://doi.org/10.1017/S1366728921000031</a>.
</div>
<div id="ref-mizumotoCalculatingRelativeImportance2023" class="csl-entry" role="listitem">
Mizumoto, Atsushi. 2023. Calculating the relative importance of multiple regression predictor variables using dominance analysis and random forests. <em>Language Learning</em> 73(1). 161–196. <a href="https://doi.org/10.1111/lang.12518">https://doi.org/10.1111/lang.12518</a>.
</div>
<div id="ref-nicenboimIntroductionBayesianData2026" class="csl-entry" role="listitem">
Nicenboim, Bruno, Daniel Schad &amp; Shravan Vasishth. 2026. <em>Introduction to Bayesian Data Analysis for cognitive science</em> (Chapman &amp; Hall/CRC Statistics in the social and behavioral sciences series). Boca Raton London New York: CRC Press, Taylor &amp; Francis Group. <a href="https://doi.org/10.1201/9780429342646">https://doi.org/10.1201/9780429342646</a>.
</div>
<div id="ref-roettgerPreregistrationExperimentalLinguistics2021" class="csl-entry" role="listitem">
Roettger, Timo B. 2021. Preregistration in experimental linguistics: Applications, challenges, and limitations. <em>Linguistics</em>. De 59(5). 1227–1249. <a href="https://doi.org/10.1515/ling-2019-0048">https://doi.org/10.1515/ling-2019-0048</a>.
</div>
<div id="ref-smithStepAwayStepwise2018" class="csl-entry" role="listitem">
Smith, Gary. 2018. Step away from stepwise. <em>Journal of Big Data</em>. SpringerOpen 5(1). 1–12. <a href="https://doi.org/10.1186/s40537-018-0143-6">https://doi.org/10.1186/s40537-018-0143-6</a>.
</div>
<div id="ref-sondereggerRegressionModelingLinguistic2023" class="csl-entry" role="listitem">
Sonderegger, Morgan. 2023. <em>Regression modeling for linguistic data</em>. The MIT Press.
</div>
<div id="ref-soskuthyGeneralisedAdditiveMixed2017" class="csl-entry" role="listitem">
Sóskuthy, Márton. Generalised additive mixed models for dynamic analysis in linguistics: A practical introduction. <a href="https://doi.org/10.48550/arXiv.1703.05339">https://doi.org/10.48550/arXiv.1703.05339</a>.
</div>
<div id="ref-thompsonStepwiseRegressionStepwise1995" class="csl-entry" role="listitem">
Thompson, Bruce. 1995. Stepwise regression and stepwise discriminant analysis need not apply here: A guidelines editorial. <em>Educational and Psychological Measurement</em>. SAGE 55(4). 525–534. <a href="https://doi.org/10.1177/0013164495055004001">https://doi.org/10.1177/0013164495055004001</a>.
</div>
<div id="ref-vasishthHowEmbraceVariation2021" class="csl-entry" role="listitem">
Vasishth, Shravan &amp; Andrew Gelman. 2021. How to embrace variation and accept uncertainty in linguistic and psycholinguistic data analysis. <em>Linguistics</em> 59(5). 1311–1342. <a href="https://doi.org/10.1515/ling-2019-0051">https://doi.org/10.1515/ling-2019-0051</a>.
</div>
<div id="ref-wielingAnalyzingDynamicPhonetic2018" class="csl-entry" role="listitem">
Wieling, Martijn. 2018. Analyzing dynamic phonetic data using generalized additive mixed modeling: A tutorial focusing on articulatory differences between L1 and L2 speakers of english. <em>Journal of Phonetics</em> 70. 86–116. <a href="https://doi.org/10.1016/j.wocn.2018.03.002">https://doi.org/10.1016/j.wocn.2018.03.002</a>.
</div>
<div id="ref-WinterStatisticsLinguistsIntroduction2019" class="csl-entry" role="listitem">
Winter, Bodo. 2019. <em>Statistics for linguists: An introduction using <span>R</span></em>. Routledge. <a href="https://doi.org/10.4324/9781315165547">https://doi.org/10.4324/9781315165547</a>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Loading the {relaimpo} package returns several warnings informing us, on the one hand, about packages that {relaimpo} requires to work and which are therefore also automatically loaded (these are called <strong>dependencies</strong>) and, on the other, about objects being <strong>masked</strong> by different packages, e.g.:</p>
<pre data-code-line-numbers=""><code>The following object is masked from ‘package:dplyr’:

select</code></pre>
<p>It is worth paying attention to the latter set of warnings because it means that some function names, e.g.&nbsp;<code>select()</code>, are now shared by more than one package in our <code>R</code> environment. This can cause code that previously worked fine to suddenly return errors. For example, after loading the {relaimpo} package, you may find that the <code>select()</code> function no longer works as expected because <code>R</code> attempts to use the <code>select()</code> function from the {MASS} package rather than from the tidyverse {dplyr} package. To avoid this happening, we can manually assign the correct package to the function name like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This ensures that any future mentions of the <code>select()</code> function are, by default, interpreted as the function defined in the {dplyr} package.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If your version of RStudio does not display the six-panelled figure but instead only a white canvas, this is probably because your Plots pane is too small. In this case, you will need to make it as large as possible and then try running the function again. If that doesn’t work either, don’t worry as we will save and examine individual plots from now on.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    window.setColorSchemeToggle(window.hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/RstatsTexbook\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12_SimpleLinearRegression.html" class="pagination-link" aria-label="Int`R`oduction to statistical modelling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Int<code>R</code>oduction to statistical modelling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14_LiterateProgramming.html" class="pagination-link" aria-label="Rep`R`oducible research and academic w`R`iting in Quarto">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rep<code>R</code>oducible research and academic w<code>R</code>iting in Quarto</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p>Data Analysis for the Language Sciences</p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA</a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>